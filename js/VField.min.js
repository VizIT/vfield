/*
 Copyright 2013-2014 Vizit Solutions

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
*/
window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(m){m.ensureNumber=function(e){return"number"===typeof e?e:parseFloat(e)}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(m){m.toBoolean=function(e){var h,a;a=typeof e;if("boolean"===a)h=e;else if("number"===a)h=0!==e;else if("string"===a)switch(e.trim().toLowerCase()){case "f":case "false":case "n":case "no":case "0":case "":h=!1;break;default:h=!0}return h}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(m){m.MotionEventHandler=function(e,h,a,c){var d,b,f,k;d=[];b=!1;k=f=null;this.findTouchByIdentifier=function(a){var b,c;for(b=0;b<d.length;b++)if(c=d[b].identifier,c===a)return b;return-1};this.handleTouchStart=function(a){var b,c,f;f=a.targetTouches;for(b=0;b<f.length;b++)c=f[b],-1===this.findTouchByIdentifier(c.identifier)&&d.push(c);if(a.preventDefault)a.preventDefault();else return!1};this.handleTouchEnd=function(a){var b,c,f;f=a.changedTouches;for(b=0;b<f.length;b++)c=this.findTouchByIdentifier(f[b].identifier),
-1!==c&&d.splice(c,1);if(a.preventDefault)a.preventDefault();else return!1};this.handleOneActiveMove=function(a){var b,c,f,k;k=a.changedTouches[0];c=d[0];null!==c?(b=k.pageX-c.pageX,c=k.pageY-c.pageY,f=e.getModelViewMatrix(),h.rotateBy(f,c/150,b/150),e.setModelViewMatrix(f),e.requestRender(),d.splice(0,1,k)):d.push(k);if(a.preventDefault)a.preventDefault();else return!1};this.handleTwoActiveMove=function(a){var b,f,k,h,n,r,w;h=d[0];r=d[1];b=r.pageX-h.pageX;f=r.pageY-h.pageY;k=Math.sqrt(b*b+f*f);w=
a.changedTouches;for(b=0;b<w.length;b++)n=w[b],f=n.identifier,h.identifier===f?(h=n,d.splice(0,1,n)):r.identifier===f&&(r=n,d.splice(1,1,n));b=r.pageX-h.pageX;f=r.pageY-h.pageY;h=Math.sqrt(b*b+f*f);e.zoomBy(-(h-k)/c);if(a.preventDefault)a.preventDefault();else return!1};this.handleTouchMove=function(a){return 1===d.length?this.handleOneActiveMove(a):2===d.length?this.handleTwoActiveMove(a):!0};this.handleMouseDown=function(a){b=!0;f=a.clientX;k=a.clientY};this.handleMouseUp=function(a){b=!1};this.handleMouseMove=
function(a){if(b){var c=a.clientX,d=a.clientY,p=c-f,s=d-k;a=e.getModelViewMatrix();h.rotateBy(a,s/30,p/30);e.setModelViewMatrix(a);e.requestRender();f=c;k=d}};this.handleMouseWheel=function(b){b=window.event||b;e.zoomBy((20*b.detail|b.deltaY|-b.wheelDeltaY)/a);if(b.preventDefault)b.preventDefault();else return!1}}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(m){m.GLUtility=function(e){var h,a;this.getGLContext=function(){!a&&(a=h.getContext("webgl",{antialias:!0})||h.getContext("experimental-webgl",{antialias:!0}))&&(a.enable(a.DEPTH_TEST),a.depthFunc(a.LESS));return a};this.clearColor=function(c,d,b,f){a.clearColor(c,d,b,f)};this.clear=function(){a.clear(a.COLOR_BUFFER_BIT)};this.compileShader=function(c,d){var b=a.createShader(d);a.shaderSource(b,c);a.compileShader(b);if(!a.getShaderParameter(b,a.COMPILE_STATUS))throw"Shader compile failed with:"+
a.getShaderInfoLog(b);return b};this.createProgram=function(c,d){var b,f,k;f=a.createProgram();k=this.compileShader(c,a.VERTEX_SHADER);b=this.compileShader(d,a.FRAGMENT_SHADER);a.attachShader(f,k);a.attachShader(f,b);a.linkProgram(f);return f};this.loadData=function(c,d){a.bindBuffer(a.ARRAY_BUFFER,c);a.bufferData(a.ARRAY_BUFFER,d,a.STATIC_DRAW)};this.createBuffer=function(c){var d=a.createBuffer();this.loadData(d,c);return d};this.createIndexBuffer=function(c){var d=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,
d);a.bufferData(a.ELEMENT_ARRAY_BUFFER,c,a.STATIC_DRAW);return d};this.getAttribLocation=function(c,d){var b;b=a.getAttribLocation(c,d);-1===b&&alert("Can not find attribute "+d+".");return b};this.bindBuffer=function(c,d,b,f,k,g){a.bindBuffer(a.ARRAY_BUFFER,c);a.enableVertexAttribArray(d);a.vertexAttribPointer(d,b,f,!1,k,g)};this.loadTexture=function(c,d,b){var f=a.createTexture(),k=new Image;k.onload=function(){this.onTextureLoaded(k,f,d,b)}.bind(this);k.src=c;return f};this.onTextureLoaded=function(c,
d,b,f){a.activeTexture(a.TEXTURE0+b);a.bindTexture(a.TEXTURE_2D,d);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,c);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST);a.generateMipmap(a.TEXTURE_2D);f()};this.bindTexture=function(c,d,b,f){a.activeTexture(a.TEXTURE0+b);a.bindTexture(a.TEXTURE_2D,d);a.uniform1i(f,b)};this.generateModelViewMatrix=function(a){return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,
a,0,0,1])};this.generatePerspectiveMatrix=function(a,d,b,f){return new Float32Array([b/a,0,0,0,0,b/d,0,0,0,0,-(f+b)/(f-b),-1,0,0,-2*f*b/(f-b),0])};this.generateOrthographicMatrix=function(a,d,b,f){return new Float32Array([1/a,0,0,0,0,1/d,0,0,0,0,-2/(f-b),0,0,0,-(f+b)/(f-b),1])};this.getUniformLocation=function(c,d){var b;b=a.getUniformLocation(c,d);-1===b&&alert("Can not find uniform"+d+".");return b};this.loadUniform3f=function(a,d,b,f,k,g){d=a.getUniformLocation(d,b);-1===d?alert("Can not find uniform"+
b+"."):a.uniform3f(d,f,k,g)};this.loadUniform4f=function(c,d,b,f,k,g){c=a.getUniformLocation(c,d);-1===c?alert("Can not find uniform"+d+"."):a.uniform4f(c,b,f,k,g)};this.loadUniformMatrix3fv=function(c,d,b){c=a.getUniformLocation(c,d);-1===c?alert("Can not find uniform"+d+"."):a.uniformMatrix3fv(c,!1,b)};this.loadUniformMatrix4fv=function(c,d,b){c=a.getUniformLocation(c,d);-1===c?alert("Can not find uniform"+d+"."):a.uniformMatrix4fv(c,!1,b)};this.getXYRotationMatrix=function(a,d){Math.cos(a);Math.cos(d);
Math.sin(a);Math.sin(d)};this.rotateBy=function(a,d,b){var f,k,g=Math.cos(d),l=Math.cos(b);d=Math.sin(d);var e=Math.sin(b),h=d*e,s=l*d,n=g*e,r=g*l;b=a[0];f=a[1];k=a[2];a[0]=b*l+k*e;a[1]=b*h+f*g-k*s;a[2]=-b*n+f*d+k*r;b=a[4];f=a[5];k=a[6];a[4]=b*l+k*e;a[5]=b*h+f*g-k*s;a[6]=-b*n+f*d+k*r;b=a[8];f=a[9];k=a[10];a[8]=b*l+k*e;a[9]=b*h+f*g-k*s;a[10]=-b*n+f*d+k*r;b=a[12];f=a[13];k=a[14];a[12]=b*l+k*e;a[13]=b*h+f*g-k*s;a[14]=-b*n+f*d+k*r};this.extractRotationPart=function(a,d){d.set(a.subarray(0,3));d.set(a.subarray(4,
7),3);d.set(a.subarray(8,11),6);return d};h=e;a=this.getGLContext()}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(m){m.Color=function(e,h,a,c){var d,b,f,k;this.setRed=function(a){d=a;return this};this.getRed=function(){return d};this.setGreen=function(a){b=a;return this};this.getGreen=function(){return b};this.setBlue=function(a){f=a;return this};this.getBlue=function(){return f};this.setAlpha=function(a){k=a;return this};this.getAlpha=function(){return k};this.setRed(e).setGreen(h).setBlue(a).setAlpha(c)}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.geometry=window.vizit.geometry||{};
(function(m){m.Surface=function(e,h){var a,c,d,b,f;c=h;b=e;f=new Float32Array(3*e);a=new Uint16Array(h);d=new Float32Array(3*e);this.setNindices=function(a){c=a};this.getNindices=function(){return c};this.setNvertices=function(a){b=a};this.getNvertices=function(){return b};this.setVerticies=function(a){f=a};this.getVertices=function(){return f};this.setIndices=function(b){a=b};this.getIndices=function(){return a};this.setNormals=function(a){d=a};this.getNormals=function(){return d}};m.Shapes={SPHERE:{value:"sphere"},
SQUARE:{value:"square"},CYLINDER:{value:"cylinder"}};m.VertexRegistry=function(){var e;e={};this.registerVertices=function(h,a){if(e.hasOwnProperty(h))throw"Vertex buffers already registered for "+h+".";e[h]=a};this.hasVertices=function(h){return e.hasOwnProperty(h)};this.retrieveVertices=function(h){return e[h]}};m.vertexRegistry=new m.VertexRegistry;m.Square=function(){var e,h,a;a=m.Shapes.SQUARE;e=[-0.5,0.5,0,0.5,0.5,0,0.5,-0.5,0,-0.5,-0.5,0];h=[0,0,1];this.getNindices=function(){return 6};this.computeGeometry=
function(a,d){var b,f,k;k=a.getVertices();f=a.getNormals();b=a.getIndices();for(var g=0;12>g;g++)k[g]=d[g],f[g]=h[g%3];b[0]=0;b[1]=3;b[2]=1;b[3]=3;b[4]=2;b[5]=1;a.setNvertices(12);a.setNindices(6)};this.getVertexBuffers=function(c){var d,b;this.hasVertices(a.value)?b=this.retrieveVertices(a.value):(d=new m.Surface(4,6),b={},this.computeGeometry(d,e),b.vertices=c.createBuffer(d.getVertices()),b.normals=c.createBuffer(d.getNormals()),b.indices=c.createIndexBuffer(d.getIndices()),this.registerVertices(a.value,
b));return b}};m.Square.prototype=m.vertexRegistry;m.Cylinder=function(){var e;e=m.Shapes.CYLINDER;this.getBaseHeight=function(){return 1};this.getBaseRadius=function(){return 1};this.getShape=function(){return e};this.getNindices=function(){return 126};this.computeGeometry=function(e){var a,c,d,b,f,k,g;g=e.getVertices();b=e.getNormals();d=e.getIndices();g[0]=0;b[0]=0;g[1]=0;b[1]=0;g[2]=0.5;b[2]=1;d[0]=0;a=94;d[a]=a;a*=3;g[a]=0;b[a++]=0;g[a]=0;b[a++]=0;g[a]=-0.5;b[a]=-1;for(c=1;31>=c;c++)a=2*(c-1)*
Math.PI/30,d[c]=c,k=3*c,g[k]=1*Math.cos(a),b[k++]=0,g[k]=1*Math.sin(a),b[k++]=0,g[k]=0.5,b[k]=1;for(c=1;31>=c;c++)k=3*c,a=c+90+4,d[a]=a,a*=3,g[a]=g[k++],b[a++]=0,g[a]=g[k],b[a++]=0,g[a]=-0.5,b[a]=-1;k=3;a=285;f=96;for(c=0;30>=c;c++)d[f/3]=f/3,g[f]=g[k],b[f++]=g[k++]/1,g[f]=g[k],b[f++]=g[k++]/1,g[f]=g[k],b[f++]=g[k++]/1,d[f/3]=f/3,g[f]=g[a],b[f++]=g[a++]/1,g[f]=g[a],b[f++]=g[a++]/1,g[f]=g[a],b[f++]=g[a++]/1;e.setNvertices(378);e.setNindices(126)};this.getVertexBuffers=function(h){var a,c;this.hasVertices(e.value)?
c=this.retrieveVertices(e.value):(a=new m.Surface(126,126),c={},this.computeGeometry(a),c.vertices=h.createBuffer(a.getVertices()),c.normals=h.createBuffer(a.getNormals()),c.indices=h.createIndexBuffer(a.getIndices()),this.registerVertices(e.value,c));return c}};m.Cylinder.prototype=m.vertexRegistry;m.Sphere=function(){var e;e=m.Shapes.SPHERE;this.getIntrinsicRadius=function(){return 30};this.getShape=function(){return e};this.getNindices=function(){return 5400};this.computeGeometry=function(e,a,
c,d){var b,f,k,g,l,q,p,s,n,r,w;r=e.getVertices();p=q=0;k=e.getNormals();for(g=0;g<=c;g++)for(l=g*Math.PI/c,n=Math.sin(l),f=Math.cos(l),l=0;l<=d;l++)b=2*l*Math.PI/d,s=Math.sin(b),b=Math.cos(b),s*=n,w=f,b*=n,k[p]=s,r[p++]=a*s,k[p]=w,r[p++]=a*w,k[p]=b,r[p++]=a*b;e.setNvertices(--p);k=e.getIndices();for(g=0;g<c;g++)for(l=0;l<d;l++)a=g*(d+1)+l,p=a+d+1,k[q++]=a,k[q++]=p,k[q++]=a+1,k[q++]=p,k[q++]=p+1,k[q++]=a+1;e.setNindices(--q)};this.getVertexBuffers=function(h){var a,c;this.hasVertices(e.value)?c=this.retrieveVertices(e.value):
(a=new m.Surface(961,5400),c={},this.computeGeometry(a,30,30,30),c.vertices=h.createBuffer(a.getVertices()),c.normals=h.createBuffer(a.getNormals()),c.indices=h.createIndexBuffer(a.getIndices()),this.registerVertices(e.value,c));return c}};m.Sphere.prototype=m.vertexRegistry})(window.vizit.geometry);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.SurfaceRenderer=function(e){var h,a,c,d,b,f,k,g,l,q,p,s,n;this.createProgram=function(d){d=f.createProgram("attribute vec3 normal;attribute vec3 position;uniform   vec3 ambientLighting;uniform   vec3 directionalLighting;uniform   vec3 directionalColor;uniform   mat4 modelViewMatrix;uniform   mat4 globalModelViewMatrix;uniform   mat3 normalMatrix;uniform   mat4 projectionMatrix;varying   vec3 lighting;void main(void){  gl_Position = projectionMatrix * globalModelViewMatrix * modelViewMatrix * vec4(position, 1.0);  vec3  transformedNormal         = normalMatrix * normal;  float directionalLightWeighting = max(dot(transformedNormal, directionalLighting), 0.0);  lighting                        = ambientLighting + directionalColor * directionalLightWeighting;}","precision mediump float;uniform vec4 surfaceColor;varying vec3 lighting;void main(void){  gl_FragColor = vec4(surfaceColor.rgb * lighting, surfaceColor.a);}");
h=f.getUniformLocation(d,"ambientLighting");a=f.getUniformLocation(d,"directionalLighting");c=f.getUniformLocation(d,"directionalColor");k=f.getUniformLocation(d,"modelViewMatrix");b=f.getUniformLocation(d,"globalModelViewMatrix");g=f.getAttribLocation(d,"normal");l=f.getUniformLocation(d,"normalMatrix");q=f.getAttribLocation(d,"position");s=f.getUniformLocation(d,"projectionMatrix");n=f.getUniformLocation(d,"surfaceColor");return d};this.getAmbientLightingHandle=function(){return h};this.getDirectionalLightingHandle=
function(){return a};this.getDirectionalColorHandle=function(){return c};this.getModelViewMatrixHandle=function(){return k};this.getGlobalModelViewMatrixHandle=function(){return b};this.getNormalHandle=function(){return g};this.getNormalMatrixHandle=function(){return l};this.getPositionHandle=function(){return q};this.getProjectionMatrixHandle=function(){return s};this.getSurfaceColorHandle=function(){return n};this.render=function(g,k,e,q){var n;n=q.length;if(0<n)for(d.useProgram(p),d.uniformMatrix4fv(b,
!1,k),d.uniformMatrix3fv(l,!1,e),d.uniformMatrix4fv(s,!1,g),d.uniform3f(h,0.3,0.3,0.3),d.uniform3f(a,1,1,1),d.uniform3f(c,0.4,0.4,0.4),g=0;g<n;g++)q[g].render(f,this)};f=e;d=f.getGLContext();p=this.createProgram()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(m){m.IndexedVertices=function(e,h){var a,c,d,b;this.setNindices=function(a){c=a};this.getNindices=function(){return c};this.setNvertices=function(a){d=a};this.getNvertices=function(){return d};this.setVerticies=function(a){b=a};this.getVertices=function(){return b};this.setVerticies=function(a){b=a};this.getVertices=function(){return b};this.pushVertex=function(a){b[d++]=a};this.setIndices=function(b){a=b};this.getIndices=function(){return a};this.pushIndex=function(b){a[c++]=b};d=c=0;b=
new Float32Array(3*e);a=new Uint16Array(h)}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};(function(m){m.VectorFunction=function(e,h){var a,c;this.setModified=function(d){a=d};this.isModified=function(){return a};this.setName=function(a){c=a};this.getName=function(){return c};this.shouldStop=function(a,b,c,k){return 0>a*Q&&4>r2};this.getField=new Function(e,h);a=!0}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(m){m.CombinedVectorFunctions=function(){var e,h,a;this.addFunction=function(a){h=e.push(a);return this};for(var c=0;c<arguments.length;c++)this.addFunction(arguments[c]);this.getNfunctions=function(){return h};this.getFunctions=function(){return e};this.isModified=function(){var a;a=!1;for(c=0;c<h&&!a;c++)a=a||e[c].isModified();return a};this.setModified=function(a){for(c=0;c<h;c++)e[c].setModified(a)};this.setStartPoints=function(d){a=d};this.getStartPoints=function(){return a};this.getField=
function(a,b,c){for(var k,g=[0,0,0],l=0;l<h;l++)k=e[l].getField(a,b,c),g[0]+=k[0],g[1]+=k[1],g[2]+=k[2];return g};this.shouldStop=function(a,b,c,k){for(a=0;a<h&1;a++);return!1};h=0;e=[]}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(m){m.LineRenderer=function(e){var h,a,c,d,b,f,k;this.createProgram=function(){var a;a=c.createProgram("attribute vec3 position;uniform   mat4 modelViewMatrix;uniform   mat4 projectionMatrix;void main(){    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1);}","precision mediump float;uniform   vec4 color;void main(){    gl_FragColor = color;}");h=c.getUniformLocation(a,"color");d=c.getAttribLocation(a,"position");f=c.getUniformLocation(a,"modelViewMatrix");k=c.getUniformLocation(a,
"projectionMatrix");return a};this.drawIndexedLines=function(g,l,e,p){a.useProgram(b);a.lineWidth(1);a.uniform4fv(h,e);a.uniformMatrix4fv(f,!1,l);a.uniformMatrix4fv(k,!1,g);l=p.length;for(e=0;e<l;e++)g=p[e],c.bindBuffer(g.vertices,d,3,a.FLOAT,12,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,g.indices),a.drawElements(a.LINES,g.nindices,a.UNSIGNED_SHORT,0)};c=e;a=c.getGLContext();b=this.createProgram()}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(m){m.SimpleVectorField=function(e,h){var a,c,d,b,f,k,g,l,q,p,s,n,r,w;this.setArrowHeadWidth=function(a){c=a;return this};this.getArrowHeadWidth=function(){return c};this.setArrowHeadSize=function(b){a=b;return this};this.getArrowHeadSize=function(){return a};this.setColor=function(a){d=a;return this};this.getColor=function(){return d};this.setGlUtility=function(a){g=a;return this};this.getGlUtility=function(){return g};this.setMaxVectors=function(a){q=a;return this};this.getMaxVectors=function(){return q};
this.setModelViewMatrix=function(a){p=a;return this};this.getModelViewMatrix=function(){return p};this.setProjectionMatrix=function(a){n=a;return this};this.addStartPoints=function(a){b=b.concat(a);return this};this.getStartPoints=function(){return b};this.setupVectorField=function(){var a,d;"function"===typeof f.getStartPoints?(a=f.getStartPoints(0,2),a="undefined"!==typeof a?b.concat(a):b):a=b;k.setStartPoints(a);a={};d=k.generateField();a.vertices=g.createBuffer(d.getVertices());a.indices=g.createIndexBuffer(d.getIndices());
a.nindices=d.getNindices();l[0]=a;return l};this.render=function(){w&&(f.isModified()&&(l=this.setupVectorField()),g.clear(),s.drawIndexedLines(n,p,d,l),f.setModified(!1))};this.start=function(){s=new vizit.vectorfield.LineRenderer(g);k=new vizit.vectorfield.VectorFieldGenerator(f,q,a,c,r);w=!0;this.render()};c=0.5;a=0.3;f=e;l=[];d=new Float32Array([0.8,0.3,0.3,1]);q=5;r="undefined"===typeof h?1:h;b=[];w=!1}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(m){m.CountdownLatch=function(e,h){var a=e;this.countDown=function(){a--;0>=a&&h()}}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargeGenerator=function(e){var h,a,c,d,b,f,k,g;this.setCharges=function(b){a=b;h*a.getCharges().length>c.byteLength&&(c=new ArrayBuffer(h*a.getCharges().length))};this.getCharges=function(){return a};this.getChargesArray=function(){return c};this.getNcharges=function(){return d};this.generate=function(){var l,e,h,s,n,r;r=a.getCharges();d=r.length;n=new Float32Array(c);e=new Uint8Array(c);for(var w=0;w<d;w++)l=r[w],s=l.getPosition(),h=0+5*w,n[h++]=s[0],n[h++]=s[1],n[h++]=s[2],n[h++]=
k,h=16+20*w,l=0<l.getCharge()?g:0>l.getCharge()?b:f,e[h++]=l[0],e[h++]=l[1],e[h++]=l[2],e[h++]=l[3];return c};a=e;h=3*Float32Array.BYTES_PER_ELEMENT+Float32Array.BYTES_PER_ELEMENT+4*Uint8Array.BYTES_PER_ELEMENT;c=new ArrayBuffer(h*a.getCharges().length);k=16;b=[204,13,13,255];g=[13,13,204,255];f=[13,13,13,51]}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargeRenderer=function(e){var h,a,c,d,b,f,k,g;this.createProgram=function(){var f;f=c.createProgram("precision highp float;attribute vec3  position;attribute vec4  color;attribute float size;uniform   mat4  modelViewMatrix;uniform   mat4  projectionMatrix;varying vec4 vColor;void main(){    gl_Position  = projectionMatrix * modelViewMatrix * vec4(position, 1);    gl_PointSize = size;    vColor       = color;}","precision lowp float;varying vec4 vColor; void main() {   float dist = distance( vec2(0.5,0.5), gl_PointCoord );   if ( dist > 0.5 )     discard;   gl_FragColor = vColor; }");
h=c.getAttribLocation(f,"color");d=c.getUniformLocation(f,"modelViewMatrix");b=c.getAttribLocation(f,"position");k=c.getUniformLocation(f,"projectionMatrix");g=c.getAttribLocation(f,"size");a.enableVertexAttribArray(h);a.enableVertexAttribArray(b);a.enableVertexAttribArray(g);return f};this.render=function(c,e,p,s){a.useProgram(f);a.uniformMatrix4fv(d,!1,e);a.uniformMatrix4fv(k,!1,c);a.bindBuffer(a.ARRAY_BUFFER,p);a.vertexAttribPointer(b,3,a.FLOAT,!1,20,0);a.vertexAttribPointer(g,1,a.FLOAT,!1,20,
12);a.vertexAttribPointer(h,4,a.UNSIGNED_BYTE,!0,20,16);a.drawArrays(a.POINTS,0,s.getNcharges())};c=e;a=c.getGLContext();f=this.createProgram()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.FieldLineVBO=function(e,h){this.disable=function(){this.enabled=!1};this.isEnabled=function(){return this.enabled};this.reload=function(a,c){a.loadData(this.fieldLineBufferHandle,c.getPoints());this.npoints=c.getNpoints();a.loadData(this.fieldDirectionBufferHandle,c.getArrows());this.narrows=c.getNarrows();this.enabled=!0};this.fieldLineBufferHandle=e.createBuffer(h.getPoints());this.npoints=h.getNpoints();this.fieldDirectionBufferHandle=e.createBuffer(h.getArrows());this.narrows=h.getNarrows();
this.enabled=!0}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.FieldLine=function(e){var h,a,c,d,b,f;this.setMaxPoints=function(d){d!==e&&(e=d,b=new Float32Array(3*e),a=new Float32Array(e));return this};this.getMaxPoints=function(){return e};this.pushPoint=function(a,c,l){b[f++]=a;b[f++]=c;b[f++]=l;d++};this.getPoints=function(){return b};this.getNpoints=function(){return d};this.pushArrow=function(b,d,f,e,p,s,n,r,w){a[h++]=b;a[h++]=d;a[h++]=f;a[h++]=e;a[h++]=p;a[h++]=s;a[h++]=e;a[h++]=p;a[h++]=s;a[h++]=n;a[h++]=r;a[h++]=w;c++};this.getArrows=
function(){return a};this.getNarrows=function(){return c};this.reset=function(){f=d=c=h=0};b=new Float32Array(3*e);a=new Float32Array(e);this.reset()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.FieldLineGenerator=function(e,h,a,c,d){var b,f,k,g,l,q;this.setCharges=function(a){g=a;return this};this.getCharges=function(){return g};this.getArrows=function(){return arrows};this.setMaxPoints=function(a){a>maxpoints&&(l=new vizit.electricfield.FieldLine(q));q=a;return this};this.getMaxPoints=function(){return q};this.setArrowHeadSize=function(a){b=a;return this};this.getArrowHeadSize=function(){return b};this.setArrowSpacing=function(a){f=a;return this};this.getArrowSpacing=function(){return f};
this.setDs=function(a){k=a;return this};this.getDs=function(){return k};this.drawArrow=function(a,b,d,c,f,g,k){var l,e,h,q,m;l=c[0]/f;e=c[1]/f;h=c[2]/f;0!==h?(q=f=1,c=-(c[0]+c[1])/c[2]):(0!==e?(f=1,q=-(c[0]+c[2])/c[1]):(f=-(c[1]+c[2])/c[0],q=1),c=1);m=g/Math.sqrt(f*f+q*q+c*c);f*=m;q*=m;c*=m;l*=g;e*=g;g*=h;k.pushArrow(a-l+f,b-e+q,d-g+c,a,b,d,a-l-f,b-e-q,d-g-c)};this.generate=function(a,d,c,e){var h,u,m,t;h=0;u=!1;t=c;l.reset();for(c=0;c<q&&!u;c++){l.pushPoint(a,d,t);m=g.getField(a,d,t);u=Math.sqrt(m[0]*
m[0]+m[1]*m[1]+m[2]*m[2]);if(0===u)break;a+=e*m[0]/u*k;d+=e*m[1]/u*k;t+=e*m[2]/u*k;h+=k;h>f&&(h=0,this.drawArrow(a,d,t,m,u,b,l));u=g.shouldStop(e,a,d,t)}return l};b=c;f=d;g=e;k=a;q=h;l=new vizit.electricfield.FieldLine(q)}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.FieldLineRenderer=function(e){var h,a,c,d,b,f;this.createProgram=function(b){b=a.createProgram("attribute vec3 position;uniform   mat4 modelViewMatrix;uniform   mat4 projectionMatrix;void main(){  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}","precision mediump float;void main(){  gl_FragColor = vec4(0.8,0.3,0.3,1.0);}");c=a.getUniformLocation(b,"modelViewMatrix");d=a.getAttribLocation(b,"position");f=a.getUniformLocation(b,"projectionMatrix");return b};
this.render=function(e,g,l,q){l=q.length;if(0<l)for(h.useProgram(b),h.lineWidth(1),h.uniformMatrix4fv(c,!1,g),h.uniformMatrix4fv(f,!1,e),g=0;g<l;g++){e=q[g];if(!e.isEnabled())break;a.bindBuffer(e.fieldLineBufferHandle,d,3,h.FLOAT,12,0);h.drawArrays(h.LINE_STRIP,0,e.npoints);a.bindBuffer(e.fieldDirectionBufferHandle,d,3,h.FLOAT,12,0);h.drawArrays(h.LINES,0,e.narrows)}};a=e;h=a.getGLContext();b=this.createProgram(h)}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(m){m.Cylinder=function(){var e,h;this.setColor=function(a){h=a};this.getColor=function(){return h};this.getCylinderModelView=function(a,c,d,b,f,e,g){var l,h,p;p=Math.sin(g);g=Math.cos(g);h=Math.sin(e);e=Math.cos(e);l=new Float32Array(16);l[0]=f*e*g;l[1]=f*g*h;l[2]=-f*p;l[3]=0;l[4]=-f*h;l[5]=f*e;l[6]=0;l[7]=0;l[8]=b*e*p;l[9]=b*h*p;l[10]=b*g;l[11]=0;l[12]=a;l[13]=c;l[14]=d;l[15]=1;return l};this.transformPoints=function(a,c,d,b){var f,k,g;e[0]=a[0]*d;e[1]=a[1]*d;e[2]=a[2]*d;e[3]=a[3];e[4]=
a[4]*d;e[5]=a[5]*d;e[6]=a[6]*d;e[7]=a[7];e[8]=a[8]*c;e[9]=a[9]*c;e[10]=a[10]*c;e[11]=a[11];e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];c=0;for(a=b.length;c<a;c++)d=b[c],f=d[0],k=d[1],g=d[2],d[0]=e[0]*f+e[4]*k+e[8]*g+e[12],d[1]=e[1]*f+e[5]*k+e[9]*g+e[13],d[2]=e[2]*f+e[6]*k+e[10]*g+e[14];return b};this.setupBuffers=function(a,c,d,b,f){var e;e=a.getGLContext();a.bindBuffer(d,c.getPositionHandle(),3,e.FLOAT,0,0);a.bindBuffer(b,c.getNormalHandle(),3,e.FLOAT,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,
f)};this.drawCap=function(a,c,d){a.drawElements(a.TRIANGLE_FAN,c,a.UNSIGNED_SHORT,2*d)};this.drawSide=function(a,c,d){a.drawElements(a.TRIANGLE_STRIP,c,a.UNSIGNED_SHORT,2*d)};this.drawCylinder=function(a,c,d,b,f){a=a.getGLContext();a.uniformMatrix4fv(c.getModelViewMatrixHandle(),!1,d);f&&this.drawCap(a,b+2,0);this.drawSide(a,2*b+2,b+2);f&&this.drawCap(a,b+2,3*b+4)};this.fullRender=function(a,c,d,b,f,k,g){var l,q,p,s;l=a.getGLContext();p=this.getBaseRadius();s=this.getVertexBuffers(a);l.uniform4f(c.getSurfaceColorHandle(),
h.getRed(),h.getGreen(),h.getBlue(),h.getAlpha());q=(this.getNindices()-6)/4;this.setupBuffers(a,c,s.vertices,s.normals,s.indices);e[3]=d[3];e[7]=d[7];e[8]=d[8]*b;e[9]=d[9]*b;e[10]=d[10]*b;e[11]=d[11];e[12]=d[12];e[13]=d[13];e[14]=d[14];e[15]=d[15];l.cullFace(l.FRONT);for(b=k;b>=f;b--)s=b/p,e[0]=d[0]*s,e[1]=d[1]*s,e[2]=d[2]*s,e[4]=d[4]*s,e[5]=d[5]*s,e[6]=d[6]*s,this.drawCylinder(a,c,e,q,g);l.cullFace(l.BACK);for(b=f;b<=k;b++)s=b/p,e[0]=d[0]*s,e[1]=d[1]*s,e[2]=d[2]*s,e[4]=d[4]*s,e[5]=d[5]*s,e[6]=d[6]*
s,this.drawCylinder(a,c,e,q,g)};this.translateBounds=function(a,c,d,b,f,e,g){var l,h,p;l=(c+f)/2;h=(d+e)/2;p=(b+g)/2;c-=l;d-=h;b-=p;f-=l;e-=h;g-=p;a.setTx(l).setTy(h).setTz(p).setX0(c).setY0(d).setZ0(b).setX1(f).setY1(e).setZ1(g)};this.sign=function(a){return 0>a?-1:1};this.zAxisRotation=function(a,c,d,b,f){var e;e=Math.atan2(f-d,b-c);c=-this.sign(b)*Math.sqrt(c*c+d*d);d=0;b=-c;f=0;a.setX0(c).setY0(d).setX1(b).setY1(f).setPhi(e)};this.yAxisRotation=function(a,c,d,b,f,e,g){d=Math.sqrt(c*c+d*d+b*b);
e=Math.acos(g/d);b=this.sign(g);g=b*d;f=c=0;a.setZ0(-b*d).setZ1(g).setX0(c).setX1(f).setTheta(e)};this.scale=function(a,c,d){var b;b=this.sign(d);c=d-c;a.setZ0(0.5*-b).setZ1(0.5*b).setHeight(c)};e=new Float32Array(16)};m.Cylinder.prototype=new vizit.geometry.Cylinder})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.GaussianCylinder=function(e,h,a,c,d,b,f,k){var g,l,q,p,s,n,r,m,u,v,t;this.setEnabled=function(a){l=vizit.utility.toBoolean(a)};this.isEnabled=function(){return l};this.setX=function(a){u=a;p[12]=u;return this};this.getX=function(){return u};this.setY=function(a){v=a;p[13]=v;return this};this.getY=function(){return v};this.setZ=function(a){t=a;p[14]=t;return this};this.getZ=function(){return t};this.setOrigin=function(a){this.setX(a[0]);this.setY(a[1]);return this.setZ(a[2])};this.getOrigin=
function(){return[u,v,t]};this.setR=function(a){r=a;return this};this.getR=function(){return r};this.setHeight=function(a){q=a;return this};this.getHeight=function(){return q};this.setTheta=function(a){m=a;return this};this.getTheta=function(){return m};this.setPhi=function(a){n=a;return this};this.getPhi=function(){return n};this.setName=function(a){s=a};this.getName=function(){return s};this.render=function(a,b){l&&this.fullRender(a,b,p,q,r,r,!0)};g=new vizit.utility.Color(0.5,0.5,0.5,0.5);l=!0;
q=c;s=k;n=b;r=d;m=f;u=e;v=h;t=a;this.setColor(g);p=this.getCylinderModelView(u,v,t,this.getBaseHeight(),this.getBaseRadius(),n,m)};m.GaussianCylinder.prototype=new vizit.utility.Cylinder})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.GaussianSphere=function(e,h,a,c,d){var b,f,k,g,l,q,p,s;this.setColor=function(a){b=a};this.getColor=function(){return b};this.setEnabled=function(a){f=vizit.utility.toBoolean(a)};this.isEnabled=function(){return f};this.setX=function(a){q=a;return this};this.getX=function(){return q};this.setY=function(a){p=a;return this};this.getY=function(){return p};this.setZ=function(a){s=a;return this};this.getZ=function(){return s};this.setR=function(a){l=a;return this};this.getR=function(){return l};
this.setName=function(a){g=a};this.getName=function(){return g};this.getModelView=function(a){"undefined"===typeof a&&(a=1);"undefined"===typeof k?(k=new Float32Array(16),k[0]=a,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=a,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=a,k[11]=0,k[12]=q,k[13]=p,k[14]=s,k[15]=1):(k[0]=a,k[5]=a,k[10]=a);return k};this.drawFullSurface=function(a,b,d,c,f,g){var e;e=a.getGLContext();a.bindBuffer(d,b.getPositionHandle(),3,e.FLOAT,0,0);a.bindBuffer(c,b.getNormalHandle(),3,e.FLOAT,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,
f);e.drawElements(e.TRIANGLES,g,e.UNSIGNED_SHORT,0)};this.render=function(a,d){if(f){var c,g,e;c=a.getGLContext();g=this.getIntrinsicRadius();e=this.getVertexBuffers(a);c.uniformMatrix4fv(d.getModelViewMatrixHandle(),!1,this.getModelView(l/g));c.uniform4f(d.getSurfaceColorHandle(),b.getRed(),b.getGreen(),b.getBlue(),b.getAlpha());c.cullFace(c.FRONT);this.drawFullSurface(a,d,e.vertices,e.normals,e.indices,this.getNindices());c.cullFace(c.BACK);this.drawFullSurface(a,d,e.vertices,e.normals,e.indices,
this.getNindices())}};b=new vizit.utility.Color(0.5,0.5,0.5,0.5);f=!0;g=d;l=c;q=e;p=h;s=a};m.GaussianSphere.prototype=new vizit.geometry.Sphere})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargedCylinder=function(e,h,a,c,d,b,f,k,g,l,q,p){var s,n,r,m,u,v,t,y,C,B,G,I,F,K,H,A,E,x,z,D,L,J,M,N;this.setHeight=function(a){s=a;r=!0};this.getHeight=function(){return s};this.setTx=function(a){I=a;r=!0;return this};this.getTx=function(){return I};this.setTy=function(a){F=a;r=!0;return this};this.getTy=function(){return F};this.setTz=function(a){K=a;r=!0;return this};this.getTz=function(){return K};this.setX0=function(a){H=a;r=!0;return this};this.getX0=function(){return H};this.setY0=
function(a){A=a;r=!0;return this};this.getY0=function(){return A};this.setZ0=function(a){E=a;r=!0;return this};this.getZ0=function(){return E};this.setX1=function(a){x=a;r=!0;return this};this.getX1=function(){return x};this.setY1=function(a){z=a;r=!0;return this};this.getY1=function(){return z};this.setZ1=function(a){D=a;r=!0;return this};this.getZ1=function(){return D};this.setR0=function(a){B=a;r=!0;return this};this.getR0=function(){return B};this.setR1=function(a){G=a;r=!0;return this};this.getR1=
function(){return G};this.setPhi=function(a){v=a;r=!0;return this};this.getPhi=function(){return v};this.setTheta=function(a){t=a;r=!0;return this};this.getTheta=function(){return t};this.setNfieldLines=function(a){u=a;r=!0;return this};this.getNfieldLines=function(){return u};this.setModified=function(a){r=a;return this};this.isModified=function(){return r};this.setName=function(a){m=a;return this};this.getName=function(){return m};this.getStartPoints=function(){var a,b,c,d,f,g,e;e=[];if(0!==C+u){g=
this.sign(y);b=Math.max(2,Math.round(Math.abs(y*Math.PI*(G*G-B*B)*C*s)))+u;c=(B+1)/G;d=0.707106781*(B+1)/G;f=-0.5;a=1/(b-1);for(var l=0;l<b;l++)e.push([c,0,f,g]),e.push([-c,0,f,g]),e.push([0,c,f,g]),e.push([0,-c,f,g]),e.push([d,d,f,g]),e.push([d,-d,f,g]),e.push([-d,-d,f,g]),e.push([-d,d,f,g]),f+=a}return this.transformPoints(n,s/this.getBaseHeight(),G/this.getBaseRadius(),e)};this.getNormal=function(a,b,d){var c,f,g,e;c={};f=-((H-a)*L+(A-b)*J+(E-d)*M)/(N*N);g=H+f*L;e=A+f*J;f=E+f*M;c.x=a-g;c.y=b-e;
c.z=d-f;return c};this.getField=function(a,b,d){var c;c=Array(3);b=this.getNormal(a,b,d);d=Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z);a=2*(d<B?0:d<G?Math.PI*(d*d-B*B)*y:Math.PI*(G*G-B*B)*y)/d;c[0]=a*b.x/d;c[1]=a*b.y/d;c[2]=a*b.z/d;return c};this.render=function(a,b){this.fullRender(a,b,n,s/this.getBaseHeight(),B/this.getBaseRadius(),G/this.getBaseRadius(),!1)};r=!0;m=p;y="undefined"===typeof g?0:g;C="undefined"===typeof l?0:l;u="undefined"===typeof q?0:q;B=f;G=k;H=e;A=h;E=a;x=c;z=d;D=b;f=0<y?new vizit.utility.Color(0.05,
0.05,0.8,0.3):0>y?new vizit.utility.Color(0.8,0.05,0.05,0.3):new vizit.utility.Color(0.5,0.5,0.5,0.2);this.setColor(f);this.translateBounds(this,H,A,E,x,z,D);this.zAxisRotation(this,H,A,x,z);this.yAxisRotation(this,H,A,E,x,z,D);this.scale(this,E,D);H=e;A=h;E=a;x=c;z=d;D=b;n=this.getCylinderModelView(I,F,K,this.getBaseHeight(),this.getBaseRadius(),v,t);L=x-H;J=z-A;M=D-E;N=Math.sqrt(L*L+J*J+M*M)};m.ChargedCylinder.prototype=new vizit.utility.Cylinder})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargedLine=function(e,h,a,c,d,b,f,k,g,l){var q,p,s,n,r,m,u,v,t,y,C,B,G,I,F,K,H,A,E,x,z,D,L,J;this.computeColor=function(a){return 0<a?new vizit.utility.Color(0.05,0.05,0.8,0.8):0>a?new vizit.utility.Color(0.8,0.05,0.05,0.8):new vizit.utility.Color(0.5,0.5,0.5,0.8)};this.setChargeDensity=function(a){q=a;r=!0;this.setColor(this.computeColor(q))};this.getChargeDensity=function(){return q};this.setHeight=function(a){s=a;r=!0};this.getHeight=function(){return s};this.setTx=function(a){B=
a;r=!0;return this};this.getTx=function(){return B};this.setTy=function(a){G=a;return this};this.getTy=function(){return G};this.setTz=function(a){I=a;r=!0;return this};this.getTz=function(){return I};this.setX0=function(a){F=a;r=!0;return this};this.getX0=function(){return F};this.setY0=function(a){K=a;r=!0;return this};this.getY0=function(){return K};this.setZ0=function(a){H=a;r=!0;return this};this.getZ0=function(){return H};this.setX1=function(a){A=a;r=!0;return this};this.getX1=function(){return A};
this.setY1=function(a){E=a;r=!0;return this};this.getY1=function(){return E};this.setZ1=function(a){x=a;r=!0;return this};this.getZ1=function(){return x};this.setR0=function(a){y=a;r=!0;return this};this.getR0=function(){return y};this.setR1=function(a){C=a;r=!0;return this};this.getR1=function(){return C};this.setPhi=function(a){v=a;r=!0;return this};this.getPhi=function(){return v};this.setTheta=function(a){t=a;r=!0;return this};this.getTheta=function(){return t};this.setNfieldLines=function(a){u=
a;r=!0;return this};this.getNfieldLines=function(){return u};this.setModified=function(a){r=a;return this};this.isModified=function(){return r};this.setName=function(a){m=a;return this};this.getName=function(){return m};this.getStartPoints=function(){var a,b,d,c,f;f=[];if(0!==p+u){c=this.sign(q);b=Math.max(2,Math.round(Math.abs(q*p*s)))+u;d=-0.5;a=1/(b-1);for(var g=0;g<b;g++)f.push([1,0,d,c]),f.push([-1,0,d,c]),f.push([0,1,d,c]),f.push([0,-1,d,c]),f.push([0.707106781,0.707106781,d,c]),f.push([0.707106781,
-0.707106781,d,c]),f.push([-0.707106781,-0.707106781,d,c]),f.push([-0.707106781,0.707106781,d,c]),d+=a}return this.transformPoints(n,s/this.getBaseHeight(),(y+1)/this.getBaseRadius(),f)};this.getNormal=function(a,b,d){var c,f,g,e;c={};f=-((F-a)*z+(K-b)*D+(H-d)*L)/(J*J);g=F+f*z;e=K+f*D;f=H+f*L;c.x=a-g;c.y=b-e;c.z=d-f;return c};this.getField=function(a,b,d){var c;d=this.getNormal(a,b,d);c=Math.sqrt(d.x*d.x+d.y*d.y+d.z*d.z);a=Array(3);b=2*q/c;a[0]=b*d.x/c;a[1]=b*d.y/c;a[2]=b*d.z/c;return a};this.render=
function(a,b){this.fullRender(a,b,n,s,y,C,!1)};q="undefined"===typeof f?0:f;this.setColor(this.computeColor(q));r=!0;m=l;p="undefined"===typeof k?0:k;u="undefined"===typeof g?0:g;y=0;C=3;F=e;K=h;H=a;A=c;E=d;x=b;this.translateBounds(this,F,K,H,A,E,x);this.zAxisRotation(this,F,K,A,E);this.yAxisRotation(this,F,K,H,A,E,x);this.scale(this,H,x);F=e;K=h;H=a;A=c;E=d;x=b;n=this.getCylinderModelView(B,G,I,this.getBaseHeight(),this.getBaseRadius(),v,t);z=A-F;D=E-K;L=x-H;J=Math.sqrt(z*z+D*D+L*L)};m.ChargedLine.prototype=
new vizit.utility.Cylinder})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargedPlane=function(e,h,a,c,d,b,f,k,g,l,q,p,s,n,r,m){var u,v,t,y,C,B,G,I,F,K,H,A,E,x,z,D,L,J,M,N,O,P,S,R;this.setNfieldLines=function(a){H=a;F=!0;return this};this.getNfieldLines=function(){return H};this.setModified=function(a){F=a;return this};this.isModified=function(){return F};this.setName=function(a){K=a;return this};this.getName=function(){return K};this.calculateNormal=function(a){var b;b=Array(3);b[0]=(a[4]-a[1])*(a[11]-a[2])-(a[5]-a[2])*(a[10]-a[1]);b[1]=(a[5]-a[2])*(a[9]-
a[0])-(a[3]-a[0])*(a[11]-a[2]);b[2]=(a[3]-a[0])*(a[10]-a[1])-(a[4]-a[1])*(a[9]-a[0]);a=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]/=a;b[1]/=a;b[2]/=a;return b};this.adjustStartPoints=function(a){var b,d,c,f,g;b=a.length;for(var e=0;e<b;e++)d=a[e],c=d[0],f=d[1],g=d[2],d[0]=N+G*(J*c*C+g*x)+D*(-M*f*B+z*(-J*c*x+g*C)),d[1]=O+G*(M*f*B+z*(J*c*x-g*C))+D*(J*c*C+g*x),d[2]=P+M*f*z+B*(-J*c*x+g*C);return a};this.getStartPoints=function(){var a,b,d,c,f,g,e;b=Math.abs(L*E)+H/Math.abs(J*M);f=[];if(0<b)for(a=Math.sqrt(1/
b),b=a/Math.abs(J),a/=Math.abs(M),d=!1,c=0<L?1:-1,g=Math.min(-0.5+b/2,0.5),e=Math.min(-0.5+a/2,0.5);!d;)f.push([g,e,0.4,c]),f.push([g,e,-0.4,c]),e+=a,0.5<e?(e=0.5-(e-0.5),g+=b,a=-a):-0.5>e&&(e=-0.5-(e- -0.5),g+=b,a=-a),d=0.5<g;return this.adjustStartPoints(f)};this.getField=function(a,b,d){var c;c=Array(3);a=(a-y[0])*A[0]+(b-y[1])*A[1]+(d-y[2])*A[2];b=S*L;0===a&&(c[0]=0,c[1]=0,c[2]=0);0<a?(c[0]=b*A[0],c[1]=b*A[1],c[2]=b*A[2]):(c[0]=-b*A[0],c[1]=-b*A[1],c[2]=-b*A[2]);return c};this.translateBoundingBox=
function(b){N=(e+f)/2;O=(h+k)/2;P=(a+g)/2;b[0]-=N;b[1]-=O;b[2]-=P;b[3]-=N;b[4]-=O;b[5]-=P;b[6]-=N;b[7]-=O;b[8]-=P;b[9]-=N;b[10]-=O;b[11]-=P;return b};this.zAxisRotation=function(a){var b,c;b=a[3]-a[0];c=a[0]-a[9];0===b||0===c?(t=0,R=0===b&&0===c?0===a[4]-a[1]?1:2:0===b?1:2):(b=(d-h)/b,c=(k-d)/c,Math.abs(b)<Math.abs(c)?(t=Math.atan(b),R=1):(t=Math.atan(c),R=2));G=Math.cos(t);D=Math.sin(t);for(var f=0;4>f;f++)c=G*a[3*f]-D*a[3*f+1],b=D*a[3*f]+G*a[3*f+1],a[3*f]=c,a[3*f+1]=b;return a};this.xAxisRotation=
function(a,b){var c,d;1===b?(c=a[1]-a[10],d=a[2]-a[11]):(c=a[4]-a[1],d=a[5]-a[2]);z=v=0;B=1;if(0!==d&&0!==c){v=Math.atan(d/c);z=Math.sin(v);B=Math.cos(v);for(var f=0;4>f;f++)c=B*a[3*f+1]-z*a[3*f+2],d=z*a[3*f+1]+B*a[3*f+2],a[3*f+1]=c,a[3*f+2]=d}return a};this.yAxisRotation=function(a,b){var c,d;1===b?(c=a[0]-a[9],d=a[2]-a[11]):(c=a[3]-a[0],d=a[5]-a[2]);x=u=0;C=1;if(0!==d){0!==c?(u=Math.atan(d/c),x=Math.sin(u),C=Math.cos(u)):(u=1.5707963267948966,x=1,C=0);for(var f=0;4>f;f++)c=C*a[3*f]+x*a[3*f+2],d=
-x*a[3*f]+C*a[3*f+2],a[3*f]=c,a[3*f+2]=d}return a};this.scaleBoundingbox=function(a,b){1===b?(J=a[0]-a[9],M=a[4]-a[1]):(J=a[3]-a[0],M=a[1]-a[10]);for(var c=0;4>c;c++)0!==J&&(a[3*c]/=J),0!==M&&(a[3*c+1]/=M);return a};this.getModelView=function(){return I};this.drawFullSurface=function(a,b,c,d,f,g){var e;e=a.getGLContext();a.bindBuffer(c,b.getPositionHandle(),3,e.FLOAT,0,0);a.bindBuffer(d,b.getNormalHandle(),3,e.FLOAT,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f);e.drawElements(e.TRIANGLES,g,e.UNSIGNED_SHORT,
0)};this.render=function(a,b){var c,d,f;c=a.getGLContext();f=this.getVertexBuffers(a);0<L?c.uniform4f(b.getSurfaceColorHandle(),0.05,0.05,0.8,0.4):0>L?c.uniform4f(b.getSurfaceColorHandle(),0.8,0.05,0.05,0.4):c.uniform4f(b.getSurfaceColorHandle(),0.5,0.5,0.5,0.2);d=this.getNindices();c.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView());c.disable(c.CULL_FACE);this.drawFullSurface(a,b,f.vertices,f.normals,f.indices,d);c.enable(c.CULL_FACE)};F=!0;K=m;S=6.283185307179586;L="undefined"===
typeof s?0:s;E="undefined"===typeof n?0:n;H="undefined"===typeof r?0:r;y=[e,h,a,c,d,b,f,k,g,l,q,p];c=y.slice(0);A=this.calculateNormal(y);c=this.translateBoundingBox(c);c=this.zAxisRotation(c);c=this.xAxisRotation(c,R);c=this.yAxisRotation(c,R);c=this.scaleBoundingbox(c,R);I=new Float32Array(16);C=Math.cos(-u);B=Math.cos(-v);G=Math.cos(-t);x=Math.sin(-u);z=Math.sin(-v);D=Math.sin(-t);I[0]=J*(C*G-x*z*D);I[1]=J*(C*D+G*x*z);I[2]=-J*B*x;I[3]=0;I[4]=-M*B*D;I[5]=M*B*G;I[6]=M*z;I[7]=0;I[8]=z*D*C+x*G;I[9]=
-(z*C*G-x*D);I[10]=C*B;I[11]=0;I[12]=N;I[13]=O;I[14]=P;I[15]=1};m.ChargedPlane.prototype=new vizit.geometry.Square})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargedSphere=function(e,h,a,c,d,b,f,k,g){var l,q,p,s,n,r,m,u,v,t,y;m=!0;u=g;v=0;l=c;q=l*l;p=q*l;s=d;n=s*s*s;t="undefined"===typeof b?0:b;y="undefined"===typeof f?0:f;nfieldLines="undefined"===typeof k?0:k;this.setA=function(a){l=a;q=l*l;p=q*l;m=!0;return this};this.getA=function(){return l};this.setB=function(a){s=a;n=s*s*s;m=!0;return this};this.getB=function(){return s};this.setNindices=function(a){v=a;return this};this.setModified=function(a){m=a;return this};this.isModified=function(){return m};
this.setNfieldLines=function(a){nfieldLines=a;m=!0;return this};this.getNfieldLines=function(){return nfieldLines};this.setName=function(a){u=a;return this};this.getName=function(){return u};this.getStartPoints=function(){var b,c,d,f,g,k,q;k=0<t?1:0>t?-1:0;b=Math.round(y*t*k)+nfieldLines;f=3.6/Math.sqrt(b);c=0;radius=l+0.2*(s-l);g=[];for(var r=1;r<b;r++)q=-1+2*r/b,d=Math.sqrt(1-q*q),c+=f/d,g.push([Math.cos(c)*d*radius+e,q*radius+h,Math.sin(c)*d*radius+a,k]);return g};this.getField=function(b,c,d){var f,
g=[0,0,0],k;b-=e;c-=h;d-=a;f=b*b+c*c+d*d;if(f<=q)return g;k=Math.sqrt(f);f=k>=l&&k<s?t*(k-p/f)/(n-p):t/f;g[0]=f*b/k;g[1]=f*c/k;g[2]=f*d/k;return g};this.getModelView=function(b){"undefined"===typeof b&&(b=1);null===r?(r=new Float32Array(16),r[0]=b,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=b,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=b,r[11]=0,r[12]=e,r[13]=h,r[14]=a,r[15]=1):(r[0]=b,r[5]=b,r[10]=b);return r};this.drawFullSurface=function(a,b,c,d,f,g){var e;e=a.getGLContext();a.bindBuffer(c,b.getPositionHandle(),3,
e.FLOAT,0,0);a.bindBuffer(d,b.getNormalHandle(),3,e.FLOAT,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f);e.drawElements(e.TRIANGLES,g,e.UNSIGNED_SHORT,0)};this.render=function(a,b){var c,d,f,g,e;d=a.getGLContext();c=this.getIntrinsicRadius();e=this.getVertexBuffers(a);0<t?d.uniform4f(b.getSurfaceColorHandle(),0.05,0.05,0.8,0.2):0>t?d.uniform4f(b.getSurfaceColorHandle(),0.8,0.05,0.05,0.2):d.uniform4f(b.getSurfaceColorHandle(),0.5,0.5,0.5,0.2);v=this.getNindices();d.cullFace(d.FRONT);for(f=s;f>=l;f--)g=
f/c,d.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView(g)),this.drawFullSurface(a,b,e.vertices,e.normals,e.indices,v);d.cullFace(d.BACK);for(f=l;f<=s;f++)g=f/c,this.drawFullSurface(a,b,e.vertices,e.normals,e.indices,v),d.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView(g))}};m.ChargedSphere.prototype=new vizit.geometry.Sphere})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.Charge=function(e,h,a,c,d,b,f){var k,g,l,q,p,m,n;this.setCharge=function(a){k=vizit.utility.ensureNumber(a);g=!0};this.getCharge=function(){return k};this.setX=function(a){p[0]=vizit.utility.ensureNumber(a);g=!0};this.getX=function(){return p[0]};this.setY=function(a){p[1]=vizit.utility.ensureNumber(a);g=!0};this.getY=function(){return p[1]};this.setZ=function(a){p[2]=vizit.utility.ensureNumber(a);g=!0};this.getZ=function(){return p[2]};this.setPosition=function(a){p=a;g=!0};this.getPosition=
function(){return p};this.setNfieldLines=function(a){q=a;g=!0};this.getNfieldLines=function(){return q};this.setModified=function(a){g=a};this.isModified=function(){return g};this.setName=function(a){l=a};this.getName=function(){return l};this.getField=function(a,b,c){var d,f=[0,0,0],g;a-=p[0];b-=p[1];c-=p[2];n=a*a+b*b+c*c;if(0>=n)return f;g=Math.sqrt(n);d=k/n;f[0]=d*a/g;f[1]=d*b/g;f[2]=d*c/g;return f};this.getFieldSeedPointsI=function(a){var b,c,d,f,g,e;f=[];g=0<k?1:0>k?-1:0;a=Math.round(a*k*g);
b=2/a;for(var l=0;l<a;l++)e=l*b-1+b/2,d=Math.sqrt(1-e*e),c=2.39996323*l,f.push([Math.cos(c)*d+p[0],e+p[1],Math.sin(c)*d+p[2],g]);return f};this.getStartPoints=function(a,b){var c,d,f,g,e,l,h;l=0<k?1:0>k?-1:0;c=Math.round(m*k*l)+1+q;g=3.6/Math.sqrt(c);d="undefined"===typeof a?Math.PI/2:a;b="undefined"===typeof b?1:b;e=[];if(0<c)for(var n=1;n<c;n++)h=-1+2*n/c,f=Math.sqrt(1-h*h),d+=g/f,e.push([Math.cos(d)*f*b+p[0],h*b+p[1],Math.sin(d)*f*b+p[2],l]);return e};this.shouldStop=function(a,b,c,d){return 0>
a*k&&4>n};k=c;g=!0;l=f;p=[vizit.utility.ensureNumber(e),vizit.utility.ensureNumber(h),vizit.utility.ensureNumber(a)];m="undefined"===typeof d?0:d;q="undefined"===typeof b?0:b};m.Charges=function(){var e,h,a,c;this.addCharge=function(b){a=e.push(b);return this};for(var d=0;d<arguments.length;d++)this.addCharge(arguments[d]);this.getNcharges=function(){return a};this.getCharges=function(){return e};this.addDistribution=function(a){c=h.push(a);return this};this.getNdistributions=function(){return c};
this.getDistributions=function(){return h};this.chargesModified=function(){var b;b=!1;for(d=0;d<a&&!b;d++)b=b||e[d].isModified();return b};this.distributionsModified=function(){var a;a=!1;for(d=0;d<c&&!a;d++)a=a||h[d].isModified();return a};this.isModified=function(){return this.chargesModified()||this.distributionsModified()};this.setModified=function(b){for(d=0;d<a;d++)e[d].setModified(b);for(d=0;d<c;d++)h[d].setModified(b)};this.getStartPoints=function(b,d){var k,g=b,l=1.57079632679/(a+1),q=[],
p;for(k=0;k<a;k++)p=e[k],q=q.concat(p.getStartPoints(g,d)),g+=l;for(k=0;k<c;k++)q=q.concat(h[k].getStartPoints());return q};this.getField=function(b,d,k){for(var g,l=[0,0,0],q=0;q<a;q++)g=e[q],g=g.getField(b,d,k),l[0]+=g[0],l[1]+=g[1],l[2]+=g[2];for(q=0;q<c;q++)g=h[q].getField(b,d,k),l[0]+=g[0],l[1]+=g[1],l[2]+=g[2];return l};this.shouldStop=function(b,c,d,g){var l;l=!1;for(var h=0;h<a&!l;h++)l=e[h],l=l.shouldStop(b,c,d,g);return l};a=0;e=[];h=[]}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ElectricField=function(){var e,h,a,c,d,b,f,k,g,l,q,p,m,n,r,w,u,v,t,y,C;this.setArrowSpacing=function(a){h=a;"undefined"!==typeof r&&r.setArrowSpacing(a);return this};this.getArrowSpacing=function(){return h};this.setArrowHeadSize=function(a){e=a;"undefined"!==typeof r&&r.setArrowHeadSize(a);return this};this.getArrowHeadSize=function(){return e};this.setColor=function(a){f=a;return this};this.getColor=function(){return f};this.setCharges=function(a){b=a;return this};this.getCharges=
function(){return b};this.addGaussianSurface=function(a){l.push(a);return this};this.getGaussianSurfaces=function(){return l};this.setGlUtility=function(a){q=a;return this};this.getGlUtility=function(){return q};this.setMaxVectors=function(a){m=a;return this};this.getMaxVectors=function(){return m};this.setModelViewMatrix=function(a){u=a;n=q.extractRotationPart(u,n);return this};this.getModelViewMatrix=function(){return u};this.setProjectionMatrix=function(a){v=a;return this};this.addStartPoint=function(a,
b,c,d){t.push([a,b,c,d]);return this};this.addStartPoints=function(a){t=t.concat(a)};this.getStartPoints=function(){return t};this.render=function(){if(y){var c;c=q.getGLContext();b.chargesModified()?(this.setupCharges(),this.setupFieldLines()):b.distributionsModified()&&this.setupFieldLines();q.clear();d.render(v,u,a,b);w.render(v,u,f,g);c.enable(c.BLEND);c.enable(c.CULL_FACE);c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA);C.render(v,u,n,b.getDistributions());c.disable(c.DEPTH_TEST);C.render(v,u,
n,l);c.enable(c.DEPTH_TEST);c.disable(c.BLEND);c.disable(c.CULL_FACE);b.setModified(!1)}};this.setupCharges=function(b){a||(b=q.getGLContext(),a=b.createBuffer());b=c.generate();q.loadData(a,b)};this.setupFieldLines=function(){var a,c,d,f,e,l;e=[];e=e.concat(b.getStartPoints(0,5));e=e.concat(t);d=e.length;f=g.length;l=Math.min(d,f);for(c=0;c<l;++c)a=e[c],a=r.generate(a[0],a[1],a[2],a[3]),g[c].reload(q,a);for(;c<f;++c)g[c].disable();for(;c<d;++c)a=e[c],a=r.generate(a[0],a[1],a[2],a[3]),g.push(new vizit.electricfield.FieldLineVBO(q,
a))};this.start=function(){q.clearColor(0,0,0,0);w=new vizit.electricfield.FieldLineRenderer(q);c=new vizit.electricfield.ChargeGenerator(b);r=new vizit.electricfield.FieldLineGenerator(b,p,k,e,h);this.setupFieldLines(b,p,k,e,h);d=new vizit.electricfield.ChargeRenderer(q);this.setupCharges(b);C=new vizit.electricfield.SurfaceRenderer(q);y=!0;this.render()};e=0.3;h=1.2;f=new Float32Array([0.8,0.3,0.3,1]);k=0.6;g=[];l=[];p=3E3;m=5;n=new Float32Array([1,0,0,0,1,0,0,0,1]);t=[];y=!1}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(m){m.VectorFieldGenerator=function(e,h,a,c,d){var b,f,k,g,l,q,p,m;this.setStartPoints=function(a){m=a;return this};this.getStartPoints=function(){return m};this.setMaxVectors=function(a){q=a;return this};this.getMaxVectors=function(){return q};this.setArrowHeadSize=function(a){f=a;return this};this.getArrowHeadSize=function(){return f};this.setVectorSpacing=function(a){vectorSpacing=a;return this};this.getVectorSpacing=function(){return vectorSpacing};this.setDs=function(a){g=a;return this};
this.getDs=function(){return g};this.generateVector=function(a,b,c,d,f,e,g,l,h,k){var q,m,p,s,A,E,x,z,D,L,J,M,N;L=a+d[0]*h;J=b+d[1]*h;M=c+d[2]*h;0!==d[2]?(x=E=1,z=-(d[0]+d[1])/d[2]):(0!==d[1]?(E=1,x=-(d[0]+d[2])/d[1]):(E=-(d[1]+d[2])/d[0],x=1),z=1);D=g*e*f*h/Math.sqrt(E*E+x*x+z*z);E*=D;x*=D;z*=D;q=e*d[0]*h;m=e*d[1]*h;d=e*d[2]*h;p=m*z-d*x;s=d*E-q*z;A=q*x-m*E;D=g*e*f*h/Math.sqrt(p*p+s*s+A*A);p*=D;s*=D;A*=D;f=L-q+E;e=J-m+x;g=M-d+z;E=L-q-E;x=J-m-x;z=M-d-z;h=L-q+p;D=J-m+s;N=M-d+A;q=L-q-p;m=J-m-s;A=M-d-
A;d=6*l+1;k.pushVertex(a);k.pushVertex(b);k.pushVertex(c);k.pushIndex(6*l);k.pushVertex(L);k.pushVertex(J);k.pushVertex(M);k.pushIndex(d);k.pushVertex(f);k.pushVertex(e);k.pushVertex(g);k.pushIndex(6*l+2);k.pushIndex(d);k.pushVertex(E);k.pushVertex(x);k.pushVertex(z);k.pushIndex(6*l+3);k.pushIndex(d);k.pushVertex(h);k.pushVertex(D);k.pushVertex(N);k.pushIndex(6*l+4);k.pushIndex(d);k.pushVertex(q);k.pushVertex(m);k.pushVertex(A);k.pushIndex(6*l+5);k.pushIndex(d)};this.trace=function(a,c,d,e,l,k,h,
q,m){var p,s,F,K,H;H=K=p=0;for(s=!1;H<k&&!s;){F=a.getField(c,d,e);s=Math.sqrt(F[0]*F[0]+F[1]*F[1]+F[2]*F[2]);if(0===s)break;p>=K&&(this.generateVector(c,d,e,F,s,f,b,h+H,q,m),K=p+Math.max(1.2*s*q,1),H++);c+=l*F[0]/s*g;d+=l*F[1]/s*g;e+=l*F[2]/s*g;p+=g;s=a.shouldStop(l,c,d,e)}return H};this.generateField=function(){var a,b,c,d;c=m.length;p=0;b=new vizit.utility.IndexedVertices(6*q*c,10*q*c);for(a=0;a<c;a++)d=m[a],d[4]=p,p+=this.trace(l,d[0],d[1],d[2],d[3],q,p,k,b);return b};b=c;f=a;g=0.33;l=e;q=h;k=
d}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.field=window.vizit.field||{};
(function(m){m.FieldRenderer=function(e){var h,a,c,d,b,f,k,g;this.getContext=function(){return c.getGLContext()};this.setRenderer=function(a){f=a;f.setGlUtility(c);f.setModelViewMatrix(d);f.setProjectionMatrix(b)};this.getRenderer=function(){return f};this.setModelViewMatrix=function(a){d=a;f.setModelViewMatrix(d)};this.getModelViewMatrix=function(){return d};this.requestRender=function(){k||(k=!0,requestAnimationFrame(this.render))};this.render=function(){f.render();k=!1};this.start=function(){f.start()};
this.setScale=function(a){g=a;1>g&&(g=1);b=c.generateOrthographicMatrix(g,g,-g,g);f.setProjectionMatrix(b);this.render()};this.zoomBy=function(a){this.setScale(g+a)};this.setElementName=function(a,b){h[b]=a};this.getElementByName=function(a){var b;h.hasOwnProperty(a)&&(b=h[a]);return b};h={};c=new vizit.utility.GLUtility(e);g=5;d=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);new Float32Array([1,0,0,0,1,0,0,0,1]);b=c.generateOrthographicMatrix(g,g,-g,g);a=new vizit.utility.MotionEventHandler(this,
c,75,4);e.addEventListener("mousewheel",a.handleMouseWheel.bind(a),!1);e.addEventListener("DOMMouseScroll",a.handleMouseWheel.bind(a),!1);e.addEventListener("mousedown",a.handleMouseDown.bind(a),!1);document.addEventListener("mouseup",a.handleMouseUp.bind(a),!1);document.addEventListener("mousemove",a.handleMouseMove.bind(a),!1);e.addEventListener("touchstart",a.handleTouchStart.bind(a),!1);e.addEventListener("touchmove",a.handleTouchMove.bind(a),!1);e.addEventListener("touchend",a.handleTouchEnd.bind(a),
!1)}})(window.vizit.field);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.BindingBuilder=function(){this.bindingBuilder=function(e,h,a){var c,d,b,f;for(b in h)"set"===b.toLowerCase()?f=h[b]:"from"===b.toLowerCase()?c=h[b]:"mapping"===b.toLowerCase()&&(d=h[b]);c||(c=f);h="set"+f.charAt(0).toUpperCase();1<f.length&&(h+=f.slice(1));f=e[h];f=f.bind(e);e=d?new window.vizit.lesson.MappingEventHandler(f,c,d,a):new window.vizit.lesson.DirectEventHandler(f,a);document.addEventListener(c+"Changed",e.handleUpdate.bind(e),!1)};this.bind=function(e,h,a){var c;if(h)if(Array.isArray(h)){c=
h.length;for(var d=0;d<c;++d)this.bindingBuilder(e,h[d],a)}else this.bindingBuilder(e,h,a)}};m.bindingBuilder=new m.BindingBuilder})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.CombinedVectorValuedFunctionBuilder=function(e){var h;this.buildFunction=function(a){var c,d,b;for(b in a)"args"===b.toLowerCase()?c=a[b]:"body"===b.toLowerCase()?d=a[b]:"name"===b.toLowerCase()?name=a[b]:"properties"!==b.toLowerCase()&&"stop"!==b.toLowerCase()&&b.toLowerCase();return new vizit.vectorfield.VectorFunction(c,d)};this.build=function(a){var c,d,b,f;if(a)if(d=new vizit.vectorfield.CombinedVectorFunctions,Array.isArray(a)){f=a.length;for(var e=0;e<f;++e)if(c=this.buildFunction(a[e]))d.addFunction(c),
(b=c.getName())&&h.setElementName(c,b)}else if(c=this.buildFunction(a))d.addFunction(c),(b=c.getName())&&h.setElementName(c,b);return d};h=e}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.SurfaceBuilder=function(){var e,h,a,c,d,b;this.getXMin=function(){return e};this.getXMax=function(){return h};this.getYMin=function(){return a};this.getYMax=function(){return c};this.getZMin=function(){return d};this.getZMax=function(){return b};this.gaussianCylinderBuilder=function(f){var k,g,l,q,p,m,n,r,w,u;k=!0;for(p in f)"x"===p.toLowerCase()?r=f[p]:"y"===p.toLowerCase()?w=f[p]:"z"===p.toLowerCase()?u=f[p]:"h"===p.toLowerCase()?g=f[p]:"r"===p.toLowerCase()?m=f[p]:"phi"===p.toLowerCase()?
q=f[p]:"theta"===p.toLowerCase()?n=f[p]:"name"===p.toLowerCase()?l=f[p]:"enabled"===p.toLowerCase()&&(k=f[p]);e=Math.min(e,r-m,r+m);h=Math.max(h,r-m,r+m);a=Math.min(a,w-m,w-m);c=Math.max(c,w-m,w+m);d=Math.min(d,u-g,u+g);b=Math.max(b,u-g,u+g);f=new vizit.electricfield.GaussianCylinder(r,w,u,g,m,q,n,l);k||f.setEnabled(k);return f};this.gaussianSphereBuilder=function(f){var k,g,l,q,m,s,n;k=!0;for(l in f)"x"===l.toLowerCase()?m=f[l]:"y"===l.toLowerCase()?s=f[l]:"z"===l.toLowerCase()?n=f[l]:"r"===l.toLowerCase()?
q=f[l]:"name"===l.toLowerCase()?g=f[l]:"enabled"===l.toLowerCase()&&(k=f[l]);e=Math.min(e,m-q,m+q);h=Math.max(h,m-q,m+q);a=Math.min(a,s-q,s-q);c=Math.max(c,s-q,s+q);d=Math.min(d,n-q,n+q);b=Math.max(b,n-q,n+q);f=new vizit.electricfield.GaussianSphere(m,s,n,q,g);k||f.setEnabled(k);return f};this.surfaceBuilder=function(a,b){var c,d,e,h,m;d=/\s*gaussian\s*sphere\s*/i;for(e in a)"type"===e.toLowerCase()?m=a[e]:"bind"===e.toLowerCase()&&(c=a[e]);m.match(/\s*gaussian\s*cylinder\s*/i)?h=this.gaussianCylinderBuilder(a):
m.match(d)&&(h=this.gaussianSphereBuilder(a));"undefined"!==typeof c&&"undefined"!==h&&this.bind(h,c,b);return h};this.build=function(a,b,c){var d,e;if(a)if(Array.isArray(a)){e=a.length;for(var h=0;h<e;++h)if(d=this.surfaceBuilder(a[h],c))b.addGaussianSurface(d),(name=d.getName())&&c.setElementName(d,name)}else if(d=this.surfaceBuilder(a,c))b.addGaussianSurface(d),(name=d.getName())&&c.setElementName(d,name);return b}};m.SurfaceBuilder.prototype=m.bindingBuilder})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};(function(m){m.VectorValuedFunctionBuilder=function(e){var h;this.build=function(a,c){var d,b;a&&(d=Array.isArray(a)?a[0]:a,"undefined"!==typeof d&&(b="function"===d.type.toLowerCase()?new vizit.builder.CombinedVectorValuedFunctionBuilder(h):new vizit.builder.ElectricFieldElementBuilder(h,c)));return b.build(a)};h=e}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.DistributionBuilder=function(){var e,h,a,c,d,b,f,k;this.getXMin=function(){return a};this.getXMax=function(){return c};this.getYMin=function(){return d};this.getYMax=function(){return b};this.getZMin=function(){return f};this.getZMax=function(){return k};this.chargedPlaneBuilder=function(g){var l,m,p,s,n,r,w,u,v,t,y,C,B,G,I,F,K;for(l in g)l.match(e)?m=g[l]:l.match(h)?p=g[l]:"nfieldLines"===l.toLowerCase()?n=g[l]:"x0"===l.toLowerCase()?r=g[l]:"y0"===l.toLowerCase()?w=g[l]:"z0"===l.toLowerCase()?
u=g[l]:"x1"===l.toLowerCase()?v=g[l]:"y1"===l.toLowerCase()?t=g[l]:"z1"===l.toLowerCase()?y=g[l]:"x2"===l.toLowerCase()?C=g[l]:"y2"===l.toLowerCase()?B=g[l]:"z2"===l.toLowerCase()?G=g[l]:"x3"===l.toLowerCase()?I=g[l]:"y3"===l.toLowerCase()?F=g[l]:"z3"===l.toLowerCase()?K=g[l]:"name"===l.toLowerCase()&&(s=g[l]);a=Math.min(a,r,v,C,I);c=Math.max(c,r,v,C,I);d=Math.min(d,w,t,B,K);b=Math.max(b,w,t,B,K);f=Math.min(f,u,y,G,K);k=Math.max(k,u,y,G,K);return new vizit.electricfield.ChargedPlane(r,w,u,v,t,y,C,
B,G,I,F,K,m,p,n,s)};this.chargedCylinderBuilder=function(g){var l,m,p,s,n,r,w,u,v,t,y,C,B;for(n in g)n.match(e)?l=g[n]:n.match(h)?m=g[n]:"nfieldLines"===n.toLowerCase()?s=g[n]:"x0"===n.toLowerCase()?r=g[n]:"y0"===n.toLowerCase()?w=g[n]:"z0"===n.toLowerCase()?u=g[n]:"x1"===n.toLowerCase()?v=g[n]:"y1"===n.toLowerCase()?t=g[n]:"z1"===n.toLowerCase()?y=g[n]:"r0"===n.toLowerCase()?C=g[n]:"r1"===n.toLowerCase()?B=g[n]:"name"===n.toLowerCase()&&(p=g[n]);a=Math.min(a,r,v);c=Math.max(c,r,v);d=Math.min(d,w,
t);b=Math.max(b,w,t);f=Math.min(f,u,y);k=Math.max(k,u,y);return new vizit.electricfield.ChargedCylinder(r,w,u,v,t,y,C,B,l,m,s,p)};this.chargedLineBuilder=function(g){var l,m,p,s,n,r,w,u,v,t,y;for(n in g)n.match(e)?l=g[n]:n.match(h)?m=g[n]:"nfieldLines"===n.toLowerCase()?s=g[n]:"x0"===n.toLowerCase()?r=g[n]:"y0"===n.toLowerCase()?w=g[n]:"z0"===n.toLowerCase()?u=g[n]:"x1"===n.toLowerCase()?v=g[n]:"y1"===n.toLowerCase()?t=g[n]:"z1"===n.toLowerCase()?y=g[n]:"name"===n.toLowerCase()&&(p=g[n]);a=Math.min(a,
r,v);c=Math.max(c,r,v);d=Math.min(d,w,t);b=Math.max(b,w,t);f=Math.min(f,u,y);k=Math.max(k,u,y);return new vizit.electricfield.ChargedLine(r,w,u,v,t,y,l,m,s,p)};this.chargedSphereBuilder=function(e){var l,m,p,s,n,r,w,u,v;for(property in e)"charge"===property.toLowerCase()?l=e[property]:property.match(h)?m=e[property]:"nfieldLines"===property.toLowerCase()?s=e[property]:"x"===property.toLowerCase()?n=e[property]:"y"===property.toLowerCase()?r=e[property]:"z"===property.toLowerCase()?w=e[property]:"a"===
property.toLowerCase()?u=e[property]:"b"===property.toLowerCase()?v=e[property]:"name"===property.toLowerCase()&&(p=e[property]);a=Math.min(a,n-v);c=Math.max(c,n+v);d=Math.min(d,r-v);b=Math.max(b,r+v);f=Math.min(f,w-v);k=Math.max(k,w+v);return new vizit.electricfield.ChargedSphere(n,r,w,u,v,l,m,s,p)};this.chargeDistributionBuilder=function(a,b){var c,d,f,e,h,k,m;d=/\s*charged\s*cylinder\s*/i;f=/\s*charged\s*line\s*/i;e=/\s*charged\s*sphere\s*/i;for(k in a)"type"===k.toLowerCase()?m=a[k]:"bind"===
k.toLowerCase()&&(c=a[k]);m.match(/\s*charged\s*plane\s*/i)?h=this.chargedPlaneBuilder(a):m.match(d)?h=this.chargedCylinderBuilder(a):m.match(f)?h=this.chargedLineBuilder(a):m.match(e)&&(h=this.chargedSphereBuilder(a));"undefined"!==typeof c&&"undefined"!==h&&this.bind(h,c,b);return h};this.build=function(a,b,c){var d,f,e;if(a)if(Array.isArray(a)){e=a.length;for(var h=0;h<e;++h)if(d=this.chargeDistributionBuilder(a[h],c))b.addDistribution(d),(f=d.getName())&&c.setElementName(d,f)}else if(d=this.chargeDistributionBuilder(a,
c))b.addDistribution(d),(f=d.getName())&&c.setElementName(d,f);return b};e=/\s*charge\s*density\s*/i;h=/\s*field\s*line\s*density\s*/i};m.DistributionBuilder.prototype=m.bindingBuilder})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.ChargesBuilder=function(){var e,h,a,c,d,b;this.getXMin=function(){return e};this.getXMax=function(){return h};this.getYMin=function(){return a};this.getYMax=function(){return c};this.getZMin=function(){return d};this.getZMax=function(){return b};this.chargeBuilder=function(f,k){var g,l,m,p,s,n,r,w,u,v,t,y;m="";w=/\s*field\s*line\s*density\s*/i;for(t in f)"charge"===t.toLowerCase()?y=f[t]:"x"===t.toLowerCase()?s=f[t]:"y"===t.toLowerCase()?n=f[t]:"z"===t.toLowerCase()?r=f[t]:t.match(w)?
u=f[t]:"nfieldlines"===t.toLowerCase()?v=f[t]:"bind"===t.toLowerCase()?g=f[t]:"name"===t.toLowerCase()&&(p=f[t]);"undefined"===typeof y&&(m="No charge specified for point charge.");"undefined"===typeof s&&(0<m.length&&(m+="\n"),m+="x coordinate is not defined in charge configuration.");"undefined"===typeof n&&(0<m.length&&(m+="\n"),m+="y coordinate is not defined in charge configuration.");"undefined"===typeof r&&(0<m.length&&(m+="\n"),m+="z coordinate is not defined in charge configuration.");0===
m.length&&(s<e&&(e=s),s>h&&(h=s),n<a&&(a=n),n>c&&(c=n),r<d&&(d=r),r>b&&(b=r),l=new vizit.electricfield.Charge(s,n,r,y,u,v,p),"undefined"!==typeof g&&this.bind(l,g,k));return l};this.build=function(a,b,c){var d,e,h;if(a)if(Array.isArray(a)){h=a.length;for(var m=0;m<h;++m)if(d=this.chargeBuilder(a[m],c))b.addCharge(d),(e=d.getName())&&c.setElementName(d,e)}else if(d=this.chargeBuilder(a,c))b.addCharge(d),(e=d.getName())&&c.setElementName(d,e);return b};e=Number.POSITIVE_INFINITY;h=Number.NEGATIVE_INFINITY;
a=Number.POSITIVE_INFINITY;c=Number.NEGATIVE_INFINITY;d=Number.POSITIVE_INFINITY;b=Number.NEGATIVE_INFINITY};m.ChargesBuilder.prototype=m.bindingBuilder})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.ElectricFieldElementBuilder=function(e,h){var a,c;this.buildELement=function(d,b){var e,h,g,l,m,p,s,n;e=/\s*charged\s*cylinder\s*/i;h=/\s*charged\s*line\s*/i;g=/\s*charged\s*plane\s*/i;l=/\s*charged\s*sphere\s*/i;m=/\s*gaussian\s*cylinder\s*/i;p=/\s*gaussian\s*sphere\s*/i;for(s in d)"type"===s.toLowerCase()&&(n=d[s]);if("charge"===n.toLowerCase())e=new vizit.builder.ChargesBuilder,b=e.build(d,b,a);else if(n.match(e)||n.match(h)||n.match(g)||n.match(l))e=new vizit.builder.DistributionBuilder,
b=e.build(d,b,a);else if(n.match(m)||n.match(p))e=new vizit.builder.SurfaceBuilder,c=e.build(d,c,a);return b};this.build=function(a){var b,c;b=new vizit.electricfield.Charges;if(a)if(Array.isArray(a)){c=a.length;for(var e=0;e<c;++e)this.buildELement(a[e],b)}else this.buildELement(a,b);return b};a=e;c=h}})(window.vizit.builder);window.vizit=window.vizit||{};(function(m){m.Visualizations=function(){this.register=function(e,h){};this.lookup=function(e){var h;(void 0).hasOwnProperty(e)&&(h=(void 0)[e]);return h}}})(window.vizit);vizit.visualizations=new vizit.Visualizations;window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.ElectricFieldBuilder=function(e){var h;this.build=function(a){var c,d,b,e,k,g;for(g in a)"arrowheadsize"===g.toLowerCase()?c=a[g]:"arrowspacing"===g.toLowerCase()?d=a[g]:"maxvectors"===g.toLowerCase()?k=a[g]:"elements"===g.toLowerCase()&&(e=a[g]);a=new vizit.electricfield.ElectricField;"undefined"!==typeof k&&a.setMaxVectors(k);"undefined"!==typeof c&&a.setArrowHeadSize(c);"undefined"!==typeof d&&a.setArrowSpacing(d);(b=(new vizit.builder.ElectricFieldElementBuilder(h,a)).build(e,b))&&
a.setCharges(b);return a};h=e}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.SimpleVectorFieldBuilder=function(e){var h;this.build=function(a){var c,d,b,e,k,g,l;for(l in a)"arrowheadsize"===l.toLowerCase()&&(c=a[l]),"arrowheadwidth"===l.toLowerCase()?d=a[l]:"arrowsize"===l.toLowerCase()?b=a[l]:"maxvectors"===l.toLowerCase()&&(e=a[l]),"f"===l.toLowerCase()&&(g=a[l]);g&&(a=new vizit.builder.VectorValuedFunctionBuilder(h),k=a.build(g));b=new vizit.vectorfield.SimpleVectorField(k,b);"undefined"!==typeof e&&b.setMaxVectors(e);"undefined"!==typeof c&&b.setArrowHeadSize(c);
"undefined"!==typeof d&&b.setArrowHeadWidth(d);return b};h=e}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.VizBuilder=function(){this.processConfig=function(e){var h,a,c,d,b,f,k,g,l,m;h=/\s*electric\s*field\s*/i;k=/\s*simple\s*vector\s*field\s*/i;l=/\s*start\s*points\s*/i;for(a in e)"canvas"===a.toLowerCase()?c=e[a]:"scale"===a.toLowerCase()?f=e[a]:"type"===a.toLowerCase()?m=e[a]:"name"===a.toLowerCase()?d=e[a]:a.match(l)&&(g=e[a]);"undefined"===typeof m?alert("Missing type for visualization configuration."):"undefined"===typeof c?alert("No canvas specified, please provide the id of a canvas."):
(a=document.getElementById(c))?(c=new vizit.field.FieldRenderer(a),m.match(h)?(h=new vizit.builder.ElectricFieldBuilder(c),b=h.build(e)):m.match(k)?(h=new vizit.builder.SimpleVectorFieldBuilder(c),b=h.build(e)):alert("Unrecognized visualization type: "+m+"."),b&&(c.setRenderer(b),"undefined"!==typeof f&&c.setScale(f),"undefined"!==typeof d&&vizit.visualizations.register(d,c),"undefined"!==typeof g&&b.addStartPoints(g),c.start())):alert('Can not find canvas with id="'+c+'".')};this.process=function(e){var h;
if(e)if(Array.isArray(e)){h=e.length;for(var a=0;a<h;++a)this.processConfig(e[a])}else this.processConfig(e)}}})(window.vizit.builder);function VIZ_CONFIG_IF_EXISTS(m){"undefined"!==typeof VISUALIZATION_CONFIG&&(m=new vizit.builder.VizBuilder,m.process(VISUALIZATION_CONFIG))}"interactive"===document.readyState||"complete"===document.readyState?VIZ_CONFIG_IF_EXISTS():document.addEventListener("DOMContentLoaded",VIZ_CONFIG_IF_EXISTS);
