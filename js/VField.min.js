/*
 Copyright 2013-2014 Vizit Solutions

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
*/
window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(m){m.ensureNumber=function(e){return"number"===typeof e?e:parseFloat(e)}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(m){m.toBoolean=function(e){var h,a;a=typeof e;if("boolean"===a)h=e;else if("number"===a)h=0!==e;else if("string"===a)switch(e.trim().toLowerCase()){case "f":case "false":case "n":case "no":case "0":case "":h=!1;break;default:h=!0}return h}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(m){m.MotionEventHandler=function(e,h,a,c){var d,b,f,l;d=[];b=!1;l=f=null;this.findTouchByIdentifier=function(a){var b,c;for(b=0;b<d.length;b++)if(c=d[b].identifier,c===a)return b;return-1};this.handleTouchStart=function(a){var b,c,f;f=a.targetTouches;for(b=0;b<f.length;b++)c=f[b],-1===this.findTouchByIdentifier(c.identifier)&&d.push(c);if(a.preventDefault)a.preventDefault();else return!1};this.handleTouchEnd=function(a){var b,c,f;f=a.changedTouches;for(b=0;b<f.length;b++)c=this.findTouchByIdentifier(f[b].identifier),
-1!==c&&d.splice(c,1);if(a.preventDefault)a.preventDefault();else return!1};this.handleOneActiveMove=function(a){var b,c,f,l;l=a.changedTouches[0];c=d[0];null!==c?(b=l.pageX-c.pageX,c=l.pageY-c.pageY,f=e.getModelViewMatrix(),h.rotateBy(f,c/150,b/150),e.setModelViewMatrix(f),e.requestRender(),d.splice(0,1,l)):d.push(l);if(a.preventDefault)a.preventDefault();else return!1};this.handleTwoActiveMove=function(a){var b,f,l,h,n,r,w;h=d[0];r=d[1];b=r.pageX-h.pageX;f=r.pageY-h.pageY;l=Math.sqrt(b*b+f*f);w=
a.changedTouches;for(b=0;b<w.length;b++)n=w[b],f=n.identifier,h.identifier===f?(h=n,d.splice(0,1,n)):r.identifier===f&&(r=n,d.splice(1,1,n));b=r.pageX-h.pageX;f=r.pageY-h.pageY;h=Math.sqrt(b*b+f*f);e.zoomBy(-(h-l)/c);if(a.preventDefault)a.preventDefault();else return!1};this.handleTouchMove=function(a){return 1===d.length?this.handleOneActiveMove(a):2===d.length?this.handleTwoActiveMove(a):!0};this.handleMouseDown=function(a){b=!0;f=a.clientX;l=a.clientY};this.handleMouseUp=function(a){b=!1};this.handleMouseMove=
function(a){if(b){var c=a.clientX,d=a.clientY,s=c-f,p=d-l;a=e.getModelViewMatrix();h.rotateBy(a,p/30,s/30);e.setModelViewMatrix(a);e.requestRender();f=c;l=d}};this.handleMouseWheel=function(b){b=window.event||b;e.zoomBy(b.wheelDeltaY/a);if(b.preventDefault)b.preventDefault();else return!1}}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(m){m.GLUtility=function(e){var h,a;this.getGLContext=function(){!a&&(a=h.getContext("webgl",{antialias:!0})||h.getContext("experimental-webgl",{antialias:!0}))&&(a.enable(a.DEPTH_TEST),a.depthFunc(a.LESS));return a};this.clearColor=function(c,d,b,f){a.clearColor(c,d,b,f)};this.clear=function(){a.clear(a.COLOR_BUFFER_BIT)};this.compileShader=function(c,d){var b=a.createShader(d);a.shaderSource(b,c);a.compileShader(b);if(!a.getShaderParameter(b,a.COMPILE_STATUS))throw"Shader compile failed with:"+
a.getShaderInfoLog(b);return b};this.createProgram=function(c,d){var b,f,l;f=a.createProgram();l=this.compileShader(c,a.VERTEX_SHADER);b=this.compileShader(d,a.FRAGMENT_SHADER);a.attachShader(f,l);a.attachShader(f,b);a.linkProgram(f);return f};this.loadData=function(c,d){a.bindBuffer(a.ARRAY_BUFFER,c);a.bufferData(a.ARRAY_BUFFER,d,a.STATIC_DRAW)};this.createBuffer=function(c){var d=a.createBuffer();this.loadData(d,c);return d};this.createIndexBuffer=function(c){var d=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,
d);a.bufferData(a.ELEMENT_ARRAY_BUFFER,c,a.STATIC_DRAW);return d};this.getAttribLocation=function(c,d){var b;b=a.getAttribLocation(c,d);-1===b&&alert("Can not find uniform"+attribute+".");return b};this.bindBuffer=function(c,d,b,f,l,g){a.bindBuffer(a.ARRAY_BUFFER,c);a.enableVertexAttribArray(d);a.vertexAttribPointer(d,b,f,!1,l,g)};this.loadTexture=function(c,d,b){var f=a.createTexture(),l=new Image;l.onload=function(){this.onTextureLoaded(l,f,d,b)}.bind(this);l.src=c;return f};this.onTextureLoaded=
function(c,d,b,f){a.activeTexture(a.TEXTURE0+b);a.bindTexture(a.TEXTURE_2D,d);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,c);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST);a.generateMipmap(a.TEXTURE_2D);f()};this.bindTexture=function(c,d,b,f){a.activeTexture(a.TEXTURE0+b);a.bindTexture(a.TEXTURE_2D,d);a.uniform1i(f,b)};this.generateModelViewMatrix=function(a){return new Float32Array([1,0,0,0,0,1,
0,0,0,0,1,0,a,0,0,1])};this.generatePerspectiveMatrix=function(a,d,b,f){return new Float32Array([b/a,0,0,0,0,b/d,0,0,0,0,-(f+b)/(f-b),-1,0,0,-2*f*b/(f-b),0])};this.generateOrthographicMatrix=function(a,d,b,f){return new Float32Array([1/a,0,0,0,0,1/d,0,0,0,0,-2/(f-b),0,0,0,-(f+b)/(f-b),1])};this.getUniformLocation=function(c,d){var b;b=a.getUniformLocation(c,d);-1===b&&alert("Can not find uniform"+d+".");return b};this.loadUniform3f=function(a,d,b,f,l,g){d=a.getUniformLocation(d,b);-1===d?alert("Can not find uniform"+
b+"."):a.uniform3f(d,f,l,g)};this.loadUniform4f=function(c,d,b,f,l,g){c=a.getUniformLocation(c,d);-1===c?alert("Can not find uniform"+d+"."):a.uniform4f(c,b,f,l,g)};this.loadUniformMatrix3fv=function(c,d,b){c=a.getUniformLocation(c,d);-1===c?alert("Can not find uniform"+d+"."):a.uniformMatrix3fv(c,!1,b)};this.loadUniformMatrix4fv=function(c,d,b){c=a.getUniformLocation(c,d);-1===c?alert("Can not find uniform"+d+"."):a.uniformMatrix4fv(c,!1,b)};this.getXYRotationMatrix=function(a,d){Math.cos(a);Math.cos(d);
Math.sin(a);Math.sin(d)};this.rotateBy=function(a,d,b){var f,l,g=Math.cos(d),k=Math.cos(b);d=Math.sin(d);var e=Math.sin(b),h=d*e,p=k*d,n=g*e,r=g*k;b=a[0];f=a[1];l=a[2];a[0]=b*k+l*e;a[1]=b*h+f*g-l*p;a[2]=-b*n+f*d+l*r;b=a[4];f=a[5];l=a[6];a[4]=b*k+l*e;a[5]=b*h+f*g-l*p;a[6]=-b*n+f*d+l*r;b=a[8];f=a[9];l=a[10];a[8]=b*k+l*e;a[9]=b*h+f*g-l*p;a[10]=-b*n+f*d+l*r;b=a[12];f=a[13];l=a[14];a[12]=b*k+l*e;a[13]=b*h+f*g-l*p;a[14]=-b*n+f*d+l*r};this.extractRotationPart=function(a,d){d.set(a.subarray(0,3));d.set(a.subarray(4,
7),3);d.set(a.subarray(8,11),6);return d};h=e;a=this.getGLContext()}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(m){m.Color=function(e,h,a,c){var d,b,f,l;this.setRed=function(a){d=a;return this};this.getRed=function(){return d};this.setGreen=function(a){b=a;return this};this.getGreen=function(){return b};this.setBlue=function(a){f=a;return this};this.getBlue=function(){return f};this.setAlpha=function(a){l=a;return this};this.getAlpha=function(){return l};this.setRed(e).setGreen(h).setBlue(a).setAlpha(c)}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.geometry=window.vizit.geometry||{};
(function(m){m.Surface=function(e,h){var a,c,d,b,f;c=h;b=e;f=new Float32Array(3*e);a=new Uint16Array(h);d=new Float32Array(3*e);this.setNindices=function(a){c=a};this.getNindices=function(){return c};this.setNvertices=function(a){b=a};this.getNvertices=function(){return b};this.setVerticies=function(a){f=a};this.getVertices=function(){return f};this.setIndices=function(b){a=b};this.getIndices=function(){return a};this.setNormals=function(a){d=a};this.getNormals=function(){return d}};m.Shapes={SPHERE:{value:"sphere"},
SQUARE:{value:"square"},CYLINDER:{value:"cylinder"}};m.VertexRegistry=function(){var e;e={};this.registerVertices=function(h,a){if(e.hasOwnProperty(h))throw"Vertex buffers already registered for "+h+".";e[h]=a};this.hasVertices=function(h){return e.hasOwnProperty(h)};this.retrieveVertices=function(h){return e[h]}};m.vertexRegistry=new m.VertexRegistry;m.Square=function(){var e,h,a;a=m.Shapes.SQUARE;e=[-0.5,0.5,0,0.5,0.5,0,0.5,-0.5,0,-0.5,-0.5,0];h=[0,0,1];this.getNindices=function(){return 6};this.computeGeometry=
function(a,d){var b,f,l;l=a.getVertices();f=a.getNormals();b=a.getIndices();for(var g=0;12>g;g++)l[g]=d[g],f[g]=h[g%3];b[0]=0;b[1]=3;b[2]=1;b[3]=3;b[4]=2;b[5]=1;a.setNvertices(12);a.setNindices(6)};this.getVertexBuffers=function(c){var d,b;this.hasVertices(a.value)?b=this.retrieveVertices(a.value):(d=new m.Surface(4,6),b={},this.computeGeometry(d,e),b.vertices=c.createBuffer(d.getVertices()),b.normals=c.createBuffer(d.getNormals()),b.indices=c.createIndexBuffer(d.getIndices()),this.registerVertices(a.value,
b));return b}};m.Square.prototype=m.vertexRegistry;m.Cylinder=function(){var e;e=m.Shapes.CYLINDER;this.getBaseHeight=function(){return 1};this.getBaseRadius=function(){return 1};this.getShape=function(){return e};this.getNindices=function(){return 126};this.computeGeometry=function(e){var a,c,d,b,f,l,g;g=e.getVertices();b=e.getNormals();d=e.getIndices();g[0]=0;b[0]=0;g[1]=0;b[1]=0;g[2]=0.5;b[2]=1;d[0]=0;a=94;d[a]=a;a*=3;g[a]=0;b[a++]=0;g[a]=0;b[a++]=0;g[a]=-0.5;b[a]=-1;for(c=1;31>=c;c++)a=2*(c-1)*
Math.PI/30,d[c]=c,l=3*c,g[l]=1*Math.cos(a),b[l++]=0,g[l]=1*Math.sin(a),b[l++]=0,g[l]=0.5,b[l]=1;for(c=1;31>=c;c++)l=3*c,a=c+90+4,d[a]=a,a*=3,g[a]=g[l++],b[a++]=0,g[a]=g[l],b[a++]=0,g[a]=-0.5,b[a]=-1;l=3;a=285;f=96;for(c=0;30>=c;c++)d[f/3]=f/3,g[f]=g[l],b[f++]=g[l++]/1,g[f]=g[l],b[f++]=g[l++]/1,g[f]=g[l],b[f++]=g[l++]/1,d[f/3]=f/3,g[f]=g[a],b[f++]=g[a++]/1,g[f]=g[a],b[f++]=g[a++]/1,g[f]=g[a],b[f++]=g[a++]/1;e.setNvertices(378);e.setNindices(126)};this.getVertexBuffers=function(h){var a,c;this.hasVertices(e.value)?
c=this.retrieveVertices(e.value):(a=new m.Surface(126,126),c={},this.computeGeometry(a),c.vertices=h.createBuffer(a.getVertices()),c.normals=h.createBuffer(a.getNormals()),c.indices=h.createIndexBuffer(a.getIndices()),this.registerVertices(e.value,c));return c}};m.Cylinder.prototype=m.vertexRegistry;m.Sphere=function(){var e;e=m.Shapes.SPHERE;this.getIntrinsicRadius=function(){return 30};this.getShape=function(){return e};this.getNindices=function(){return 5400};this.computeGeometry=function(e,a,
c,d){var b,f,l,g,k,q,s,p,n,r,w;r=e.getVertices();s=q=0;l=e.getNormals();for(g=0;g<=c;g++)for(k=g*Math.PI/c,n=Math.sin(k),f=Math.cos(k),k=0;k<=d;k++)b=2*k*Math.PI/d,p=Math.sin(b),b=Math.cos(b),p*=n,w=f,b*=n,l[s]=p,r[s++]=a*p,l[s]=w,r[s++]=a*w,l[s]=b,r[s++]=a*b;e.setNvertices(--s);l=e.getIndices();for(g=0;g<c;g++)for(k=0;k<d;k++)a=g*(d+1)+k,s=a+d+1,l[q++]=a,l[q++]=s,l[q++]=a+1,l[q++]=s,l[q++]=s+1,l[q++]=a+1;e.setNindices(--q)};this.getVertexBuffers=function(h){var a,c;this.hasVertices(e.value)?c=this.retrieveVertices(e.value):
(a=new m.Surface(961,5400),c={},this.computeGeometry(a,30,30,30),c.vertices=h.createBuffer(a.getVertices()),c.normals=h.createBuffer(a.getNormals()),c.indices=h.createIndexBuffer(a.getIndices()),this.registerVertices(e.value,c));return c}};m.Sphere.prototype=m.vertexRegistry})(window.vizit.geometry);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.SurfaceRenderer=function(e){var h,a,c,d,b,f,l,g,k,q,s,p,n;this.createProgram=function(d){d=f.createProgram("attribute vec3 normal;attribute vec3 position;uniform   vec3 ambientLighting;uniform   vec3 directionalLighting;uniform   vec3 directionalColor;uniform   mat4 modelViewMatrix;uniform   mat4 globalModelViewMatrix;uniform   mat3 normalMatrix;uniform   mat4 projectionMatrix;varying   vec3 lighting;void main(void){  gl_Position = projectionMatrix * globalModelViewMatrix * modelViewMatrix * vec4(position, 1.0);  vec3  transformedNormal         = normalMatrix * normal;  float directionalLightWeighting = max(dot(transformedNormal, directionalLighting), 0.0);  lighting                        = ambientLighting + directionalColor * directionalLightWeighting;}","precision mediump float;uniform vec4 surfaceColor;varying vec3 lighting;void main(void){  gl_FragColor = vec4(surfaceColor.rgb * lighting, surfaceColor.a);}");
h=f.getUniformLocation(d,"ambientLighting");a=f.getUniformLocation(d,"directionalLighting");c=f.getUniformLocation(d,"directionalColor");l=f.getUniformLocation(d,"modelViewMatrix");b=f.getUniformLocation(d,"globalModelViewMatrix");g=f.getAttribLocation(d,"normal");k=f.getUniformLocation(d,"normalMatrix");q=f.getAttribLocation(d,"position");p=f.getUniformLocation(d,"projectionMatrix");n=f.getUniformLocation(d,"surfaceColor");return d};this.getAmbientLightingHandle=function(){return h};this.getDirectionalLightingHandle=
function(){return a};this.getDirectionalColorHandle=function(){return c};this.getModelViewMatrixHandle=function(){return l};this.getGlobalModelViewMatrixHandle=function(){return b};this.getNormalHandle=function(){return g};this.getNormalMatrixHandle=function(){return k};this.getPositionHandle=function(){return q};this.getProjectionMatrixHandle=function(){return p};this.getSurfaceColorHandle=function(){return n};this.render=function(g,l,e,n){var q;q=n.length;if(0<q)for(d.useProgram(s),d.uniformMatrix4fv(b,
!1,l),d.uniformMatrix3fv(k,!1,e),d.uniformMatrix4fv(p,!1,g),d.uniform3f(h,0.3,0.3,0.3),d.uniform3f(a,1,1,1),d.uniform3f(c,0.4,0.4,0.4),g=0;g<q;g++)n[g].render(f,this)};f=e;d=f.getGLContext();s=this.createProgram()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(m){m.IndexedVertices=function(e,h){var a,c,d,b;this.setNindices=function(a){c=a};this.getNindices=function(){return c};this.setNvertices=function(a){d=a};this.getNvertices=function(){return d};this.setVerticies=function(a){b=a};this.getVertices=function(){return b};this.setVerticies=function(a){b=a};this.getVertices=function(){return b};this.pushVertex=function(a){b[d++]=a};this.setIndices=function(b){a=b};this.getIndices=function(){return a};this.pushIndex=function(b){a[c++]=b};d=c=0;b=
new Float32Array(3*e);a=new Uint16Array(h)}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};(function(m){m.VectorFunction=function(e,h){var a,c;this.setModified=function(d){a=d};this.isModified=function(){return a};this.setName=function(a){c=a};this.getName=function(){return c};this.shouldStop=function(a,b,c,l){return 0>a*Q&&4>r2};this.getField=new Function(e,h);a=!0}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(m){m.CombinedVectorFunctions=function(){var e,h,a;this.addFunction=function(a){h=e.push(a);return this};for(var c=0;c<arguments.length;c++)this.addFunction(arguments[c]);this.getNfunctions=function(){return h};this.getFunctions=function(){return e};this.isModified=function(){var a;a=!1;for(c=0;c<h&&!a;c++)a=a||e[c].isModified();return a};this.setModified=function(a){for(c=0;c<h;c++)e[c].setModified(a)};this.setStartPoints=function(d){a=d};this.getStartPoints=function(){return a};this.getField=
function(a,b,c){for(var l,g=[0,0,0],k=0;k<h;k++)l=e[k].getField(a,b,c),g[0]+=l[0],g[1]+=l[1],g[2]+=l[2];return g};this.shouldStop=function(a,b,c,l){for(a=0;a<h&1;a++);return!1};h=0;e=[]}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(m){m.LineRenderer=function(e){var h,a,c,d,b,f,l;this.createProgram=function(){var a;a=c.createProgram("attribute vec3 position;uniform   mat4 modelViewMatrix;uniform   mat4 projectionMatrix;void main(){    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1);}","precision mediump float;uniform   vec4 color;void main(){    gl_FragColor = color;}");h=c.getUniformLocation(a,"color");d=c.getAttribLocation(a,"position");f=c.getUniformLocation(a,"modelViewMatrix");l=c.getUniformLocation(a,
"projectionMatrix");return a};this.drawIndexedLines=function(g,k,e,s){a.useProgram(b);a.lineWidth(1);a.uniform4fv(h,e);a.uniformMatrix4fv(f,!1,k);a.uniformMatrix4fv(l,!1,g);k=s.length;for(e=0;e<k;e++)g=s[e],c.bindBuffer(g.vertices,d,3,a.FLOAT,12,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,g.indices),a.drawElements(a.LINES,g.nindices,a.UNSIGNED_SHORT,0)};c=e;a=c.getGLContext();b=this.createProgram()}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(m){m.SimpleVectorField=function(e,h){var a,c,d,b,f,l,g,k,q,s,p,n,r,w;this.setArrowHeadWidth=function(a){c=a;return this};this.getArrowHeadWidth=function(){return c};this.setArrowHeadSize=function(b){a=b;return this};this.getArrowHeadSize=function(){return a};this.setColor=function(a){d=a;return this};this.getColor=function(){return d};this.setGlUtility=function(a){g=a;return this};this.getGlUtility=function(){return g};this.setMaxVectors=function(a){q=a;return this};this.getMaxVectors=function(){return q};
this.setModelViewMatrix=function(a){s=a;return this};this.getModelViewMatrix=function(){return s};this.setProjectionMatrix=function(a){n=a;return this};this.addStartPoints=function(a){b=b.concat(a);return this};this.getStartPoints=function(){return b};this.setupVectorField=function(){var a,d;"function"===typeof f.getStartPoints?(a=f.getStartPoints(0,2),a="undefined"!==typeof a?b.concat(a):b):a=b;l.setStartPoints(a);a={};d=l.generateField();a.vertices=g.createBuffer(d.getVertices());a.indices=g.createIndexBuffer(d.getIndices());
a.nindices=d.getNindices();k[0]=a;return k};this.render=function(){w&&(f.isModified()&&(k=this.setupVectorField()),g.clear(),p.drawIndexedLines(n,s,d,k),f.setModified(!1))};this.start=function(){p=new vizit.vectorfield.LineRenderer(g);l=new vizit.vectorfield.VectorFieldGenerator(f,q,a,c,r);w=!0;this.render()};c=0.5;a=0.3;f=e;k=[];d=new Float32Array([0.8,0.3,0.3,1]);q=5;r="undefined"===typeof h?1:h;b=[];w=!1}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(m){m.CountdownLatch=function(e,h){var a=e;this.countDown=function(){a--;0>=a&&h()}}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargeGenerator=function(e){var h,a,c,d,b,f,l,g;this.setCharges=function(b){a=b;h*a.getCharges().length>c.byteLength&&(c=new ArrayBuffer(h*a.getCharges().length))};this.getCharges=function(){return a};this.getChargesArray=function(){return c};this.getNcharges=function(){return d};this.generate=function(){var k,e,h,p,n,r;r=a.getCharges();d=r.length;n=new Float32Array(c);e=new Uint8Array(c);for(var w=0;w<d;w++)k=r[w],p=k.getPosition(),h=0+5*w,n[h++]=p[0],n[h++]=p[1],n[h++]=p[2],n[h++]=
l,h=16+20*w,k=0<k.getCharge()?g:0>k.getCharge()?b:f,e[h++]=k[0],e[h++]=k[1],e[h++]=k[2],e[h++]=k[3];return c};a=e;h=3*Float32Array.BYTES_PER_ELEMENT+Float32Array.BYTES_PER_ELEMENT+4*Uint8Array.BYTES_PER_ELEMENT;c=new ArrayBuffer(h*a.getCharges().length);l=16;b=[204,13,13,255];g=[13,13,204,255];f=[13,13,13,51]}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargeRenderer=function(e){var h,a,c,d,b,f,l,g;this.createProgram=function(){var f;f=c.createProgram("precision highp float;attribute vec3  position;attribute vec4  color;attribute float size;uniform   mat4  modelViewMatrix;uniform   mat4  projectionMatrix;varying vec4 vColor;void main(){    gl_Position  = projectionMatrix * modelViewMatrix * vec4(position, 1);    gl_PointSize = size;    vColor       = color;}","precision lowp float;varying vec4 vColor; void main() {   float dist = distance( vec2(0.5,0.5), gl_PointCoord );   if ( dist > 0.5 )     discard;   gl_FragColor = vColor; }");
h=c.getAttribLocation(f,"color");d=c.getUniformLocation(f,"modelViewMatrix");b=c.getAttribLocation(f,"position");l=c.getUniformLocation(f,"projectionMatrix");g=c.getAttribLocation(f,"size");a.enableVertexAttribArray(h);a.enableVertexAttribArray(b);a.enableVertexAttribArray(g);return f};this.render=function(c,e,s,p){a.useProgram(f);a.uniformMatrix4fv(d,!1,e);a.uniformMatrix4fv(l,!1,c);a.bindBuffer(a.ARRAY_BUFFER,s);a.vertexAttribPointer(b,3,a.FLOAT,!1,20,0);a.vertexAttribPointer(g,1,a.FLOAT,!1,20,
12);a.vertexAttribPointer(h,4,a.UNSIGNED_BYTE,!0,20,16);a.drawArrays(a.POINTS,0,p.getNcharges())};c=e;a=c.getGLContext();f=this.createProgram()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.FieldLineVBO=function(e,h){this.disable=function(){this.enabled=!1};this.isEnabled=function(){return this.enabled};this.reload=function(a,c){a.loadData(this.fieldLineBufferHandle,c.getPoints());this.npoints=c.getNpoints();a.loadData(this.fieldDirectionBufferHandle,c.getArrows());this.narrows=c.getNarrows();this.enabled=!0};this.fieldLineBufferHandle=e.createBuffer(h.getPoints());this.npoints=h.getNpoints();this.fieldDirectionBufferHandle=e.createBuffer(h.getArrows());this.narrows=h.getNarrows();
this.enabled=!0}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.FieldLine=function(e){var h,a,c,d,b,f;this.setMaxPoints=function(d){d!==e&&(e=d,b=new Float32Array(3*e),a=new Float32Array(e));return this};this.getMaxPoints=function(){return e};this.pushPoint=function(a,c,k){b[f++]=a;b[f++]=c;b[f++]=k;d++};this.getPoints=function(){return b};this.getNpoints=function(){return d};this.pushArrow=function(b,d,f,e,s,p,n,r,w){a[h++]=b;a[h++]=d;a[h++]=f;a[h++]=e;a[h++]=s;a[h++]=p;a[h++]=e;a[h++]=s;a[h++]=p;a[h++]=n;a[h++]=r;a[h++]=w;c++};this.getArrows=
function(){return a};this.getNarrows=function(){return c};this.reset=function(){f=d=c=h=0};b=new Float32Array(3*e);a=new Float32Array(e);this.reset()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.FieldLineGenerator=function(e,h,a,c,d){var b,f,l,g,k,q;this.setCharges=function(a){g=a;return this};this.getCharges=function(){return g};this.getArrows=function(){return arrows};this.setMaxPoints=function(a){a>maxpoints&&(k=new vizit.electricfield.FieldLine(q));q=a;return this};this.getMaxPoints=function(){return q};this.setArrowHeadSize=function(a){b=a;return this};this.getArrowHeadSize=function(){return b};this.setArrowSpacing=function(a){f=a;return this};this.getArrowSpacing=function(){return f};
this.setDs=function(a){l=a;return this};this.getDs=function(){return l};this.drawArrow=function(a,b,d,c,f,g,l){var k,e,h,q,m;k=c[0]/f;e=c[1]/f;h=c[2]/f;0!==h?(q=f=1,c=-(c[0]+c[1])/c[2]):(0!==e?(f=1,q=-(c[0]+c[2])/c[1]):(f=-(c[1]+c[2])/c[0],q=1),c=1);m=g/Math.sqrt(f*f+q*q+c*c);f*=m;q*=m;c*=m;k*=g;e*=g;g*=h;l.pushArrow(a-k+f,b-e+q,d-g+c,a,b,d,a-k-f,b-e-q,d-g-c)};this.generate=function(a,d,c,e){var h,u,m,t;h=0;u=!1;t=c;k.reset();for(c=0;c<q&&!u;c++){k.pushPoint(a,d,t);m=g.getField(a,d,t);u=Math.sqrt(m[0]*
m[0]+m[1]*m[1]+m[2]*m[2]);if(0===u)break;a+=e*m[0]/u*l;d+=e*m[1]/u*l;t+=e*m[2]/u*l;h+=l;h>f&&(h=0,this.drawArrow(a,d,t,m,u,b,k));u=g.shouldStop(e,a,d,t)}return k};b=c;f=d;g=e;l=a;q=h;k=new vizit.electricfield.FieldLine(q)}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.FieldLineRenderer=function(e){var h,a,c,d,b,f;this.createProgram=function(b){b=a.createProgram("attribute vec3 position;uniform   mat4 modelViewMatrix;uniform   mat4 projectionMatrix;void main(){  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}","precision mediump float;void main(){  gl_FragColor = vec4(0.8,0.3,0.3,1.0);}");c=a.getUniformLocation(b,"modelViewMatrix");d=a.getAttribLocation(b,"position");f=a.getUniformLocation(b,"projectionMatrix");return b};
this.render=function(l,g,k,e){k=e.length;if(0<k)for(h.useProgram(b),h.lineWidth(1),h.uniformMatrix4fv(c,!1,g),h.uniformMatrix4fv(f,!1,l),g=0;g<k;g++){l=e[g];if(!l.isEnabled())break;a.bindBuffer(l.fieldLineBufferHandle,d,3,h.FLOAT,12,0);h.drawArrays(h.LINE_STRIP,0,l.npoints);a.bindBuffer(l.fieldDirectionBufferHandle,d,3,h.FLOAT,12,0);h.drawArrays(h.LINES,0,l.narrows)}};a=e;h=a.getGLContext();b=this.createProgram()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(m){m.Cylinder=function(){var e,h;this.setColor=function(a){h=a};this.getColor=function(){return h};this.getCylinderModelView=function(a,c,d,b,f,e,g){var k,h,s;s=Math.sin(g);g=Math.cos(g);h=Math.sin(e);e=Math.cos(e);k=new Float32Array(16);k[0]=f*e*g;k[1]=f*g*h;k[2]=-f*s;k[3]=0;k[4]=-f*h;k[5]=f*e;k[6]=0;k[7]=0;k[8]=b*e*s;k[9]=b*h*s;k[10]=b*g;k[11]=0;k[12]=a;k[13]=c;k[14]=d;k[15]=1;return k};this.transformPoints=function(a,c,d,b){var f,l,g;e[0]=a[0]*d;e[1]=a[1]*d;e[2]=a[2]*d;e[3]=a[3];e[4]=
a[4]*d;e[5]=a[5]*d;e[6]=a[6]*d;e[7]=a[7];e[8]=a[8]*c;e[9]=a[9]*c;e[10]=a[10]*c;e[11]=a[11];e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];c=0;for(a=b.length;c<a;c++)d=b[c],f=d[0],l=d[1],g=d[2],d[0]=e[0]*f+e[4]*l+e[8]*g+e[12],d[1]=e[1]*f+e[5]*l+e[9]*g+e[13],d[2]=e[2]*f+e[6]*l+e[10]*g+e[14];return b};this.setupBuffers=function(a,c,d,b,f){var e;e=a.getGLContext();a.bindBuffer(d,c.getPositionHandle(),3,e.FLOAT,0,0);a.bindBuffer(b,c.getNormalHandle(),3,e.FLOAT,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,
f)};this.drawCap=function(a,c,d){a.drawElements(a.TRIANGLE_FAN,c,a.UNSIGNED_SHORT,2*d)};this.drawSide=function(a,c,d){a.drawElements(a.TRIANGLE_STRIP,c,a.UNSIGNED_SHORT,2*d)};this.drawCylinder=function(a,c,d,b,f){a=a.getGLContext();a.uniformMatrix4fv(c.getModelViewMatrixHandle(),!1,d);f&&this.drawCap(a,b+2,0);this.drawSide(a,2*b+2,b+2);f&&this.drawCap(a,b+2,3*b+4)};this.fullRender=function(a,c,d,b,f,l,g){var k,q,s,p;k=a.getGLContext();s=this.getBaseRadius();p=this.getVertexBuffers(a);k.uniform4f(c.getSurfaceColorHandle(),
h.getRed(),h.getGreen(),h.getBlue(),h.getAlpha());q=(this.getNindices()-6)/4;this.setupBuffers(a,c,p.vertices,p.normals,p.indices);e[3]=d[3];e[7]=d[7];e[8]=d[8]*b;e[9]=d[9]*b;e[10]=d[10]*b;e[11]=d[11];e[12]=d[12];e[13]=d[13];e[14]=d[14];e[15]=d[15];k.cullFace(k.FRONT);for(b=l;b>=f;b--)p=b/s,e[0]=d[0]*p,e[1]=d[1]*p,e[2]=d[2]*p,e[4]=d[4]*p,e[5]=d[5]*p,e[6]=d[6]*p,this.drawCylinder(a,c,e,q,g);k.cullFace(k.BACK);for(b=f;b<=l;b++)p=b/s,e[0]=d[0]*p,e[1]=d[1]*p,e[2]=d[2]*p,e[4]=d[4]*p,e[5]=d[5]*p,e[6]=d[6]*
p,this.drawCylinder(a,c,e,q,g)};this.translateBounds=function(a,c,d,b,f,e,g){var k,h,s;k=(c+f)/2;h=(d+e)/2;s=(b+g)/2;c-=k;d-=h;b-=s;f-=k;e-=h;g-=s;a.setTx(k).setTy(h).setTz(s).setX0(c).setY0(d).setZ0(b).setX1(f).setY1(e).setZ1(g)};this.sign=function(a){return 0>a?-1:1};this.zAxisRotation=function(a,c,d,b,f){var e;e=Math.atan2(f-d,b-c);c=-this.sign(b)*Math.sqrt(c*c+d*d);d=0;b=-c;f=0;a.setX0(c).setY0(d).setX1(b).setY1(f).setPhi(e)};this.yAxisRotation=function(a,c,d,b,f,e,g){d=Math.sqrt(c*c+d*d+b*b);
e=Math.acos(g/d);b=this.sign(g);g=b*d;f=c=0;a.setZ0(-b*d).setZ1(g).setX0(c).setX1(f).setTheta(e)};this.scale=function(a,c,d){var b;b=this.sign(d);c=d-c;a.setZ0(0.5*-b).setZ1(0.5*b).setHeight(c)};e=new Float32Array(16)};m.Cylinder.prototype=new vizit.geometry.Cylinder})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.GaussianCylinder=function(e,h,a,c,d,b,f,l){var g,k,q,s,p,n,r,m,u,v,t;this.setEnabled=function(a){k=vizit.utility.toBoolean(a)};this.isEnabled=function(){return k};this.setX=function(a){u=a;s[12]=u;return this};this.getX=function(){return u};this.setY=function(a){v=a;s[13]=v;return this};this.getY=function(){return v};this.setZ=function(a){t=a;s[14]=t;return this};this.getZ=function(){return t};this.setOrigin=function(a){this.setX(a[0]);this.setY(a[1]);return this.setZ(a[2])};this.getOrigin=
function(){return[u,v,t]};this.setR=function(a){r=a;return this};this.getR=function(){return r};this.setHeight=function(a){q=a;return this};this.getHeight=function(){return q};this.setTheta=function(a){m=a;return this};this.getTheta=function(){return m};this.setPhi=function(a){n=a;return this};this.getPhi=function(){return n};this.setName=function(a){p=a};this.getName=function(){return p};this.render=function(a,b){k&&this.fullRender(a,b,s,q,r,r,!0)};g=new vizit.utility.Color(0.5,0.5,0.5,0.5);k=!0;
q=c;p=l;n=b;r=d;m=f;u=e;v=h;t=a;this.setColor(g);s=this.getCylinderModelView(u,v,t,this.getBaseHeight(),this.getBaseRadius(),n,m)};m.GaussianCylinder.prototype=new vizit.utility.Cylinder})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.GaussianSphere=function(e,h,a,c,d){var b,f,l,g,k,q,s,p;this.setColor=function(a){b=a};this.getColor=function(){return b};this.setEnabled=function(a){f=vizit.utility.toBoolean(a)};this.isEnabled=function(){return f};this.setX=function(a){q=a;return this};this.getX=function(){return q};this.setY=function(a){s=a;return this};this.getY=function(){return s};this.setZ=function(a){p=a;return this};this.getZ=function(){return p};this.setR=function(a){k=a;return this};this.getR=function(){return k};
this.setName=function(a){g=a};this.getName=function(){return g};this.getModelView=function(a){"undefined"===typeof a&&(a=1);"undefined"===typeof l?(l=new Float32Array(16),l[0]=a,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=a,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=a,l[11]=0,l[12]=q,l[13]=s,l[14]=p,l[15]=1):(l[0]=a,l[5]=a,l[10]=a);return l};this.drawFullSurface=function(a,b,d,c,f,g){var e;e=a.getGLContext();a.bindBuffer(d,b.getPositionHandle(),3,e.FLOAT,0,0);a.bindBuffer(c,b.getNormalHandle(),3,e.FLOAT,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,
f);e.drawElements(e.TRIANGLES,g,e.UNSIGNED_SHORT,0)};this.render=function(a,d){if(f){var c,g,e;c=a.getGLContext();g=this.getIntrinsicRadius();e=this.getVertexBuffers(a);c.uniformMatrix4fv(d.getModelViewMatrixHandle(),!1,this.getModelView(k/g));c.uniform4f(d.getSurfaceColorHandle(),b.getRed(),b.getGreen(),b.getBlue(),b.getAlpha());c.cullFace(c.FRONT);this.drawFullSurface(a,d,e.vertices,e.normals,e.indices,this.getNindices());c.cullFace(c.BACK);this.drawFullSurface(a,d,e.vertices,e.normals,e.indices,
this.getNindices())}};b=new vizit.utility.Color(0.5,0.5,0.5,0.5);f=!0;g=d;k=c;q=e;s=h;p=a};m.GaussianSphere.prototype=new vizit.geometry.Sphere})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargedCylinder=function(e,h,a,c,d,b,f,l,g,k,q,s){var p,n,r,m,u,v,t,y,C,B,G,I,F,K,H,A,E,x,z,D,L,J,M,N;this.setHeight=function(a){p=a;r=!0};this.getHeight=function(){return p};this.setTx=function(a){I=a;r=!0;return this};this.getTx=function(){return I};this.setTy=function(a){F=a;r=!0;return this};this.getTy=function(){return F};this.setTz=function(a){K=a;r=!0;return this};this.getTz=function(){return K};this.setX0=function(a){H=a;r=!0;return this};this.getX0=function(){return H};this.setY0=
function(a){A=a;r=!0;return this};this.getY0=function(){return A};this.setZ0=function(a){E=a;r=!0;return this};this.getZ0=function(){return E};this.setX1=function(a){x=a;r=!0;return this};this.getX1=function(){return x};this.setY1=function(a){z=a;r=!0;return this};this.getY1=function(){return z};this.setZ1=function(a){D=a;r=!0;return this};this.getZ1=function(){return D};this.setR0=function(a){B=a;r=!0;return this};this.getR0=function(){return B};this.setR1=function(a){G=a;r=!0;return this};this.getR1=
function(){return G};this.setPhi=function(a){v=a;r=!0;return this};this.getPhi=function(){return v};this.setTheta=function(a){t=a;r=!0;return this};this.getTheta=function(){return t};this.setNfieldLines=function(a){u=a;r=!0;return this};this.getNfieldLines=function(){return u};this.setModified=function(a){r=a;return this};this.isModified=function(){return r};this.setName=function(a){m=a;return this};this.getName=function(){return m};this.getStartPoints=function(){var a,b,d,c,f,g,e;e=[];if(0!==C+u){g=
this.sign(y);b=Math.max(2,Math.round(Math.abs(y*Math.PI*(G*G-B*B)*C*p)))+u;d=(B+1)/G;c=0.707106781*(B+1)/G;f=-0.5;a=1/(b-1);for(var k=0;k<b;k++)e.push([d,0,f,g]),e.push([-d,0,f,g]),e.push([0,d,f,g]),e.push([0,-d,f,g]),e.push([c,c,f,g]),e.push([c,-c,f,g]),e.push([-c,-c,f,g]),e.push([-c,c,f,g]),f+=a}return this.transformPoints(n,p/this.getBaseHeight(),G/this.getBaseRadius(),e)};this.getNormal=function(a,b,c){var d,f,g,e;d={};f=-((H-a)*L+(A-b)*J+(E-c)*M)/(N*N);g=H+f*L;e=A+f*J;f=E+f*M;d.x=a-g;d.y=b-e;
d.z=c-f;return d};this.getField=function(a,b,d){var c;c=Array(3);b=this.getNormal(a,b,d);d=Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z);a=2*(d<B?0:d<G?Math.PI*(d*d-B*B)*y:Math.PI*(G*G-B*B)*y)/d;c[0]=a*b.x/d;c[1]=a*b.y/d;c[2]=a*b.z/d;return c};this.render=function(a,b){this.fullRender(a,b,n,p/this.getBaseHeight(),B/this.getBaseRadius(),G/this.getBaseRadius(),!1)};r=!0;m=s;y="undefined"===typeof g?0:g;C="undefined"===typeof k?0:k;u="undefined"===typeof q?0:q;B=f;G=l;H=e;A=h;E=a;x=c;z=d;D=b;f=0<y?new vizit.utility.Color(0.05,
0.05,0.8,0.3):0>y?new vizit.utility.Color(0.8,0.05,0.05,0.3):new vizit.utility.Color(0.5,0.5,0.5,0.2);this.setColor(f);this.translateBounds(this,H,A,E,x,z,D);this.zAxisRotation(this,H,A,x,z);this.yAxisRotation(this,H,A,E,x,z,D);this.scale(this,E,D);H=e;A=h;E=a;x=c;z=d;D=b;n=this.getCylinderModelView(I,F,K,this.getBaseHeight(),this.getBaseRadius(),v,t);L=x-H;J=z-A;M=D-E;N=Math.sqrt(L*L+J*J+M*M)};m.ChargedCylinder.prototype=new vizit.utility.Cylinder})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargedLine=function(e,h,a,c,d,b,f,l,g,k){var q,s,p,n,r,m,u,v,t,y,C,B,G,I,F,K,H,A,E,x,z,D,L,J;this.computeColor=function(a){return 0<a?new vizit.utility.Color(0.05,0.05,0.8,0.8):0>a?new vizit.utility.Color(0.8,0.05,0.05,0.8):new vizit.utility.Color(0.5,0.5,0.5,0.8)};this.setChargeDensity=function(a){q=a;r=!0;this.setColor(this.computeColor(q))};this.getChargeDensity=function(){return q};this.setHeight=function(a){p=a;r=!0};this.getHeight=function(){return p};this.setTx=function(a){B=
a;r=!0;return this};this.getTx=function(){return B};this.setTy=function(a){G=a;return this};this.getTy=function(){return G};this.setTz=function(a){I=a;r=!0;return this};this.getTz=function(){return I};this.setX0=function(a){F=a;r=!0;return this};this.getX0=function(){return F};this.setY0=function(a){K=a;r=!0;return this};this.getY0=function(){return K};this.setZ0=function(a){H=a;r=!0;return this};this.getZ0=function(){return H};this.setX1=function(a){A=a;r=!0;return this};this.getX1=function(){return A};
this.setY1=function(a){E=a;r=!0;return this};this.getY1=function(){return E};this.setZ1=function(a){x=a;r=!0;return this};this.getZ1=function(){return x};this.setR0=function(a){y=a;r=!0;return this};this.getR0=function(){return y};this.setR1=function(a){C=a;r=!0;return this};this.getR1=function(){return C};this.setPhi=function(a){v=a;r=!0;return this};this.getPhi=function(){return v};this.setTheta=function(a){t=a;r=!0;return this};this.getTheta=function(){return t};this.setNfieldLines=function(a){u=
a;r=!0;return this};this.getNfieldLines=function(){return u};this.setModified=function(a){r=a;return this};this.isModified=function(){return r};this.setName=function(a){m=a;return this};this.getName=function(){return m};this.getStartPoints=function(){var a,b,d,c,f;f=[];if(0!==s+u){c=this.sign(q);b=Math.max(2,Math.round(Math.abs(q*s*p)))+u;d=-0.5;a=1/(b-1);for(var g=0;g<b;g++)f.push([1,0,d,c]),f.push([-1,0,d,c]),f.push([0,1,d,c]),f.push([0,-1,d,c]),f.push([0.707106781,0.707106781,d,c]),f.push([0.707106781,
-0.707106781,d,c]),f.push([-0.707106781,-0.707106781,d,c]),f.push([-0.707106781,0.707106781,d,c]),d+=a}return this.transformPoints(n,p/this.getBaseHeight(),(y+1)/this.getBaseRadius(),f)};this.getNormal=function(a,b,d){var c,f,g,e;c={};f=-((F-a)*z+(K-b)*D+(H-d)*L)/(J*J);g=F+f*z;e=K+f*D;f=H+f*L;c.x=a-g;c.y=b-e;c.z=d-f;return c};this.getField=function(a,b,d){var c;d=this.getNormal(a,b,d);c=Math.sqrt(d.x*d.x+d.y*d.y+d.z*d.z);a=Array(3);b=2*q/c;a[0]=b*d.x/c;a[1]=b*d.y/c;a[2]=b*d.z/c;return a};this.render=
function(a,b){this.fullRender(a,b,n,p,y,C,!1)};q="undefined"===typeof f?0:f;this.setColor(this.computeColor(q));r=!0;m=k;s="undefined"===typeof l?0:l;u="undefined"===typeof g?0:g;y=0;C=3;F=e;K=h;H=a;A=c;E=d;x=b;this.translateBounds(this,F,K,H,A,E,x);this.zAxisRotation(this,F,K,A,E);this.yAxisRotation(this,F,K,H,A,E,x);this.scale(this,H,x);F=e;K=h;H=a;A=c;E=d;x=b;n=this.getCylinderModelView(B,G,I,this.getBaseHeight(),this.getBaseRadius(),v,t);z=A-F;D=E-K;L=x-H;J=Math.sqrt(z*z+D*D+L*L)};m.ChargedLine.prototype=
new vizit.utility.Cylinder})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargedPlane=function(e,h,a,c,d,b,f,l,g,k,q,s,p,n,r,m){var u,v,t,y,C,B,G,I,F,K,H,A,E,x,z,D,L,J,M,N,O,P,S,R;this.setNfieldLines=function(a){H=a;F=!0;return this};this.getNfieldLines=function(){return H};this.setModified=function(a){F=a;return this};this.isModified=function(){return F};this.setName=function(a){K=a;return this};this.getName=function(){return K};this.calculateNormal=function(a){var b;b=Array(3);b[0]=(a[4]-a[1])*(a[11]-a[2])-(a[5]-a[2])*(a[10]-a[1]);b[1]=(a[5]-a[2])*(a[9]-
a[0])-(a[3]-a[0])*(a[11]-a[2]);b[2]=(a[3]-a[0])*(a[10]-a[1])-(a[4]-a[1])*(a[9]-a[0]);a=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]/=a;b[1]/=a;b[2]/=a;return b};this.adjustStartPoints=function(a){var b,d,c,f,g;b=a.length;for(var e=0;e<b;e++)d=a[e],c=d[0],f=d[1],g=d[2],d[0]=N+G*(J*c*C+g*x)+D*(-M*f*B+z*(-J*c*x+g*C)),d[1]=O+G*(M*f*B+z*(J*c*x-g*C))+D*(J*c*C+g*x),d[2]=P+M*f*z+B*(-J*c*x+g*C);return a};this.getStartPoints=function(){var a,b,d,c,f,g,e;b=Math.abs(L*E)+H/Math.abs(J*M);f=[];if(0<b)for(a=Math.sqrt(1/
b),b=a/Math.abs(J),a/=Math.abs(M),d=!1,c=0<L?1:-1,g=Math.min(-0.5+b/2,0.5),e=Math.min(-0.5+a/2,0.5);!d;)f.push([g,e,0.4,c]),f.push([g,e,-0.4,c]),e+=a,0.5<e?(e=0.5-(e-0.5),g+=b,a=-a):-0.5>e&&(e=-0.5-(e- -0.5),g+=b,a=-a),d=0.5<g;return this.adjustStartPoints(f)};this.getField=function(a,b,d){var c;c=Array(3);a=(a-y[0])*A[0]+(b-y[1])*A[1]+(d-y[2])*A[2];b=S*L;0===a&&(c[0]=0,c[1]=0,c[2]=0);0<a?(c[0]=b*A[0],c[1]=b*A[1],c[2]=b*A[2]):(c[0]=-b*A[0],c[1]=-b*A[1],c[2]=-b*A[2]);return c};this.translateBoundingBox=
function(b){N=(e+f)/2;O=(h+l)/2;P=(a+g)/2;b[0]-=N;b[1]-=O;b[2]-=P;b[3]-=N;b[4]-=O;b[5]-=P;b[6]-=N;b[7]-=O;b[8]-=P;b[9]-=N;b[10]-=O;b[11]-=P;return b};this.zAxisRotation=function(a){var b,c;b=a[3]-a[0];c=a[0]-a[9];0===b||0===c?(t=0,R=0===b&&0===c?0===a[4]-a[1]?1:2:0===b?1:2):(b=(d-h)/b,c=(l-d)/c,Math.abs(b)<Math.abs(c)?(t=Math.atan(b),R=1):(t=Math.atan(c),R=2));G=Math.cos(t);D=Math.sin(t);for(var f=0;4>f;f++)c=G*a[3*f]-D*a[3*f+1],b=D*a[3*f]+G*a[3*f+1],a[3*f]=c,a[3*f+1]=b;return a};this.xAxisRotation=
function(a,b){var c,d;1===b?(c=a[1]-a[10],d=a[2]-a[11]):(c=a[4]-a[1],d=a[5]-a[2]);z=v=0;B=1;if(0!==d&&0!==c){v=Math.atan(d/c);z=Math.sin(v);B=Math.cos(v);for(var f=0;4>f;f++)c=B*a[3*f+1]-z*a[3*f+2],d=z*a[3*f+1]+B*a[3*f+2],a[3*f+1]=c,a[3*f+2]=d}return a};this.yAxisRotation=function(a,b){var c,d;1===b?(c=a[0]-a[9],d=a[2]-a[11]):(c=a[3]-a[0],d=a[5]-a[2]);x=u=0;C=1;if(0!==d){0!==c?(u=Math.atan(d/c),x=Math.sin(u),C=Math.cos(u)):(u=1.5707963267948966,x=1,C=0);for(var f=0;4>f;f++)c=C*a[3*f]+x*a[3*f+2],d=
-x*a[3*f]+C*a[3*f+2],a[3*f]=c,a[3*f+2]=d}return a};this.scaleBoundingbox=function(a,b){1===b?(J=a[0]-a[9],M=a[4]-a[1]):(J=a[3]-a[0],M=a[1]-a[10]);for(var c=0;4>c;c++)0!==J&&(a[3*c]/=J),0!==M&&(a[3*c+1]/=M);return a};this.getModelView=function(){return I};this.drawFullSurface=function(a,b,c,d,f,g){var e;e=a.getGLContext();a.bindBuffer(c,b.getPositionHandle(),3,e.FLOAT,0,0);a.bindBuffer(d,b.getNormalHandle(),3,e.FLOAT,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f);e.drawElements(e.TRIANGLES,g,e.UNSIGNED_SHORT,
0)};this.render=function(a,b){var c,d,f;c=a.getGLContext();f=this.getVertexBuffers(a);0<L?c.uniform4f(b.getSurfaceColorHandle(),0.05,0.05,0.8,0.4):0>L?c.uniform4f(b.getSurfaceColorHandle(),0.8,0.05,0.05,0.4):c.uniform4f(b.getSurfaceColorHandle(),0.5,0.5,0.5,0.2);d=this.getNindices();c.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView());c.disable(c.CULL_FACE);this.drawFullSurface(a,b,f.vertices,f.normals,f.indices,d);c.enable(c.CULL_FACE)};F=!0;K=m;S=6.283185307179586;L="undefined"===
typeof p?0:p;E="undefined"===typeof n?0:n;H="undefined"===typeof r?0:r;y=[e,h,a,c,d,b,f,l,g,k,q,s];c=y.slice(0);A=this.calculateNormal(y);c=this.translateBoundingBox(c);c=this.zAxisRotation(c);c=this.xAxisRotation(c,R);c=this.yAxisRotation(c,R);c=this.scaleBoundingbox(c,R);I=new Float32Array(16);C=Math.cos(-u);B=Math.cos(-v);G=Math.cos(-t);x=Math.sin(-u);z=Math.sin(-v);D=Math.sin(-t);I[0]=J*(C*G-x*z*D);I[1]=J*(C*D+G*x*z);I[2]=-J*B*x;I[3]=0;I[4]=-M*B*D;I[5]=M*B*G;I[6]=M*z;I[7]=0;I[8]=z*D*C+x*G;I[9]=
-(z*C*G-x*D);I[10]=C*B;I[11]=0;I[12]=N;I[13]=O;I[14]=P;I[15]=1};m.ChargedPlane.prototype=new vizit.geometry.Square})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargedSphere=function(e,h,a,c,d,b,f,l,g){var k,q,s,p,n,r,m,u,v,t,y;m=!0;u=g;v=0;k=c;q=k*k;s=q*k;p=d;n=p*p*p;t="undefined"===typeof b?0:b;y="undefined"===typeof f?0:f;nfieldLines="undefined"===typeof l?0:l;this.setA=function(a){k=a;q=k*k;s=q*k;m=!0;return this};this.getA=function(){return k};this.setB=function(a){p=a;n=p*p*p;m=!0;return this};this.getB=function(){return p};this.setNindices=function(a){v=a;return this};this.setModified=function(a){m=a;return this};this.isModified=function(){return m};
this.setNfieldLines=function(a){nfieldLines=a;m=!0;return this};this.getNfieldLines=function(){return nfieldLines};this.setName=function(a){u=a;return this};this.getName=function(){return u};this.getStartPoints=function(){var b,c,d,f,g,l,r;l=0<t?1:0>t?-1:0;b=Math.round(y*t*l)+nfieldLines;f=3.6/Math.sqrt(b);c=0;radius=k+0.2*(p-k);g=[];for(var q=1;q<b;q++)r=-1+2*q/b,d=Math.sqrt(1-r*r),c+=f/d,g.push([Math.cos(c)*d*radius+e,r*radius+h,Math.sin(c)*d*radius+a,l]);return g};this.getField=function(b,c,d){var f,
g=[0,0,0],l;b-=e;c-=h;d-=a;f=b*b+c*c+d*d;if(f<=q)return g;l=Math.sqrt(f);f=l>=k&&l<p?t*(l-s/f)/(n-s):t/f;g[0]=f*b/l;g[1]=f*c/l;g[2]=f*d/l;return g};this.getModelView=function(b){"undefined"===typeof b&&(b=1);null===r?(r=new Float32Array(16),r[0]=b,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=b,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=b,r[11]=0,r[12]=e,r[13]=h,r[14]=a,r[15]=1):(r[0]=b,r[5]=b,r[10]=b);return r};this.drawFullSurface=function(a,b,c,d,f,g){var e;e=a.getGLContext();a.bindBuffer(c,b.getPositionHandle(),3,
e.FLOAT,0,0);a.bindBuffer(d,b.getNormalHandle(),3,e.FLOAT,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f);e.drawElements(e.TRIANGLES,g,e.UNSIGNED_SHORT,0)};this.render=function(a,b){var c,d,f,g,e;d=a.getGLContext();c=this.getIntrinsicRadius();e=this.getVertexBuffers(a);0<t?d.uniform4f(b.getSurfaceColorHandle(),0.05,0.05,0.8,0.2):0>t?d.uniform4f(b.getSurfaceColorHandle(),0.8,0.05,0.05,0.2):d.uniform4f(b.getSurfaceColorHandle(),0.5,0.5,0.5,0.2);v=this.getNindices();d.cullFace(d.FRONT);for(f=p;f>=k;f--)g=
f/c,d.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView(g)),this.drawFullSurface(a,b,e.vertices,e.normals,e.indices,v);d.cullFace(d.BACK);for(f=k;f<=p;f++)g=f/c,this.drawFullSurface(a,b,e.vertices,e.normals,e.indices,v),d.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView(g))}};m.ChargedSphere.prototype=new vizit.geometry.Sphere})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.Charge=function(e,h,a,c,d,b,f){var l,g,k,q,s,m,n;this.setCharge=function(a){l=vizit.utility.ensureNumber(a);g=!0};this.getCharge=function(){return l};this.setX=function(a){s[0]=vizit.utility.ensureNumber(a);g=!0};this.getX=function(){return s[0]};this.setY=function(a){s[1]=vizit.utility.ensureNumber(a);g=!0};this.getY=function(){return s[1]};this.setZ=function(a){s[2]=vizit.utility.ensureNumber(a);g=!0};this.getZ=function(){return s[2]};this.setPosition=function(a){s=a;g=!0};this.getPosition=
function(){return s};this.setNfieldLines=function(a){q=a;g=!0};this.getNfieldLines=function(){return q};this.setModified=function(a){g=a};this.isModified=function(){return g};this.setName=function(a){k=a};this.getName=function(){return k};this.getField=function(a,b,c){var d,f=[0,0,0],g;a-=s[0];b-=s[1];c-=s[2];n=a*a+b*b+c*c;if(0>=n)return f;g=Math.sqrt(n);d=l/n;f[0]=d*a/g;f[1]=d*b/g;f[2]=d*c/g;return f};this.getFieldSeedPointsI=function(a){var b,c,d,f,g,e;f=[];g=0<l?1:0>l?-1:0;a=Math.round(a*l*g);
b=2/a;for(var k=0;k<a;k++)e=k*b-1+b/2,d=Math.sqrt(1-e*e),c=2.39996323*k,f.push([Math.cos(c)*d+s[0],e+s[1],Math.sin(c)*d+s[2],g]);return f};this.getStartPoints=function(a,b){var c,d,f,g,e,k,h;k=0<l?1:0>l?-1:0;c=Math.round(m*l*k)+1+q;g=3.6/Math.sqrt(c);d="undefined"===typeof a?Math.PI/2:a;b="undefined"===typeof b?1:b;e=[];if(0<c)for(var n=1;n<c;n++)h=-1+2*n/c,f=Math.sqrt(1-h*h),d+=g/f,e.push([Math.cos(d)*f*b+s[0],h*b+s[1],Math.sin(d)*f*b+s[2],k]);return e};this.shouldStop=function(a,b,c,d){return 0>
a*l&&4>n};l=c;g=!0;k=f;s=[vizit.utility.ensureNumber(e),vizit.utility.ensureNumber(h),vizit.utility.ensureNumber(a)];m="undefined"===typeof d?0:d;q="undefined"===typeof b?0:b};m.Charges=function(){var e,h,a,c;this.addCharge=function(b){a=e.push(b);return this};for(var d=0;d<arguments.length;d++)this.addCharge(arguments[d]);this.getNcharges=function(){return a};this.getCharges=function(){return e};this.addDistribution=function(a){c=h.push(a);return this};this.getNdistributions=function(){return c};
this.getDistributions=function(){return h};this.chargesModified=function(){var b;b=!1;for(d=0;d<a&&!b;d++)b=b||e[d].isModified();return b};this.distributionsModified=function(){var a;a=!1;for(d=0;d<c&&!a;d++)a=a||h[d].isModified();return a};this.isModified=function(){return this.chargesModified()||this.distributionsModified()};this.setModified=function(b){for(d=0;d<a;d++)e[d].setModified(b);for(d=0;d<c;d++)h[d].setModified(b)};this.getStartPoints=function(b,d){var l,g=b,k=1.57079632679/(a+1),q=[],
s;for(l=0;l<a;l++)s=e[l],q=q.concat(s.getStartPoints(g,d)),g+=k;for(l=0;l<c;l++)q=q.concat(h[l].getStartPoints());return q};this.getField=function(b,d,l){for(var g,k=[0,0,0],q=0;q<a;q++)g=e[q],g=g.getField(b,d,l),k[0]+=g[0],k[1]+=g[1],k[2]+=g[2];for(q=0;q<c;q++)g=h[q].getField(b,d,l),k[0]+=g[0],k[1]+=g[1],k[2]+=g[2];return k};this.shouldStop=function(b,c,d,g){var k;k=!1;for(var h=0;h<a&!k;h++)k=e[h],k=k.shouldStop(b,c,d,g);return k};a=0;e=[];h=[]}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ElectricField=function(){var e,h,a,c,d,b,f,l,g,k,q,s,m,n,r,w,u,v,t,y,C;this.setArrowSpacing=function(a){h=a;"undefined"!==typeof r&&r.setArrowSpacing(a)};this.getArrowSpacing=function(){return h};this.setArrowHeadSize=function(a){e=a;"undefined"!==typeof r&&r.setArrowHeadSize(a)};this.getArrowHeadSize=function(){return e};this.setColor=function(a){f=a};this.getColor=function(){return f};this.setCharges=function(a){b=a};this.getCharges=function(){return b};this.addGaussianSurface=function(a){k.push(a)};
this.getGaussianSurfaces=function(){return k};this.setGlUtility=function(a){q=a};this.getGlUtility=function(){return q};this.setMaxVectors=function(a){m=a};this.getMaxVectors=function(){return m};this.setModelViewMatrix=function(a){u=a;n=q.extractRotationPart(u,n)};this.getModelViewMatrix=function(){return u};this.setProjectionMatrix=function(a){v=a};this.addStartPoint=function(a,b,c,d){t.push([a,b,c,d]);return this};this.addStartPoints=function(a){t=t.concat(a)};this.getStartPoints=function(){return t};
this.render=function(){if(y){var c;c=q.getGLContext();b.chargesModified()?(this.setupCharges(),this.setupFieldLines()):b.distributionsModified()&&this.setupFieldLines();q.clear();d.render(v,u,a,b);w.render(v,u,f,g);c.enable(c.BLEND);c.enable(c.CULL_FACE);c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA);C.render(v,u,n,b.getDistributions());c.disable(c.DEPTH_TEST);C.render(v,u,n,k);c.enable(c.DEPTH_TEST);c.disable(c.BLEND);c.disable(c.CULL_FACE);b.setModified(!1)}};this.setupCharges=function(b){a||(b=
q.getGLContext(),a=b.createBuffer());b=c.generate();q.loadData(a,b)};this.setupFieldLines=function(){var a,c,d,f,e,k;e=[];e=e.concat(b.getStartPoints(0,5));e=e.concat(t);d=e.length;f=g.length;k=Math.min(d,f);for(c=0;c<k;++c)a=e[c],a=r.generate(a[0],a[1],a[2],a[3]),g[c].reload(q,a);for(;c<f;++c)g[c].disable();for(;c<d;++c)a=e[c],a=r.generate(a[0],a[1],a[2],a[3]),g.push(new vizit.electricfield.FieldLineVBO(q,a))};this.start=function(){q.clearColor(0,0,0,0);w=new vizit.electricfield.FieldLineRenderer(q);
c=new vizit.electricfield.ChargeGenerator(b);r=new vizit.electricfield.FieldLineGenerator(b,s,l,e,h);this.setupFieldLines(b,s,l,e,h);d=new vizit.electricfield.ChargeRenderer(q);this.setupCharges(b);C=new vizit.electricfield.SurfaceRenderer(q);y=!0;this.render()};e=0.3;h=1.2;f=new Float32Array([0.8,0.3,0.3,1]);l=0.6;g=[];k=[];s=3E3;m=5;n=new Float32Array([1,0,0,0,1,0,0,0,1]);t=[];y=!1}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(m){m.VectorFieldGenerator=function(e,h,a,c,d){var b,f,l,g,k,q,s,m;this.setStartPoints=function(a){m=a;return this};this.getStartPoints=function(){return m};this.setMaxVectors=function(a){q=a;return this};this.getMaxVectors=function(){return q};this.setArrowHeadSize=function(a){f=a;return this};this.getArrowHeadSize=function(){return f};this.setVectorSpacing=function(a){vectorSpacing=a;return this};this.getVectorSpacing=function(){return vectorSpacing};this.setDs=function(a){g=a;return this};
this.getDs=function(){return g};this.generateVector=function(a,b,c,d,f,g,e,k,l,h){var q,s,m,p,A,E,x,z,D,L,J,M,N;L=a+d[0]*l;J=b+d[1]*l;M=c+d[2]*l;0!==d[2]?(x=E=1,z=-(d[0]+d[1])/d[2]):(0!==d[1]?(E=1,x=-(d[0]+d[2])/d[1]):(E=-(d[1]+d[2])/d[0],x=1),z=1);D=e*g*f*l/Math.sqrt(E*E+x*x+z*z);E*=D;x*=D;z*=D;q=g*d[0]*l;s=g*d[1]*l;d=g*d[2]*l;m=s*z-d*x;p=d*E-q*z;A=q*x-s*E;D=e*g*f*l/Math.sqrt(m*m+p*p+A*A);m*=D;p*=D;A*=D;f=L-q+E;g=J-s+x;e=M-d+z;E=L-q-E;x=J-s-x;z=M-d-z;l=L-q+m;D=J-s+p;N=M-d+A;q=L-q-m;s=J-s-p;A=M-d-
A;d=6*k+1;h.pushVertex(a);h.pushVertex(b);h.pushVertex(c);h.pushIndex(6*k);h.pushVertex(L);h.pushVertex(J);h.pushVertex(M);h.pushIndex(d);h.pushVertex(f);h.pushVertex(g);h.pushVertex(e);h.pushIndex(6*k+2);h.pushIndex(d);h.pushVertex(E);h.pushVertex(x);h.pushVertex(z);h.pushIndex(6*k+3);h.pushIndex(d);h.pushVertex(l);h.pushVertex(D);h.pushVertex(N);h.pushIndex(6*k+4);h.pushIndex(d);h.pushVertex(q);h.pushVertex(s);h.pushVertex(A);h.pushIndex(6*k+5);h.pushIndex(d)};this.trace=function(a,c,d,e,k,h,l,
q,s){var m,p,F,K,H;H=K=m=0;for(p=!1;H<h&&!p;){F=a.getField(c,d,e);p=Math.sqrt(F[0]*F[0]+F[1]*F[1]+F[2]*F[2]);if(0===p)break;m>=K&&(this.generateVector(c,d,e,F,p,f,b,l+H,q,s),K=m+Math.max(1.2*p*q,1),H++);c+=k*F[0]/p*g;d+=k*F[1]/p*g;e+=k*F[2]/p*g;m+=g;p=a.shouldStop(k,c,d,e)}return H};this.generateField=function(){var a,b,c,d;c=m.length;s=0;b=new vizit.utility.IndexedVertices(6*q*c,10*q*c);for(a=0;a<c;a++)d=m[a],d[4]=s,s+=this.trace(k,d[0],d[1],d[2],d[3],q,s,l,b);return b};b=c;f=a;g=0.33;k=e;q=h;l=
d}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.field=window.vizit.field||{};
(function(m){m.FieldRenderer=function(e){var h,a,c,d,b,f,l,g;this.getContext=function(){return c.getGLContext()};this.setRenderer=function(a){f=a;f.setGlUtility(c);f.setModelViewMatrix(d);f.setProjectionMatrix(b)};this.setModelViewMatrix=function(a){d=a;f.setModelViewMatrix(d)};this.getModelViewMatrix=function(){return d};this.requestRender=function(){l||(l=!0,requestAnimationFrame(this.render))};this.render=function(){f.render();l=!1};this.start=function(){f.start()};this.setScale=function(a){g=
a;1>g&&(g=1);b=c.generateOrthographicMatrix(g,g,-g,g);f.setProjectionMatrix(b);this.render()};this.zoomBy=function(a){this.setScale(g+a)};this.setElementName=function(a,b){h[b]=a};this.getElementByName=function(a){var b;h.hasOwnProperty(a)&&(b=h[a]);return b};h={};c=new vizit.utility.GLUtility(e);g=5;d=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);new Float32Array([1,0,0,0,1,0,0,0,1]);b=c.generateOrthographicMatrix(g,g,-g,g);a=new vizit.utility.MotionEventHandler(this,c,75,4);e.addEventListener("mousewheel",
a.handleMouseWheel.bind(a),!1);e.addEventListener("mousedown",a.handleMouseDown.bind(a),!1);document.addEventListener("mouseup",a.handleMouseUp.bind(a),!1);document.addEventListener("mousemove",a.handleMouseMove.bind(a),!1);e.addEventListener("touchstart",a.handleTouchStart.bind(a),!1);e.addEventListener("touchmove",a.handleTouchMove.bind(a),!1);e.addEventListener("touchend",a.handleTouchEnd.bind(a),!1)}})(window.vizit.field);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.BindingBuilder=function(){this.bindingBuilder=function(e,h,a){var c,d,b,f;for(b in h)"set"===b.toLowerCase()?f=h[b]:"from"===b.toLowerCase()?c=h[b]:"mapping"===b.toLowerCase()&&(d=h[b]);c||(c=f);h="set"+f.charAt(0).toUpperCase();1<f.length&&(h+=f.slice(1));f=e[h];f=f.bind(e);e=d?new window.vizit.lesson.MappingEventHandler(f,c,d,a):new window.vizit.lesson.DirectEventHandler(f,a);document.addEventListener(c+"Changed",e.handleUpdate.bind(e),!1)};this.bind=function(e,h,a){var c;if(h)if(Array.isArray(h)){c=
h.length;for(var d=0;d<c;++d)this.bindingBuilder(e,h[d],a)}else this.bindingBuilder(e,h,a)}};m.bindingBuilder=new m.BindingBuilder})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.CombinedVectorValuedFunctionBuilder=function(e){var h;this.buildFunction=function(a){var c,d,b;for(b in a)"args"===b.toLowerCase()?c=a[b]:"body"===b.toLowerCase()?d=a[b]:"name"===b.toLowerCase()?name=a[b]:"properties"!==b.toLowerCase()&&"stop"!==b.toLowerCase()&&b.toLowerCase();return new vizit.vectorfield.VectorFunction(c,d)};this.build=function(a){var c,d,b,f;if(a)if(d=new vizit.vectorfield.CombinedVectorFunctions,Array.isArray(a)){f=a.length;for(var e=0;e<f;++e)if(c=this.buildFunction(a[e]))d.addFunction(c),
(b=c.getName())&&h.setElementName(c,b)}else if(c=this.buildFunction(a))d.addFunction(c),(b=c.getName())&&h.setElementName(c,b);return d};h=e}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.SurfaceBuilder=function(){var e,h,a,c,d,b;this.getXMin=function(){return e};this.getXMax=function(){return h};this.getYMin=function(){return a};this.getYMax=function(){return c};this.getZMin=function(){return d};this.getZMax=function(){return b};this.gaussianCylinderBuilder=function(f){var l,g,k,q,m,p,n,r,w,u;l=!0;for(m in f)"x"===m.toLowerCase()?r=f[m]:"y"===m.toLowerCase()?w=f[m]:"z"===m.toLowerCase()?u=f[m]:"h"===m.toLowerCase()?g=f[m]:"r"===m.toLowerCase()?p=f[m]:"phi"===m.toLowerCase()?
q=f[m]:"theta"===m.toLowerCase()?n=f[m]:"name"===m.toLowerCase()?k=f[m]:"enabled"===m.toLowerCase()&&(l=f[m]);e=Math.min(e,r-p,r+p);h=Math.max(h,r-p,r+p);a=Math.min(a,w-p,w-p);c=Math.max(c,w-p,w+p);d=Math.min(d,u-g,u+g);b=Math.max(b,u-g,u+g);f=new vizit.electricfield.GaussianCylinder(r,w,u,g,p,q,n,k);l||f.setEnabled(l);return f};this.gaussianSphereBuilder=function(f){var l,g,k,q,m,p,n;l=!0;for(k in f)"x"===k.toLowerCase()?m=f[k]:"y"===k.toLowerCase()?p=f[k]:"z"===k.toLowerCase()?n=f[k]:"r"===k.toLowerCase()?
q=f[k]:"name"===k.toLowerCase()?g=f[k]:"enabled"===k.toLowerCase()&&(l=f[k]);e=Math.min(e,m-q,m+q);h=Math.max(h,m-q,m+q);a=Math.min(a,p-q,p-q);c=Math.max(c,p-q,p+q);d=Math.min(d,n-q,n+q);b=Math.max(b,n-q,n+q);f=new vizit.electricfield.GaussianSphere(m,p,n,q,g);l||f.setEnabled(l);return f};this.surfaceBuilder=function(a,b){var c,d,e,h,m;d=/\s*gaussian\s*sphere\s*/i;for(e in a)"type"===e.toLowerCase()?m=a[e]:"bind"===e.toLowerCase()&&(c=a[e]);m.match(/\s*gaussian\s*cylinder\s*/i)?h=this.gaussianCylinderBuilder(a):
m.match(d)&&(h=this.gaussianSphereBuilder(a));"undefined"!==typeof c&&"undefined"!==h&&this.bind(h,c,b);return h};this.build=function(a,b,c){var d,e;if(a)if(Array.isArray(a)){e=a.length;for(var h=0;h<e;++h)if(d=this.surfaceBuilder(a[h],c))b.addGaussianSurface(d),(name=d.getName())&&c.setElementName(d,name)}else if(d=this.surfaceBuilder(a,c))b.addGaussianSurface(d),(name=d.getName())&&c.setElementName(d,name);return b}};m.SurfaceBuilder.prototype=m.bindingBuilder})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};(function(m){m.VectorValuedFunctionBuilder=function(e){var h;this.build=function(a,c){var d,b;a&&(d=Array.isArray(a)?a[0]:a,"undefined"!==typeof d&&(b="function"===d.type.toLowerCase()?new vizit.builder.CombinedVectorValuedFunctionBuilder(h):new vizit.builder.ElectricFieldElementBuilder(h,c)));return b.build(a)};h=e}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.DistributionBuilder=function(){var e,h,a,c,d,b,f,l;this.getXMin=function(){return a};this.getXMax=function(){return c};this.getYMin=function(){return d};this.getYMax=function(){return b};this.getZMin=function(){return f};this.getZMax=function(){return l};this.chargedPlaneBuilder=function(g){var k,m,s,p,n,r,w,u,v,t,y,C,B,G,I,F,K;for(k in g)k.match(e)?m=g[k]:k.match(h)?s=g[k]:"nfieldLines"===k.toLowerCase()?n=g[k]:"x0"===k.toLowerCase()?r=g[k]:"y0"===k.toLowerCase()?w=g[k]:"z0"===k.toLowerCase()?
u=g[k]:"x1"===k.toLowerCase()?v=g[k]:"y1"===k.toLowerCase()?t=g[k]:"z1"===k.toLowerCase()?y=g[k]:"x2"===k.toLowerCase()?C=g[k]:"y2"===k.toLowerCase()?B=g[k]:"z2"===k.toLowerCase()?G=g[k]:"x3"===k.toLowerCase()?I=g[k]:"y3"===k.toLowerCase()?F=g[k]:"z3"===k.toLowerCase()?K=g[k]:"name"===k.toLowerCase()&&(p=g[k]);a=Math.min(a,r,v,C,I);c=Math.max(c,r,v,C,I);d=Math.min(d,w,t,B,K);b=Math.max(b,w,t,B,K);f=Math.min(f,u,y,G,K);l=Math.max(l,u,y,G,K);return new vizit.electricfield.ChargedPlane(r,w,u,v,t,y,C,
B,G,I,F,K,m,s,n,p)};this.chargedCylinderBuilder=function(g){var k,m,s,p,n,r,w,u,v,t,y,C,B;for(n in g)n.match(e)?k=g[n]:n.match(h)?m=g[n]:"nfieldLines"===n.toLowerCase()?p=g[n]:"x0"===n.toLowerCase()?r=g[n]:"y0"===n.toLowerCase()?w=g[n]:"z0"===n.toLowerCase()?u=g[n]:"x1"===n.toLowerCase()?v=g[n]:"y1"===n.toLowerCase()?t=g[n]:"z1"===n.toLowerCase()?y=g[n]:"r0"===n.toLowerCase()?C=g[n]:"r1"===n.toLowerCase()?B=g[n]:"name"===n.toLowerCase()&&(s=g[n]);a=Math.min(a,r,v);c=Math.max(c,r,v);d=Math.min(d,w,
t);b=Math.max(b,w,t);f=Math.min(f,u,y);l=Math.max(l,u,y);return new vizit.electricfield.ChargedCylinder(r,w,u,v,t,y,C,B,k,m,p,s)};this.chargedLineBuilder=function(g){var k,m,s,p,n,r,w,u,v,t,y;for(n in g)n.match(e)?k=g[n]:n.match(h)?m=g[n]:"nfieldLines"===n.toLowerCase()?p=g[n]:"x0"===n.toLowerCase()?r=g[n]:"y0"===n.toLowerCase()?w=g[n]:"z0"===n.toLowerCase()?u=g[n]:"x1"===n.toLowerCase()?v=g[n]:"y1"===n.toLowerCase()?t=g[n]:"z1"===n.toLowerCase()?y=g[n]:"name"===n.toLowerCase()&&(s=g[n]);a=Math.min(a,
r,v);c=Math.max(c,r,v);d=Math.min(d,w,t);b=Math.max(b,w,t);f=Math.min(f,u,y);l=Math.max(l,u,y);return new vizit.electricfield.ChargedLine(r,w,u,v,t,y,k,m,p,s)};this.chargedSphereBuilder=function(e){var k,m,s,p,n,r,w,u,v;for(property in e)"charge"===property.toLowerCase()?k=e[property]:property.match(h)?m=e[property]:"nfieldLines"===property.toLowerCase()?p=e[property]:"x"===property.toLowerCase()?n=e[property]:"y"===property.toLowerCase()?r=e[property]:"z"===property.toLowerCase()?w=e[property]:"a"===
property.toLowerCase()?u=e[property]:"b"===property.toLowerCase()?v=e[property]:"name"===property.toLowerCase()&&(s=e[property]);a=Math.min(a,n-v);c=Math.max(c,n+v);d=Math.min(d,r-v);b=Math.max(b,r+v);f=Math.min(f,w-v);l=Math.max(l,w+v);return new vizit.electricfield.ChargedSphere(n,r,w,u,v,k,m,p,s)};this.chargeDistributionBuilder=function(a,b){var c,d,f,e,h,l,m;d=/\s*charged\s*cylinder\s*/i;f=/\s*charged\s*line\s*/i;e=/\s*charged\s*sphere\s*/i;for(l in a)"type"===l.toLowerCase()?m=a[l]:"bind"===
l.toLowerCase()&&(c=a[l]);m.match(/\s*charged\s*plane\s*/i)?h=this.chargedPlaneBuilder(a):m.match(d)?h=this.chargedCylinderBuilder(a):m.match(f)?h=this.chargedLineBuilder(a):m.match(e)&&(h=this.chargedSphereBuilder(a));"undefined"!==typeof c&&"undefined"!==h&&this.bind(h,c,b);return h};this.build=function(a,b,c){var d,f,e;if(a)if(Array.isArray(a)){e=a.length;for(var h=0;h<e;++h)if(d=this.chargeDistributionBuilder(a[h],c))b.addDistribution(d),(f=d.getName())&&c.setElementName(d,f)}else if(d=this.chargeDistributionBuilder(a,
c))b.addDistribution(d),(f=d.getName())&&c.setElementName(d,f);return b};e=/\s*charge\s*density\s*/i;h=/\s*field\s*line\s*density\s*/i};m.DistributionBuilder.prototype=m.bindingBuilder})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.ChargesBuilder=function(){var e,h,a,c,d,b;this.getXMin=function(){return e};this.getXMax=function(){return h};this.getYMin=function(){return a};this.getYMax=function(){return c};this.getZMin=function(){return d};this.getZMax=function(){return b};this.chargeBuilder=function(f,l){var g,k,m,s,p,n,r,w,u,v,t,y;m="";w=/\s*field\s*line\s*density\s*/i;for(t in f)"charge"===t.toLowerCase()?y=f[t]:"x"===t.toLowerCase()?p=f[t]:"y"===t.toLowerCase()?n=f[t]:"z"===t.toLowerCase()?r=f[t]:t.match(w)?
u=f[t]:"nfieldlines"===t.toLowerCase()?v=f[t]:"bind"===t.toLowerCase()?g=f[t]:"name"===t.toLowerCase()&&(s=f[t]);"undefined"===typeof y&&(m="No charge specified for point charge.");"undefined"===typeof p&&(0<m.length&&(m+="\n"),m+="x coordinate is not defined in charge configuration.");"undefined"===typeof n&&(0<m.length&&(m+="\n"),m+="y coordinate is not defined in charge configuration.");"undefined"===typeof r&&(0<m.length&&(m+="\n"),m+="z coordinate is not defined in charge configuration.");0===
m.length&&(p<e&&(e=p),p>h&&(h=p),n<a&&(a=n),n>c&&(c=n),r<d&&(d=r),r>b&&(b=r),k=new vizit.electricfield.Charge(p,n,r,y,u,v,s),"undefined"!==typeof g&&this.bind(k,g,l));return k};this.build=function(a,b,c){var d,e,h;if(a)if(Array.isArray(a)){h=a.length;for(var m=0;m<h;++m)if(d=this.chargeBuilder(a[m],c))b.addCharge(d),(e=d.getName())&&c.setElementName(d,e)}else if(d=this.chargeBuilder(a,c))b.addCharge(d),(e=d.getName())&&c.setElementName(d,e);return b};e=Number.POSITIVE_INFINITY;h=Number.NEGATIVE_INFINITY;
a=Number.POSITIVE_INFINITY;c=Number.NEGATIVE_INFINITY;d=Number.POSITIVE_INFINITY;b=Number.NEGATIVE_INFINITY};m.ChargesBuilder.prototype=m.bindingBuilder})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.ElectricFieldElementBuilder=function(e,h){var a,c;this.buildELement=function(d,b){var f,e,g,h,m,s,p,n;f=/\s*charged\s*cylinder\s*/i;e=/\s*charged\s*line\s*/i;g=/\s*charged\s*plane\s*/i;h=/\s*charged\s*sphere\s*/i;m=/\s*gaussian\s*cylinder\s*/i;s=/\s*gaussian\s*sphere\s*/i;for(p in d)"type"===p.toLowerCase()&&(n=d[p]);if("charge"===n.toLowerCase())f=new vizit.builder.ChargesBuilder,b=f.build(d,b,a);else if(n.match(f)||n.match(e)||n.match(g)||n.match(h))f=new vizit.builder.DistributionBuilder,
b=f.build(d,b,a);else if(n.match(m)||n.match(s))f=new vizit.builder.SurfaceBuilder,c=f.build(d,c,a);return b};this.build=function(a){var b,c;b=new vizit.electricfield.Charges;if(a)if(Array.isArray(a)){c=a.length;for(var e=0;e<c;++e)this.buildELement(a[e],b)}else this.buildELement(a,b);return b};a=e;c=h}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.ElectricFieldBuilder=function(e){var h;this.build=function(a){var c,d,b,f,e,g;for(g in a)"arrowheadsize"===g.toLowerCase()?c=a[g]:"arrowspacing"===g.toLowerCase()?d=a[g]:"maxvectors"===g.toLowerCase()?e=a[g]:"elements"===g.toLowerCase()&&(f=a[g]);a=new vizit.electricfield.ElectricField;"undefined"!==typeof e&&a.setMaxVectors(e);"undefined"!==typeof c&&a.setArrowHeadSize(c);"undefined"!==typeof d&&a.setArrowSpacing(d);(b=(new vizit.builder.ElectricFieldElementBuilder(h,a)).build(f,b))&&
a.setCharges(b);return a};h=e}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.SimpleVectorFieldBuilder=function(e){var h;this.build=function(a){var c,d,b,e,l,g,k;for(k in a)"arrowheadsize"===k.toLowerCase()&&(c=a[k]),"arrowheadwidth"===k.toLowerCase()?d=a[k]:"arrowsize"===k.toLowerCase()?b=a[k]:"maxvectors"===k.toLowerCase()&&(e=a[k]),"f"===k.toLowerCase()&&(g=a[k]);g&&(a=new vizit.builder.VectorValuedFunctionBuilder(h),l=a.build(g));b=new vizit.vectorfield.SimpleVectorField(l,b);"undefined"!==typeof e&&b.setMaxVectors(e);"undefined"!==typeof c&&b.setArrowHeadSize(c);
"undefined"!==typeof d&&b.setArrowHeadWidth(d);return b};h=e}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.VizBuilder=function(){this.processConfig=function(e){var h,a,c,d,b,f,l,g,k;h=/\s*electric\s*field\s*/i;f=/\s*simple\s*vector\s*field\s*/i;g=/\s*start\s*points\s*/i;for(a in e)"canvas"===a.toLowerCase()?c=e[a]:"scale"===a.toLowerCase()?b=e[a]:"type"===a.toLowerCase()?k=e[a]:a.match(g)&&(l=e[a]);"undefined"===typeof k?alert("Missing type for visualization configuration."):"undefined"===c?alert("No canvas specified, please provide the id of a canvas."):(a=document.getElementById(c))?(c=
new vizit.field.FieldRenderer(a),k.match(h)?(h=new vizit.builder.ElectricFieldBuilder(c),d=h.build(e)):k.match(f)?(h=new vizit.builder.SimpleVectorFieldBuilder(c),d=h.build(e)):alert("Unrecognized visualization type: "+k+"."),d&&(c.setRenderer(d),"undefined"!==typeof b&&c.setScale(b),"undefined"!==typeof l&&d.addStartPoints(l),c.start())):alert('Can not find canvas with id="'+c+'".')};this.process=function(e){var h;if(e)if(Array.isArray(e)){h=e.length;for(var a=0;a<h;++a)this.processConfig(e[a])}else this.processConfig(e)}}})(window.vizit.builder);
function VIZ_CONFIG_IF_EXISTS(m){"undefined"!==typeof VISUALIZATION_CONFIG&&(m=new vizit.builder.VizBuilder,m.process(VISUALIZATION_CONFIG))}"interactive"===document.readyState||"complete"===document.readyState?VIZ_CONFIG_IF_EXISTS():document.addEventListener("DOMContentLoaded",VIZ_CONFIG_IF_EXISTS);
