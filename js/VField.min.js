/*
 Copyright 2013-2014 Vizit Solutions

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
*/
window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(m){m.ensureNumber=function(e){return"number"===typeof e?e:parseFloat(e)}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(m){m.toBoolean=function(e){var k,a;a=typeof e;if("boolean"===a)k=e;else if("number"===a)k=0!==e;else if("string"===a)switch(e.trim().toLowerCase()){default:k=!0}return k}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(m){m.MotionEventHandler=function(e,k,a,c){var b,d,g,h;b=[];d=!1;h=g=null;this.findTouchByIdentifier=function(a){var c,d;for(c=0;c<b.length;c++)if(d=b[c].identifier,d===a)return c;return-1};this.handleTouchStart=function(a){var c,d,g;g=a.targetTouches;for(c=0;c<g.length;c++)d=g[c],-1===this.findTouchByIdentifier(d.identifier)&&b.push(d);if(a.preventDefault)a.preventDefault();else return!1};this.handleTouchEnd=function(a){var c,d,g;g=a.changedTouches;for(c=0;c<g.length;c++)d=this.findTouchByIdentifier(g[c].identifier),
-1!==d&&b.splice(d,1);if(a.preventDefault)a.preventDefault();else return!1};this.handleOneActiveMove=function(a){var c,d,g,h;h=a.changedTouches[0];d=b[0];null!==d?(c=h.pageX-d.pageX,d=h.pageY-d.pageY,g=e.getModelViewMatrix(),k.rotateBy(g,d/150,c/150),e.setModelViewMatrix(g),e.requestRender(),b.splice(0,1,h)):b.push(h);if(a.preventDefault)a.preventDefault();else return!1};this.handleTwoActiveMove=function(a){var d,g,h,k,q,s,w;k=b[0];s=b[1];d=s.pageX-k.pageX;g=s.pageY-k.pageY;h=Math.sqrt(d*d+g*g);w=
a.changedTouches;for(d=0;d<w.length;d++)q=w[d],g=q.identifier,k.identifier===g?(k=q,b.splice(0,1,q)):s.identifier===g&&(s=q,b.splice(1,1,q));d=s.pageX-k.pageX;g=s.pageY-k.pageY;k=Math.sqrt(d*d+g*g);e.zoomBy(-(k-h)/c);if(a.preventDefault)a.preventDefault();else return!1};this.handleTouchMove=function(a){return 1===b.length?this.handleOneActiveMove(a):2===b.length?this.handleTwoActiveMove(a):!0};this.handleMouseDown=function(a){d=!0;g=a.clientX;h=a.clientY};this.handleMouseUp=function(a){d=!1};this.handleMouseMove=
function(a){if(d){var c=a.clientX,b=a.clientY,n=c-g,r=b-h;a=e.getModelViewMatrix();k.rotateBy(a,r/30,n/30);e.setModelViewMatrix(a);e.requestRender();g=c;h=b}};this.handleMouseWheel=function(c){c=window.event||c;e.zoomBy(c.wheelDeltaY/a);if(c.preventDefault)c.preventDefault();else return!1}}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(m){m.GLUtility=function(e){var k,a;this.getGLContext=function(){!a&&(a=k.getContext("webgl",{antialias:!0})||k.getContext("experimental-webgl",{antialias:!0}))&&(a.enable(a.DEPTH_TEST),a.depthFunc(a.LESS));return a};this.clearColor=function(c,b,d,g){a.clearColor(c,b,d,g)};this.clear=function(){a.clear(a.COLOR_BUFFER_BIT)};this.compileShader=function(c,b){var d=a.createShader(b);a.shaderSource(d,c);a.compileShader(d);if(!a.getShaderParameter(d,a.COMPILE_STATUS))throw"Shader compile failed with:"+
a.getShaderInfoLog(d);return d};this.createProgram=function(c,b){var d,g,h;g=a.createProgram();h=this.compileShader(c,a.VERTEX_SHADER);d=this.compileShader(b,a.FRAGMENT_SHADER);a.attachShader(g,h);a.attachShader(g,d);a.linkProgram(g);return g};this.loadData=function(c,b){a.bindBuffer(a.ARRAY_BUFFER,c);a.bufferData(a.ARRAY_BUFFER,b,a.STATIC_DRAW)};this.createBuffer=function(c){var b=a.createBuffer();this.loadData(b,c);return b};this.createIndexBuffer=function(c){var b=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,
b);a.bufferData(a.ELEMENT_ARRAY_BUFFER,c,a.STATIC_DRAW);return b};this.getAttribLocation=function(c,b){var d;d=a.getAttribLocation(c,b);-1===d&&alert("Can not find uniform"+attribute+".");return d};this.bindBuffer=function(c,b,d,g,h,f){a.bindBuffer(a.ARRAY_BUFFER,c);a.enableVertexAttribArray(b);a.vertexAttribPointer(b,d,g,!1,h,f)};this.loadTexture=function(c,b,d){var g=a.createTexture(),h=new Image;h.onload=function(){this.onTextureLoaded(h,g,b,d)}.bind(this);h.src=c;return g};this.onTextureLoaded=
function(c,b,d,g){a.activeTexture(a.TEXTURE0+d);a.bindTexture(a.TEXTURE_2D,b);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,c);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST);a.generateMipmap(a.TEXTURE_2D);g()};this.bindTexture=function(c,b,d,g){a.activeTexture(a.TEXTURE0+d);a.bindTexture(a.TEXTURE_2D,b);a.uniform1i(g,d)};this.generateModelViewMatrix=function(a){return new Float32Array([1,0,0,0,0,1,
0,0,0,0,1,0,a,0,0,1])};this.generatePerspectiveMatrix=function(a,b,d,g){return new Float32Array([d/a,0,0,0,0,d/b,0,0,0,0,-(g+d)/(g-d),-1,0,0,-2*g*d/(g-d),0])};this.generateOrthographicMatrix=function(a,b,d,g){return new Float32Array([1/a,0,0,0,0,1/b,0,0,0,0,-2/(g-d),0,0,0,-(g+d)/(g-d),1])};this.getUniformLocation=function(c,b){var d;d=a.getUniformLocation(c,b);-1===d&&alert("Can not find uniform"+b+".");return d};this.loadUniform3f=function(a,b,d,g,h,f){b=a.getUniformLocation(b,d);-1===b?alert("Can not find uniform"+
d+"."):a.uniform3f(b,g,h,f)};this.loadUniform4f=function(c,b,d,g,h,f){c=a.getUniformLocation(c,b);-1===c?alert("Can not find uniform"+b+"."):a.uniform4f(c,d,g,h,f)};this.loadUniformMatrix3fv=function(c,b,d){c=a.getUniformLocation(c,b);-1===c?alert("Can not find uniform"+b+"."):a.uniformMatrix3fv(c,!1,d)};this.loadUniformMatrix4fv=function(c,b,d){c=a.getUniformLocation(c,b);-1===c?alert("Can not find uniform"+b+"."):a.uniformMatrix4fv(c,!1,d)};this.getXYRotationMatrix=function(a,b){Math.cos(a);Math.cos(b);
Math.sin(a);Math.sin(b)};this.rotateBy=function(a,b,d){var g,h,f=Math.cos(b),l=Math.cos(d);b=Math.sin(b);var e=Math.sin(d),k=b*e,r=l*b,q=f*e,s=f*l;d=a[0];g=a[1];h=a[2];a[0]=d*l+h*e;a[1]=d*k+g*f-h*r;a[2]=-d*q+g*b+h*s;d=a[4];g=a[5];h=a[6];a[4]=d*l+h*e;a[5]=d*k+g*f-h*r;a[6]=-d*q+g*b+h*s;d=a[8];g=a[9];h=a[10];a[8]=d*l+h*e;a[9]=d*k+g*f-h*r;a[10]=-d*q+g*b+h*s;d=a[12];g=a[13];h=a[14];a[12]=d*l+h*e;a[13]=d*k+g*f-h*r;a[14]=-d*q+g*b+h*s};this.extractRotationPart=function(a,b){b.set(a.subarray(0,3));b.set(a.subarray(4,
7),3);b.set(a.subarray(8,11),6);return b};k=e;a=this.getGLContext()}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(m){m.Color=function(e,k,a,c){var b,d,g,h;this.setRed=function(a){b=a;return this};this.getRed=function(){return b};this.setGreen=function(a){d=a;return this};this.getGreen=function(){return d};this.setBlue=function(a){g=a;return this};this.getBlue=function(){return g};this.setAlpha=function(a){h=a;return this};this.getAlpha=function(){return h};this.setRed(e).setGreen(k).setBlue(a).setAlpha(c)}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.geometry=window.vizit.geometry||{};
(function(m){m.Surface=function(e,k){var a,c,b,d,g;c=k;d=e;g=new Float32Array(3*e);a=new Uint16Array(k);b=new Float32Array(3*e);this.setNindices=function(a){c=a};this.getNindices=function(){return c};this.setNvertices=function(a){d=a};this.getNvertices=function(){return d};this.setVerticies=function(a){g=a};this.getVertices=function(){return g};this.setIndices=function(d){a=d};this.getIndices=function(){return a};this.setNormals=function(a){b=a};this.getNormals=function(){return b}};m.Shapes={SPHERE:{value:"sphere"},
SQUARE:{value:"square"},CYLINDER:{value:"cylinder"}};m.VertexRegistry=function(){var e;e={};this.registerVertices=function(k,a){if(e.hasOwnProperty(k))throw"Vertex buffers already registered for "+k+".";e[k]=a};this.hasVertices=function(k){return e.hasOwnProperty(k)};this.retrieveVertices=function(k){return e[k]}};m.vertexRegistry=new m.VertexRegistry;m.Square=function(){var e,k,a;a=m.Shapes.SQUARE;e=[-0.5,0.5,0,0.5,0.5,0,0.5,-0.5,0,-0.5,-0.5,0];k=[0,0,1];this.getNindices=function(){return 6};this.computeGeometry=
function(a,b){var d,g,h;h=a.getVertices();g=a.getNormals();d=a.getIndices();for(var f=0;12>f;f++)h[f]=b[f],g[f]=k[f%3];d[0]=0;d[1]=3;d[2]=1;d[3]=3;d[4]=2;d[5]=1;a.setNvertices(12);a.setNindices(6)};this.getVertexBuffers=function(c){var b,d;this.hasVertices(a.value)?d=this.retrieveVertices(a.value):(b=new m.Surface(4,6),d={},this.computeGeometry(b,e),d.vertices=c.createBuffer(b.getVertices()),d.normals=c.createBuffer(b.getNormals()),d.indices=c.createIndexBuffer(b.getIndices()),this.registerVertices(a.value,
d));return d}};m.Square.prototype=m.vertexRegistry;m.Cylinder=function(){var e;e=m.Shapes.CYLINDER;this.getBaseHeight=function(){return 1};this.getBaseRadius=function(){return 1};this.getShape=function(){return e};this.getNindices=function(){return 126};this.computeGeometry=function(e){var a,c,b,d,g,h,f;f=e.getVertices();d=e.getNormals();b=e.getIndices();f[0]=0;d[0]=0;f[1]=0;d[1]=0;f[2]=0.5;d[2]=1;b[0]=0;a=94;b[a]=a;a*=3;f[a]=0;d[a++]=0;f[a]=0;d[a++]=0;f[a]=-0.5;d[a]=-1;for(c=1;31>=c;c++)a=2*(c-1)*
Math.PI/30,b[c]=c,h=3*c,f[h]=1*Math.cos(a),d[h++]=0,f[h]=1*Math.sin(a),d[h++]=0,f[h]=0.5,d[h]=1;for(c=1;31>=c;c++)h=3*c,a=c+90+4,b[a]=a,a*=3,f[a]=f[h++],d[a++]=0,f[a]=f[h],d[a++]=0,f[a]=-0.5,d[a]=-1;h=3;a=285;g=96;for(c=0;30>=c;c++)b[g/3]=g/3,f[g]=f[h],d[g++]=f[h++]/1,f[g]=f[h],d[g++]=f[h++]/1,f[g]=f[h],d[g++]=f[h++]/1,b[g/3]=g/3,f[g]=f[a],d[g++]=f[a++]/1,f[g]=f[a],d[g++]=f[a++]/1,f[g]=f[a],d[g++]=f[a++]/1;e.setNvertices(378);e.setNindices(126)};this.getVertexBuffers=function(k){var a,c;this.hasVertices(e.value)?
c=this.retrieveVertices(e.value):(a=new m.Surface(126,126),c={},this.computeGeometry(a),c.vertices=k.createBuffer(a.getVertices()),c.normals=k.createBuffer(a.getNormals()),c.indices=k.createIndexBuffer(a.getIndices()),this.registerVertices(e.value,c));return c}};m.Cylinder.prototype=m.vertexRegistry;m.Sphere=function(){var e;e=m.Shapes.SPHERE;this.getIntrinsicRadius=function(){return 30};this.getShape=function(){return e};this.getNindices=function(){return 5400};this.computeGeometry=function(e,a,
c,b){var d,g,h,f,l,p,n,r,q,s,w;s=e.getVertices();n=p=0;h=e.getNormals();for(f=0;f<=c;f++)for(l=f*Math.PI/c,q=Math.sin(l),g=Math.cos(l),l=0;l<=b;l++)d=2*l*Math.PI/b,r=Math.sin(d),d=Math.cos(d),r*=q,w=g,d*=q,h[n]=r,s[n++]=a*r,h[n]=w,s[n++]=a*w,h[n]=d,s[n++]=a*d;e.setNvertices(--n);h=e.getIndices();for(f=0;f<c;f++)for(l=0;l<b;l++)a=f*(b+1)+l,n=a+b+1,h[p++]=a,h[p++]=n,h[p++]=a+1,h[p++]=n,h[p++]=n+1,h[p++]=a+1;e.setNindices(--p)};this.getVertexBuffers=function(k){var a,c;this.hasVertices(e.value)?c=this.retrieveVertices(e.value):
(a=new m.Surface(961,5400),c={},this.computeGeometry(a,30,30,30),c.vertices=k.createBuffer(a.getVertices()),c.normals=k.createBuffer(a.getNormals()),c.indices=k.createIndexBuffer(a.getIndices()),this.registerVertices(e.value,c));return c}};m.Sphere.prototype=m.vertexRegistry})(window.vizit.geometry);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.SurfaceRenderer=function(e){var k,a,c,b,d,g,h,f,l,p,n,r,q;this.createProgram=function(b){b=g.createProgram("attribute vec3 normal;attribute vec3 position;uniform   vec3 ambientLighting;uniform   vec3 directionalLighting;uniform   vec3 directionalColor;uniform   mat4 modelViewMatrix;uniform   mat4 globalModelViewMatrix;uniform   mat3 normalMatrix;uniform   mat4 projectionMatrix;varying   vec3 lighting;void main(void){  gl_Position = projectionMatrix * globalModelViewMatrix * modelViewMatrix * vec4(position, 1.0);  vec3  transformedNormal         = normalMatrix * normal;  float directionalLightWeighting = max(dot(transformedNormal, directionalLighting), 0.0);  lighting                        = ambientLighting + directionalColor * directionalLightWeighting;}","precision mediump float;uniform vec4 surfaceColor;varying vec3 lighting;void main(void){  gl_FragColor = vec4(surfaceColor.rgb * lighting, surfaceColor.a);}");
k=g.getUniformLocation(b,"ambientLighting");a=g.getUniformLocation(b,"directionalLighting");c=g.getUniformLocation(b,"directionalColor");h=g.getUniformLocation(b,"modelViewMatrix");d=g.getUniformLocation(b,"globalModelViewMatrix");f=g.getAttribLocation(b,"normal");l=g.getUniformLocation(b,"normalMatrix");p=g.getAttribLocation(b,"position");r=g.getUniformLocation(b,"projectionMatrix");q=g.getUniformLocation(b,"surfaceColor");return b};this.getAmbientLightingHandle=function(){return k};this.getDirectionalLightingHandle=
function(){return a};this.getDirectionalColorHandle=function(){return c};this.getModelViewMatrixHandle=function(){return h};this.getGlobalModelViewMatrixHandle=function(){return d};this.getNormalHandle=function(){return f};this.getNormalMatrixHandle=function(){return l};this.getPositionHandle=function(){return p};this.getProjectionMatrixHandle=function(){return r};this.getSurfaceColorHandle=function(){return q};this.render=function(f,h,e,q){var p;p=q.length;if(0<p)for(b.useProgram(n),b.uniformMatrix4fv(d,
!1,h),b.uniformMatrix3fv(l,!1,e),b.uniformMatrix4fv(r,!1,f),b.uniform3f(k,0.3,0.3,0.3),b.uniform3f(a,1,1,1),b.uniform3f(c,0.4,0.4,0.4),f=0;f<p;f++)q[f].render(g,this)};g=e;b=g.getGLContext();n=this.createProgram()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(m){m.IndexedVertices=function(e,k){var a,c,b,d;this.setNindices=function(a){c=a};this.getNindices=function(){return c};this.setNvertices=function(a){b=a};this.getNvertices=function(){return b};this.setVerticies=function(a){d=a};this.getVertices=function(){return d};this.setVerticies=function(a){d=a};this.getVertices=function(){return d};this.pushVertex=function(a){d[b++]=a};this.setIndices=function(d){a=d};this.getIndices=function(){return a};this.pushIndex=function(d){a[c++]=d};b=c=0;d=
new Float32Array(3*e);a=new Uint16Array(k)}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};(function(m){m.VectorFunction=function(e,k){var a,c;this.setModified=function(b){a=b};this.isModified=function(){return a};this.setName=function(a){c=a};this.getName=function(){return c};this.shouldStop=function(a,d,c,h){return 0>a*Q&&4>r2};this.getField=new Function(e,k)}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(m){m.CombinedVectorFunctions=function(){var e,k;this.addFunction=function(a){k=e.push(a);return this};for(var a=0;a<arguments.length;a++)this.addFunction(arguments[a]);this.getNfunctions=function(){return k};this.getFunctions=function(){return e};this.isModified=function(){var c;c=!1;for(a=0;a<k&&!c;a++)c=c||e[a].isModified();return c};this.setModified=function(c){for(a=0;a<k;a++)e[a].setModified(c)};this.getStartPoints=function(){var a,b=0,d=1.57079632679/(ncharges+1),g,h=[];for(a=0;a<
k;a++)g=e[a],h=h.concat(g.getStartPoints(b,6)),b+=d;return h};this.getField=function(a,b,d){for(var g,h=[0,0,0],f=0;f<k;f++)g=e[f].getField(a,b,d),h[0]+=g[0],h[1]+=g[1],h[2]+=g[2];return h};this.shouldStop=function(a,b,d,g){var h;h=!1;for(var f=0;f<ncharges&!h;f++)h=e[f].shouldStop(a,b,d,g);return h};k=0;e=[]}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(m){m.LineRenderer=function(e){var k,a,c,b,d,g,h;this.createProgram=function(){var a;a=c.createProgram("attribute vec3 position;uniform   mat4 modelViewMatrix;uniform   mat4 projectionMatrix;void main(){    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1);}","precision mediump float;uniform   vec4 color;void main(){    gl_FragColor = color;}");k=c.getUniformLocation(a,"color");b=c.getAttribLocation(a,"position");g=c.getUniformLocation(a,"modelViewMatrix");h=c.getUniformLocation(a,
"projectionMatrix");return a};this.drawIndexedLines=function(f,l,e,n){a.useProgram(d);a.lineWidth(1);a.uniform4fv(k,e);a.uniformMatrix4fv(g,!1,l);a.uniformMatrix4fv(h,!1,f);l=n.length;for(e=0;e<l;e++)f=n[e],c.bindBuffer(f.vertices,b,3,a.FLOAT,12,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,f.indices),a.drawElements(a.LINES,f.nindices,a.UNSIGNED_SHORT,0)};c=e;a=c.getGLContext();d=this.createProgram()}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(m){m.SimpleVectorField=function(e,k){var a,c,b,d,g,h,f,l,p,n,r,q,s,w;this.setArrowHeadWidth=function(a){c=a;return this};this.getArrowHeadWidth=function(){return c};this.setArrowHeadSize=function(d){a=d;return this};this.getArrowHeadSize=function(){return a};this.setColor=function(a){b=a;return this};this.getColor=function(){return b};this.setGlUtility=function(a){f=a;return this};this.getGlUtility=function(){return f};this.setMaxVectors=function(a){p=a;return this};this.getMaxVectors=function(){return p};
this.setModelViewMatrix=function(a){n=a;return this};this.getModelViewMatrix=function(){return n};this.setProjectionMatrix=function(a){q=a;return this};this.addStartPoints=function(a){d=d.concat(a);return this};this.getStartPoints=function(){return d};this.setupVectorField=function(){var a,b;a="function"===typeof g.getStartPoints?d.concat(g.getStartPoints(0,2)):d;h.setStartPoints(a);a={};b=h.generateField();a.vertices=f.createBuffer(b.getVertices());a.indices=f.createIndexBuffer(b.getIndices());a.nindices=
b.getNindices();l[0]=a;return l};this.render=function(){w&&(g.isModified()&&(l=this.setupVectorField()),f.clear(),r.drawIndexedLines(q,n,b,l),g.setModified(!1))};this.start=function(){r=new vizit.vectorfield.LineRenderer(f);h=new vizit.vectorfield.VectorFieldGenerator(g,p,a,c,s);w=!0;this.render()};c=0.5;a=0.3;g=e;l=[];b=new Float32Array([0.8,0.3,0.3,1]);p=5;s="undefined"===typeof k?1:k;d=[];w=!1}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(m){m.CountdownLatch=function(e,k){var a=e;this.countDown=function(){a--;0>=a&&k()}}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargeGenerator=function(e){var k,a,c,b,d,g,h,f;this.setCharges=function(d){a=d;k*a.getCharges().length>c.byteLength&&(c=new ArrayBuffer(k*a.getCharges().length))};this.getCharges=function(){return a};this.getChargesArray=function(){return c};this.getNcharges=function(){return b};this.generate=function(){var l,e,k,r,q,s;s=a.getCharges();b=s.length;q=new Float32Array(c);e=new Uint8Array(c);for(var w=0;w<b;w++)l=s[w],r=l.getPosition(),k=0+5*w,q[k++]=r[0],q[k++]=r[1],q[k++]=r[2],q[k++]=
h,k=16+20*w,l=0<l.getCharge()?f:0>l.getCharge()?d:g,e[k++]=l[0],e[k++]=l[1],e[k++]=l[2],e[k++]=l[3];return c};a=e;k=3*Float32Array.BYTES_PER_ELEMENT+Float32Array.BYTES_PER_ELEMENT+4*Uint8Array.BYTES_PER_ELEMENT;c=new ArrayBuffer(k*a.getCharges().length);h=16;d=[204,13,13,255];f=[13,13,204,255];g=[13,13,13,51]}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargeRenderer=function(e){var k,a,c,b,d,g,h,f;this.createProgram=function(){var g;g=c.createProgram("precision highp float;attribute vec3  position;attribute vec4  color;attribute float size;uniform   mat4  modelViewMatrix;uniform   mat4  projectionMatrix;varying vec4 vColor;void main(){    gl_Position  = projectionMatrix * modelViewMatrix * vec4(position, 1);    gl_PointSize = size;    vColor       = color;}","precision lowp float;varying vec4 vColor; void main() {   float dist = distance( vec2(0.5,0.5), gl_PointCoord );   if ( dist > 0.5 )     discard;   gl_FragColor = vColor; }");
k=c.getAttribLocation(g,"color");b=c.getUniformLocation(g,"modelViewMatrix");d=c.getAttribLocation(g,"position");h=c.getUniformLocation(g,"projectionMatrix");f=c.getAttribLocation(g,"size");a.enableVertexAttribArray(k);a.enableVertexAttribArray(d);a.enableVertexAttribArray(f);return g};this.render=function(c,e,n,r){a.useProgram(g);a.uniformMatrix4fv(b,!1,e);a.uniformMatrix4fv(h,!1,c);a.bindBuffer(a.ARRAY_BUFFER,n);a.vertexAttribPointer(d,3,a.FLOAT,!1,20,0);a.vertexAttribPointer(f,1,a.FLOAT,!1,20,
12);a.vertexAttribPointer(k,4,a.UNSIGNED_BYTE,!0,20,16);a.drawArrays(a.POINTS,0,r.getNcharges())};c=e;a=c.getGLContext();g=this.createProgram()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.FieldLineVBO=function(e,k){this.disable=function(){this.enabled=!1};this.isEnabled=function(){return this.enabled};this.reload=function(a,c){a.loadData(this.fieldLineBufferHandle,c.getPoints());this.npoints=c.getNpoints();a.loadData(this.fieldDirectionBufferHandle,c.getArrows());this.narrows=c.getNarrows();this.enabled=!0};this.fieldLineBufferHandle=e.createBuffer(k.getPoints());this.npoints=k.getNpoints();this.fieldDirectionBufferHandle=e.createBuffer(k.getArrows());this.narrows=k.getNarrows();
this.enabled=!0}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.FieldLine=function(e){var k,a,c,b,d,g;this.setMaxPoints=function(b){b!==e&&(e=b,d=new Float32Array(3*e),a=new Float32Array(e));return this};this.getMaxPoints=function(){return e};this.pushPoint=function(a,f,c){d[g++]=a;d[g++]=f;d[g++]=c;b++};this.getPoints=function(){return d};this.getNpoints=function(){return b};this.pushArrow=function(d,b,g,e,n,r,q,s,w){a[k++]=d;a[k++]=b;a[k++]=g;a[k++]=e;a[k++]=n;a[k++]=r;a[k++]=e;a[k++]=n;a[k++]=r;a[k++]=q;a[k++]=s;a[k++]=w;c++};this.getArrows=
function(){return a};this.getNarrows=function(){return c};this.reset=function(){g=b=c=k=0};d=new Float32Array(3*e);a=new Float32Array(e);this.reset()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.FieldLineGenerator=function(e,k,a,c,b){var d,g,h,f,l,p;this.setCharges=function(a){f=a;return this};this.getCharges=function(){return f};this.getArrows=function(){return arrows};this.setMaxPoints=function(a){a>maxpoints&&(l=new vizit.electricfield.FieldLine(p));p=a;return this};this.getMaxPoints=function(){return p};this.setArrowHeadSize=function(a){d=a;return this};this.getArrowHeadSize=function(){return d};this.setArrowSpacing=function(a){g=a;return this};this.getArrowSpacing=function(){return g};
this.setDs=function(a){h=a;return this};this.getDs=function(){return h};this.drawArrow=function(a,d,b,c,f,g,h){var e,l,k,p,m;e=c[0]/f;l=c[1]/f;k=c[2]/f;0!==k?(p=f=1,c=-(c[0]+c[1])/c[2]):(0!==l?(f=1,p=-(c[0]+c[2])/c[1]):(f=-(c[1]+c[2])/c[0],p=1),c=1);m=g/Math.sqrt(f*f+p*p+c*c);f*=m;p*=m;c*=m;e*=g;l*=g;g*=k;h.pushArrow(a-e+f,d-l+p,b-g+c,a,d,b,a-e-f,d-l-p,b-g-c)};this.generate=function(a,b,c,e){var k,t,m,v;k=0;t=!1;v=c;l.reset();for(c=0;c<p&&!t;c++){l.pushPoint(a,b,v);m=f.getField(a,b,v);t=Math.sqrt(m[0]*
m[0]+m[1]*m[1]+m[2]*m[2]);if(0===t)break;a+=e*m[0]/t*h;b+=e*m[1]/t*h;v+=e*m[2]/t*h;k+=h;k>g&&(k=0,this.drawArrow(a,b,v,m,t,d,l));t=f.shouldStop(e,a,b,v)}return l};d=c;g=b;f=e;h=a;p=k;l=new vizit.electricfield.FieldLine(p)}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.FieldLineRenderer=function(e){var k,a,c,b,d,g;this.createProgram=function(d){d=a.createProgram("attribute vec3 position;uniform   mat4 modelViewMatrix;uniform   mat4 projectionMatrix;void main(){  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}","precision mediump float;void main(){  gl_FragColor = vec4(0.8,0.3,0.3,1.0);}");c=a.getUniformLocation(d,"modelViewMatrix");b=a.getAttribLocation(d,"position");g=a.getUniformLocation(d,"projectionMatrix");return d};
this.render=function(h,f,e,p){e=p.length;if(0<e)for(k.useProgram(d),k.lineWidth(1),k.uniformMatrix4fv(c,!1,f),k.uniformMatrix4fv(g,!1,h),f=0;f<e;f++){h=p[f];if(!h.isEnabled())break;a.bindBuffer(h.fieldLineBufferHandle,b,3,k.FLOAT,12,0);k.drawArrays(k.LINE_STRIP,0,h.npoints);a.bindBuffer(h.fieldDirectionBufferHandle,b,3,k.FLOAT,12,0);k.drawArrays(k.LINES,0,h.narrows)}};a=e;k=a.getGLContext();d=this.createProgram()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(m){m.Cylinder=function(){var e,k;this.setColor=function(a){k=a};this.getColor=function(){return k};this.getCylinderModelView=function(a,c,b,d,g,h,f){var e,k,n;n=Math.sin(f);f=Math.cos(f);k=Math.sin(h);h=Math.cos(h);e=new Float32Array(16);e[0]=g*h*f;e[1]=g*f*k;e[2]=-g*n;e[3]=0;e[4]=-g*k;e[5]=g*h;e[6]=0;e[7]=0;e[8]=d*h*n;e[9]=d*k*n;e[10]=d*f;e[11]=0;e[12]=a;e[13]=c;e[14]=b;e[15]=1;return e};this.transformPoints=function(a,c,b,d){var g,h,f;e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;e[3]=a[3];e[4]=
a[4]*b;e[5]=a[5]*b;e[6]=a[6]*b;e[7]=a[7];e[8]=a[8]*c;e[9]=a[9]*c;e[10]=a[10]*c;e[11]=a[11];e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];c=0;for(a=d.length;c<a;c++)b=d[c],g=b[0],h=b[1],f=b[2],b[0]=e[0]*g+e[4]*h+e[8]*f+e[12],b[1]=e[1]*g+e[5]*h+e[9]*f+e[13],b[2]=e[2]*g+e[6]*h+e[10]*f+e[14];return d};this.setupBuffers=function(a,c,b,d,g){var e;e=a.getGLContext();a.bindBuffer(b,c.getPositionHandle(),3,e.FLOAT,0,0);a.bindBuffer(d,c.getNormalHandle(),3,e.FLOAT,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,
g)};this.drawCap=function(a,c,b){a.drawElements(a.TRIANGLE_FAN,c,a.UNSIGNED_SHORT,2*b)};this.drawSide=function(a,c,b){a.drawElements(a.TRIANGLE_STRIP,c,a.UNSIGNED_SHORT,2*b)};this.drawCylinder=function(a,c,b,d,g){a=a.getGLContext();a.uniformMatrix4fv(c.getModelViewMatrixHandle(),!1,b);g&&this.drawCap(a,d+2,0);this.drawSide(a,2*d+2,d+2);g&&this.drawCap(a,d+2,3*d+4)};this.fullRender=function(a,c,b,d,g,h,f){var l,p,n,r;l=a.getGLContext();n=this.getBaseRadius();r=this.getVertexBuffers(a);l.uniform4f(c.getSurfaceColorHandle(),
k.getRed(),k.getGreen(),k.getBlue(),k.getAlpha());p=(this.getNindices()-6)/4;this.setupBuffers(a,c,r.vertices,r.normals,r.indices);e[3]=b[3];e[7]=b[7];e[8]=b[8]*d;e[9]=b[9]*d;e[10]=b[10]*d;e[11]=b[11];e[12]=b[12];e[13]=b[13];e[14]=b[14];e[15]=b[15];l.cullFace(l.FRONT);for(d=h;d>=g;d--)r=d/n,e[0]=b[0]*r,e[1]=b[1]*r,e[2]=b[2]*r,e[4]=b[4]*r,e[5]=b[5]*r,e[6]=b[6]*r,this.drawCylinder(a,c,e,p,f);l.cullFace(l.BACK);for(d=g;d<=h;d++)r=d/n,e[0]=b[0]*r,e[1]=b[1]*r,e[2]=b[2]*r,e[4]=b[4]*r,e[5]=b[5]*r,e[6]=b[6]*
r,this.drawCylinder(a,c,e,p,f)};this.translateBounds=function(a,c,b,d,g,e,f){var l,k,n;l=(c+g)/2;k=(b+e)/2;n=(d+f)/2;c-=l;b-=k;d-=n;g-=l;e-=k;f-=n;a.setTx(l).setTy(k).setTz(n).setX0(c).setY0(b).setZ0(d).setX1(g).setY1(e).setZ1(f)};this.sign=function(a){return 0>a?-1:1};this.zAxisRotation=function(a,c,b,d,g){var e;e=Math.atan2(g-b,d-c);c=-this.sign(d)*Math.sqrt(c*c+b*b);b=0;d=-c;g=0;a.setX0(c).setY0(b).setX1(d).setY1(g).setPhi(e)};this.yAxisRotation=function(a,c,b,d,g,e,f){b=Math.sqrt(c*c+b*b+d*d);
e=Math.acos(f/b);d=this.sign(f);f=d*b;g=c=0;a.setZ0(-d*b).setZ1(f).setX0(c).setX1(g).setTheta(e)};this.scale=function(a,c,b){var d;d=this.sign(b);c=b-c;a.setZ0(0.5*-d).setZ1(0.5*d).setHeight(c)};e=new Float32Array(16)};m.Cylinder.prototype=new vizit.geometry.Cylinder})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.GaussianCylinder=function(e,k,a,c,b,d,g,h){var f,l,p,n,r,q,s,m,t,u,v;this.setEnabled=function(a){l=vizit.utility.toBoolean(a)};this.isEnabled=function(){return l};this.setX=function(a){t=a;n[12]=t;return this};this.getX=function(){return t};this.setY=function(a){u=a;n[13]=u;return this};this.getY=function(){return u};this.setZ=function(a){v=a;n[14]=v;return this};this.getZ=function(){return v};this.setOrigin=function(a){this.setX(a[0]);this.setY(a[1]);return this.setZ(a[2])};this.getOrigin=
function(){return[t,u,v]};this.setR=function(a){s=a;return this};this.getR=function(){return s};this.setHeight=function(a){p=a;return this};this.getHeight=function(){return p};this.setTheta=function(a){m=a;return this};this.getTheta=function(){return m};this.setPhi=function(a){q=a;return this};this.getPhi=function(){return q};this.setName=function(a){r=a};this.getName=function(){return r};this.render=function(a,d){l&&this.fullRender(a,d,n,p,s,s,!0)};f=new vizit.utility.Color(0.5,0.5,0.5,0.5);l=!0;
p=c;r=h;q=d;s=b;m=g;t=e;u=k;v=a;this.setColor(f);n=this.getCylinderModelView(t,u,v,this.getBaseHeight(),this.getBaseRadius(),q,m)};m.GaussianCylinder.prototype=new vizit.utility.Cylinder})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.GaussianSphere=function(e,k,a,c,b){var d,g,h,f,l,p,n,r;this.setColor=function(a){d=a};this.getColor=function(){return d};this.setEnabled=function(a){g=vizit.utility.toBoolean(a)};this.isEnabled=function(){return g};this.setX=function(a){p=a;return this};this.getX=function(){return p};this.setY=function(a){n=a;return this};this.getY=function(){return n};this.setZ=function(a){r=a;return this};this.getZ=function(){return r};this.setR=function(a){l=a;return this};this.getR=function(){return l};
this.setName=function(a){f=a};this.getName=function(){return f};this.getModelView=function(a){"undefined"===typeof a&&(a=1);"undefined"===typeof h?(h=new Float32Array(16),h[0]=a,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=a,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=a,h[11]=0,h[12]=p,h[13]=n,h[14]=r,h[15]=1):(h[0]=a,h[5]=a,h[10]=a);return h};this.drawFullSurface=function(a,d,b,c,f,g){var e;e=a.getGLContext();a.bindBuffer(b,d.getPositionHandle(),3,e.FLOAT,0,0);a.bindBuffer(c,d.getNormalHandle(),3,e.FLOAT,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,
f);e.drawElements(e.TRIANGLES,g,e.UNSIGNED_SHORT,0)};this.render=function(a,b){if(g){var c,f,e;c=a.getGLContext();f=this.getIntrinsicRadius();e=this.getVertexBuffers(a);c.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView(l/f));c.uniform4f(b.getSurfaceColorHandle(),d.getRed(),d.getGreen(),d.getBlue(),d.getAlpha());c.cullFace(c.FRONT);this.drawFullSurface(a,b,e.vertices,e.normals,e.indices,this.getNindices());c.cullFace(c.BACK);this.drawFullSurface(a,b,e.vertices,e.normals,e.indices,
this.getNindices())}};d=new vizit.utility.Color(0.5,0.5,0.5,0.5);g=!0;f=b;l=c;p=e;n=k;r=a};m.GaussianSphere.prototype=new vizit.geometry.Sphere})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargedCylinder=function(e,k,a,c,b,d,g,h,f,l,p,n){var r,q,s,m,t,u,v,y,C,B,G,I,F,K,H,A,E,x,z,D,L,J,M,N;this.setHeight=function(a){r=a;s=!0};this.getHeight=function(){return r};this.setTx=function(a){I=a;s=!0;return this};this.getTx=function(){return I};this.setTy=function(a){F=a;s=!0;return this};this.getTy=function(){return F};this.setTz=function(a){K=a;s=!0;return this};this.getTz=function(){return K};this.setX0=function(a){H=a;s=!0;return this};this.getX0=function(){return H};this.setY0=
function(a){A=a;s=!0;return this};this.getY0=function(){return A};this.setZ0=function(a){E=a;s=!0;return this};this.getZ0=function(){return E};this.setX1=function(a){x=a;s=!0;return this};this.getX1=function(){return x};this.setY1=function(a){z=a;s=!0;return this};this.getY1=function(){return z};this.setZ1=function(a){D=a;s=!0;return this};this.getZ1=function(){return D};this.setR0=function(a){B=a;s=!0;return this};this.getR0=function(){return B};this.setR1=function(a){G=a;s=!0;return this};this.getR1=
function(){return G};this.setPhi=function(a){u=a;s=!0;return this};this.getPhi=function(){return u};this.setTheta=function(a){v=a;s=!0;return this};this.getTheta=function(){return v};this.setNfieldLines=function(a){t=a;s=!0;return this};this.getNfieldLines=function(){return t};this.setModified=function(a){s=a;return this};this.isModified=function(){return s};this.setName=function(a){m=a;return this};this.getName=function(){return m};this.getStartPoints=function(){var a,d,b,c,f,g,e;e=[];if(0!==C+t){g=
this.sign(y);d=Math.max(2,Math.round(Math.abs(y*Math.PI*(G*G-B*B)*C*r)))+t;b=(B+1)/G;c=0.707106781*(B+1)/G;f=-0.5;a=1/(d-1);for(var h=0;h<d;h++)e.push([b,0,f,g]),e.push([-b,0,f,g]),e.push([0,b,f,g]),e.push([0,-b,f,g]),e.push([c,c,f,g]),e.push([c,-c,f,g]),e.push([-c,-c,f,g]),e.push([-c,c,f,g]),f+=a}return this.transformPoints(q,r/this.getBaseHeight(),G/this.getBaseRadius(),e)};this.getNormal=function(a,d,b){var c,f,g,e;c={};f=-((H-a)*L+(A-d)*J+(E-b)*M)/(N*N);g=H+f*L;e=A+f*J;f=E+f*M;c.x=a-g;c.y=d-e;
c.z=b-f;return c};this.getField=function(a,d,b){var c;c=Array(3);d=this.getNormal(a,d,b);b=Math.sqrt(d.x*d.x+d.y*d.y+d.z*d.z);a=2*(b<B?0:b<G?Math.PI*(b*b-B*B)*y:Math.PI*(G*G-B*B)*y)/b;c[0]=a*d.x/b;c[1]=a*d.y/b;c[2]=a*d.z/b;return c};this.render=function(a,d){this.fullRender(a,d,q,r/this.getBaseHeight(),B/this.getBaseRadius(),G/this.getBaseRadius(),!1)};s=!0;m=n;y="undefined"===typeof f?0:f;C="undefined"===typeof l?0:l;t="undefined"===typeof p?0:p;B=g;G=h;H=e;A=k;E=a;x=c;z=b;D=d;g=0<y?new vizit.utility.Color(0.05,
0.05,0.8,0.3):0>y?new vizit.utility.Color(0.8,0.05,0.05,0.3):new vizit.utility.Color(0.5,0.5,0.5,0.2);this.setColor(g);this.translateBounds(this,H,A,E,x,z,D);this.zAxisRotation(this,H,A,x,z);this.yAxisRotation(this,H,A,E,x,z,D);this.scale(this,E,D);H=e;A=k;E=a;x=c;z=b;D=d;q=this.getCylinderModelView(I,F,K,this.getBaseHeight(),this.getBaseRadius(),u,v);L=x-H;J=z-A;M=D-E;N=Math.sqrt(L*L+J*J+M*M)};m.ChargedCylinder.prototype=new vizit.utility.Cylinder})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargedLine=function(e,k,a,c,b,d,g,h,f,l){var p,n,r,q,s,m,t,u,v,y,C,B,G,I,F,K,H,A,E,x,z,D,L,J;this.setHeight=function(a){r=a;s=!0};this.getHeight=function(){return r};this.setTx=function(a){B=a;s=!0;return this};this.getTx=function(){return B};this.setTy=function(a){G=a;return this};this.getTy=function(){return G};this.setTz=function(a){I=a;s=!0;return this};this.getTz=function(){return I};this.setX0=function(a){F=a;s=!0;return this};this.getX0=function(){return F};this.setY0=function(a){K=
a;s=!0;return this};this.getY0=function(){return K};this.setZ0=function(a){H=a;s=!0;return this};this.getZ0=function(){return H};this.setX1=function(a){A=a;s=!0;return this};this.getX1=function(){return A};this.setY1=function(a){E=a;s=!0;return this};this.getY1=function(){return E};this.setZ1=function(a){x=a;s=!0;return this};this.getZ1=function(){return x};this.setR0=function(a){y=a;s=!0;return this};this.getR0=function(){return y};this.setR1=function(a){C=a;s=!0;return this};this.getR1=function(){return C};
this.setPhi=function(a){u=a;s=!0;return this};this.getPhi=function(){return u};this.setTheta=function(a){v=a;s=!0;return this};this.getTheta=function(){return v};this.setNfieldLines=function(a){t=a;s=!0;return this};this.getNfieldLines=function(){return t};this.setModified=function(a){s=a;return this};this.isModified=function(){return s};this.setName=function(a){m=a;return this};this.getName=function(){return m};this.getStartPoints=function(){var a,d,b,c,f;f=[];if(0!==n+t){c=this.sign(p);d=Math.max(2,
Math.round(Math.abs(p*n*r)))+t;b=-0.5;a=1/(d-1);for(var g=0;g<d;g++)f.push([1,0,b,c]),f.push([-1,0,b,c]),f.push([0,1,b,c]),f.push([0,-1,b,c]),f.push([0.707106781,0.707106781,b,c]),f.push([0.707106781,-0.707106781,b,c]),f.push([-0.707106781,-0.707106781,b,c]),f.push([-0.707106781,0.707106781,b,c]),b+=a}return this.transformPoints(q,r/this.getBaseHeight(),(y+1)/this.getBaseRadius(),f)};this.getNormal=function(a,d,b){var c,f,g,e;c={};f=-((F-a)*z+(K-d)*D+(H-b)*L)/(J*J);g=F+f*z;e=K+f*D;f=H+f*L;c.x=a-g;
c.y=d-e;c.z=b-f;return c};this.getField=function(a,d,b){var c;b=this.getNormal(a,d,b);c=Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z);a=Array(3);d=2*p/c;a[0]=d*b.x/c;a[1]=d*b.y/c;a[2]=d*b.z/c;return a};this.render=function(a,b){this.fullRender(a,b,q,r,y,C,!1)};p="undefined"===typeof g?0:g;g=0<p?new vizit.utility.Color(0.05,0.05,0.8,0.8):0>p?new vizit.utility.Color(0.8,0.05,0.05,0.8):new vizit.utility.Color(0.5,0.5,0.5,0.8);this.setColor(g);s=!0;m=l;n="undefined"===typeof h?0:h;t="undefined"===typeof f?0:f;y=
0;C=3;F=e;K=k;H=a;A=c;E=b;x=d;this.translateBounds(this,F,K,H,A,E,x);this.zAxisRotation(this,F,K,A,E);this.yAxisRotation(this,F,K,H,A,E,x);this.scale(this,H,x);F=e;K=k;H=a;A=c;E=b;x=d;q=this.getCylinderModelView(B,G,I,this.getBaseHeight(),this.getBaseRadius(),u,v);z=A-F;D=E-K;L=x-H;J=Math.sqrt(z*z+D*D+L*L)};m.ChargedLine.prototype=new vizit.utility.Cylinder})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargedPlane=function(e,k,a,c,b,d,g,h,f,l,p,n,r,q,s,m){var t,u,v,y,C,B,G,I,F,K,H,A,E,x,z,D,L,J,M,N,O,P,S,R;this.setNfieldLines=function(a){H=a;F=!0;return this};this.getNfieldLines=function(){return H};this.setModified=function(a){F=a;return this};this.isModified=function(){return F};this.setName=function(a){K=a;return this};this.getName=function(){return K};this.calculateNormal=function(a){var b;b=Array(3);b[0]=(a[4]-a[1])*(a[11]-a[2])-(a[5]-a[2])*(a[10]-a[1]);b[1]=(a[5]-a[2])*(a[9]-
a[0])-(a[3]-a[0])*(a[11]-a[2]);b[2]=(a[3]-a[0])*(a[10]-a[1])-(a[4]-a[1])*(a[9]-a[0]);a=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]/=a;b[1]/=a;b[2]/=a;return b};this.adjustStartPoints=function(a){var b,d,c,f,g;b=a.length;for(var e=0;e<b;e++)d=a[e],c=d[0],f=d[1],g=d[2],d[0]=N+G*(J*c*C+g*x)+D*(-M*f*B+z*(-J*c*x+g*C)),d[1]=O+G*(M*f*B+z*(J*c*x-g*C))+D*(J*c*C+g*x),d[2]=P+M*f*z+B*(-J*c*x+g*C);return a};this.getStartPoints=function(){var a,b,d,c,f,g,e;b=Math.abs(L*E)+H/Math.abs(J*M);f=[];if(0<b)for(a=Math.sqrt(1/
b),b=a/Math.abs(J),a/=Math.abs(M),d=!1,c=0<L?1:-1,g=Math.min(-0.5+b/2,0.5),e=Math.min(-0.5+a/2,0.5);!d;)f.push([g,e,0.4,c]),f.push([g,e,-0.4,c]),e+=a,0.5<e?(e=0.5-(e-0.5),g+=b,a=-a):-0.5>e&&(e=-0.5-(e- -0.5),g+=b,a=-a),d=0.5<g;return this.adjustStartPoints(f)};this.getField=function(a,b,d){var c;c=Array(3);a=(a-y[0])*A[0]+(b-y[1])*A[1]+(d-y[2])*A[2];b=S*L;0===a&&(c[0]=0,c[1]=0,c[2]=0);0<a?(c[0]=b*A[0],c[1]=b*A[1],c[2]=b*A[2]):(c[0]=-b*A[0],c[1]=-b*A[1],c[2]=-b*A[2]);return c};this.translateBoundingBox=
function(b){N=(e+g)/2;O=(k+h)/2;P=(a+f)/2;b[0]-=N;b[1]-=O;b[2]-=P;b[3]-=N;b[4]-=O;b[5]-=P;b[6]-=N;b[7]-=O;b[8]-=P;b[9]-=N;b[10]-=O;b[11]-=P;return b};this.zAxisRotation=function(a){var d,c;d=a[3]-a[0];c=a[0]-a[9];0===d||0===c?(v=0,R=0===d&&0===c?0===a[4]-a[1]?1:2:0===d?1:2):(d=(b-k)/d,c=(h-b)/c,Math.abs(d)<Math.abs(c)?(v=Math.atan(d),R=1):(v=Math.atan(c),R=2));G=Math.cos(v);D=Math.sin(v);for(var f=0;4>f;f++)c=G*a[3*f]-D*a[3*f+1],d=D*a[3*f]+G*a[3*f+1],a[3*f]=c,a[3*f+1]=d;return a};this.xAxisRotation=
function(a,b){var d,c;1===b?(d=a[1]-a[10],c=a[2]-a[11]):(d=a[4]-a[1],c=a[5]-a[2]);z=u=0;B=1;if(0!==c&&0!==d){u=Math.atan(c/d);z=Math.sin(u);B=Math.cos(u);for(var f=0;4>f;f++)d=B*a[3*f+1]-z*a[3*f+2],c=z*a[3*f+1]+B*a[3*f+2],a[3*f+1]=d,a[3*f+2]=c}return a};this.yAxisRotation=function(a,b){var d,c;1===b?(d=a[0]-a[9],c=a[2]-a[11]):(d=a[3]-a[0],c=a[5]-a[2]);x=t=0;C=1;if(0!==c){0!==d?(t=Math.atan(c/d),x=Math.sin(t),C=Math.cos(t)):(t=1.5707963267948966,x=1,C=0);for(var f=0;4>f;f++)d=C*a[3*f]+x*a[3*f+2],c=
-x*a[3*f]+C*a[3*f+2],a[3*f]=d,a[3*f+2]=c}return a};this.scaleBoundingbox=function(a,b){1===b?(J=a[0]-a[9],M=a[4]-a[1]):(J=a[3]-a[0],M=a[1]-a[10]);for(var d=0;4>d;d++)0!==J&&(a[3*d]/=J),0!==M&&(a[3*d+1]/=M);return a};this.getModelView=function(){return I};this.drawFullSurface=function(a,b,d,c,f,g){var e;e=a.getGLContext();a.bindBuffer(d,b.getPositionHandle(),3,e.FLOAT,0,0);a.bindBuffer(c,b.getNormalHandle(),3,e.FLOAT,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f);e.drawElements(e.TRIANGLES,g,e.UNSIGNED_SHORT,
0)};this.render=function(a,b){var d,c,f;d=a.getGLContext();f=this.getVertexBuffers(a);0<L?d.uniform4f(b.getSurfaceColorHandle(),0.05,0.05,0.8,0.4):0>L?d.uniform4f(b.getSurfaceColorHandle(),0.8,0.05,0.05,0.4):d.uniform4f(b.getSurfaceColorHandle(),0.5,0.5,0.5,0.2);c=this.getNindices();d.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView());d.disable(d.CULL_FACE);this.drawFullSurface(a,b,f.vertices,f.normals,f.indices,c);d.enable(d.CULL_FACE)};F=!0;K=m;S=6.283185307179586;L="undefined"===
typeof r?0:r;E="undefined"===typeof q?0:q;H="undefined"===typeof s?0:s;y=[e,k,a,c,b,d,g,h,f,l,p,n];c=y.slice(0);A=this.calculateNormal(y);c=this.translateBoundingBox(c);c=this.zAxisRotation(c);c=this.xAxisRotation(c,R);c=this.yAxisRotation(c,R);c=this.scaleBoundingbox(c,R);I=new Float32Array(16);C=Math.cos(-t);B=Math.cos(-u);G=Math.cos(-v);x=Math.sin(-t);z=Math.sin(-u);D=Math.sin(-v);I[0]=J*(C*G-x*z*D);I[1]=J*(C*D+G*x*z);I[2]=-J*B*x;I[3]=0;I[4]=-M*B*D;I[5]=M*B*G;I[6]=M*z;I[7]=0;I[8]=z*D*C+x*G;I[9]=
-(z*C*G-x*D);I[10]=C*B;I[11]=0;I[12]=N;I[13]=O;I[14]=P;I[15]=1};m.ChargedPlane.prototype=new vizit.geometry.Square})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ChargedSphere=function(e,k,a,c,b,d,g,h,f){var l,p,n,r,q,s,m,t,u,v,y;m=!0;t=f;u=0;l=c;p=l*l;n=p*l;r=b;q=r*r*r;v="undefined"===typeof d?0:d;y="undefined"===typeof g?0:g;nfieldLines="undefined"===typeof h?0:h;this.setA=function(a){l=a;p=l*l;n=p*l;m=!0;return this};this.getA=function(){return l};this.setB=function(a){r=a;q=r*r*r;m=!0;return this};this.getB=function(){return r};this.setNindices=function(a){u=a;return this};this.setModified=function(a){m=a;return this};this.isModified=function(){return m};
this.setNfieldLines=function(a){nfieldLines=a;m=!0;return this};this.getNfieldLines=function(){return nfieldLines};this.setName=function(a){t=a;return this};this.getName=function(){return t};this.getStartPoints=function(){var b,d,c,f,g,h,s;h=0<v?1:0>v?-1:0;b=Math.round(y*v*h)+nfieldLines;f=3.6/Math.sqrt(b);d=0;radius=l+0.2*(r-l);g=[];for(var p=1;p<b;p++)s=-1+2*p/b,c=Math.sqrt(1-s*s),d+=f/c,g.push([Math.cos(d)*c*radius+e,s*radius+k,Math.sin(d)*c*radius+a,h]);return g};this.getField=function(b,d,c){var f,
g=[0,0,0],h;b-=e;d-=k;c-=a;f=b*b+d*d+c*c;if(f<=p)return g;h=Math.sqrt(f);f=h>=l&&h<r?v*(h-n/f)/(q-n):v/f;g[0]=f*b/h;g[1]=f*d/h;g[2]=f*c/h;return g};this.getModelView=function(b){"undefined"===typeof b&&(b=1);null===s?(s=new Float32Array(16),s[0]=b,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=b,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=b,s[11]=0,s[12]=e,s[13]=k,s[14]=a,s[15]=1):(s[0]=b,s[5]=b,s[10]=b);return s};this.drawFullSurface=function(a,b,d,c,f,g){var e;e=a.getGLContext();a.bindBuffer(d,b.getPositionHandle(),3,
e.FLOAT,0,0);a.bindBuffer(c,b.getNormalHandle(),3,e.FLOAT,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f);e.drawElements(e.TRIANGLES,g,e.UNSIGNED_SHORT,0)};this.render=function(a,b){var d,c,f,g,e;c=a.getGLContext();d=this.getIntrinsicRadius();e=this.getVertexBuffers(a);0<v?c.uniform4f(b.getSurfaceColorHandle(),0.05,0.05,0.8,0.2):0>v?c.uniform4f(b.getSurfaceColorHandle(),0.8,0.05,0.05,0.2):c.uniform4f(b.getSurfaceColorHandle(),0.5,0.5,0.5,0.2);u=this.getNindices();c.cullFace(c.FRONT);for(f=r;f>=l;f--)g=
f/d,c.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView(g)),this.drawFullSurface(a,b,e.vertices,e.normals,e.indices,u);c.cullFace(c.BACK);for(f=l;f<=r;f++)g=f/d,this.drawFullSurface(a,b,e.vertices,e.normals,e.indices,u),c.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView(g))}};m.ChargedSphere.prototype=new vizit.geometry.Sphere})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.Charge=function(e,k,a,c,b,d,g){var h,f,l,p,n,r,q;this.setCharge=function(a){h=vizit.utility.ensureNumber(a);f=!0};this.getCharge=function(){return h};this.setX=function(a){n[0]=vizit.utility.ensureNumber(a);f=!0};this.getX=function(){return n[0]};this.setY=function(a){n[1]=vizit.utility.ensureNumber(a);f=!0};this.getY=function(){return n[1]};this.setZ=function(a){n[2]=vizit.utility.ensureNumber(a);f=!0};this.getZ=function(){return n[2]};this.setPosition=function(a){n=a;f=!0};this.getPosition=
function(){return n};this.setNfieldLines=function(a){p=a;f=!0};this.getNfieldLines=function(){return p};this.setModified=function(a){f=a};this.isModified=function(){return f};this.setName=function(a){l=a};this.getName=function(){return l};this.getField=function(a,b,d){var c,f=[0,0,0],e;a-=n[0];b-=n[1];d-=n[2];q=a*a+b*b+d*d;if(0>=q)return f;e=Math.sqrt(q);c=h/q;f[0]=c*a/e;f[1]=c*b/e;f[2]=c*d/e;return f};this.getFieldSeedPointsI=function(a){var b,d,c,f,e,g;f=[];e=0<h?1:0>h?-1:0;a=Math.round(a*h*e);
b=2/a;for(var l=0;l<a;l++)g=l*b-1+b/2,c=Math.sqrt(1-g*g),d=2.39996323*l,f.push([Math.cos(d)*c+n[0],g+n[1],Math.sin(d)*c+n[2],e]);return f};this.getStartPoints=function(a,b){var d,c,f,e,g,l,k;l=0<h?1:0>h?-1:0;d=Math.round(r*h*l)+1+p;e=3.6/Math.sqrt(d);c="undefined"===typeof a?Math.PI/2:a;b="undefined"===typeof b?1:b;g=[];if(0<d)for(var q=1;q<d;q++)k=-1+2*q/d,f=Math.sqrt(1-k*k),c+=e/f,g.push([Math.cos(c)*f*b+n[0],k*b+n[1],Math.sin(c)*f*b+n[2],l]);return g};this.shouldStop=function(a,b,d,c){return 0>
a*h&&4>q};h=c;f=!0;l=g;n=[vizit.utility.ensureNumber(e),vizit.utility.ensureNumber(k),vizit.utility.ensureNumber(a)];r="undefined"===typeof b?0:b;p="undefined"===typeof d?0:d};m.Charges=function(){var e,k,a,c;this.addCharge=function(b){a=e.push(b);return this};for(var b=0;b<arguments.length;b++)this.addCharge(arguments[b]);this.getNcharges=function(){return a};this.getCharges=function(){return e};this.addDistribution=function(a){c=k.push(a);return this};this.getNdistributions=function(){return c};
this.getDistributions=function(){return k};this.chargesModified=function(){var d;d=!1;for(b=0;b<a&&!d;b++)d=d||e[b].isModified();return d};this.distributionsModified=function(){var a;a=!1;for(b=0;b<c&&!a;b++)a=a||k[b].isModified();return a};this.isModified=function(){return this.chargesModified()||this.distributionsModified()};this.setModified=function(d){for(b=0;b<a;b++)e[b].setModified(d);for(b=0;b<c;b++)k[b].setModified(d)};this.getStartPoints=function(b,g){var h,f=b,l=1.57079632679/(a+1),p=[],
n;for(h=0;h<a;h++)n=e[h],p=p.concat(n.getStartPoints(f,g)),f+=l;for(h=0;h<c;h++)p=p.concat(k[h].getStartPoints());return p};this.getField=function(b,g,h){for(var f,l=[0,0,0],p=0;p<a;p++)f=e[p],f=f.getField(b,g,h),l[0]+=f[0],l[1]+=f[1],l[2]+=f[2];for(p=0;p<c;p++)f=k[p].getField(b,g,h),l[0]+=f[0],l[1]+=f[1],l[2]+=f[2];return l};this.shouldStop=function(b,c,h,f){var l;l=!1;for(var k=0;k<a&!l;k++)l=e[k],l=l.shouldStop(b,c,h,f);return l};a=0;e=[];k=[]}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(m){m.ElectricField=function(){var e,k,a,c,b,d,g,h,f,l,p,n,r,q,s,m,t,u,v,y,C;this.setArrowSpacing=function(a){k=a;"undefined"!==typeof s&&s.setArrowSpacing(a)};this.getArrowSpacing=function(){return k};this.setArrowHeadSize=function(a){e=a;"undefined"!==typeof s&&s.setArrowHeadSize(a)};this.getArrowHeadSize=function(){return e};this.setColor=function(a){g=a};this.getColor=function(){return g};this.setCharges=function(a){d=a};this.getCharges=function(){return d};this.addGaussianSurface=function(a){l.push(a)};
this.getGaussianSurfaces=function(){return l};this.setGlUtility=function(a){p=a};this.getGlUtility=function(){return p};this.setMaxVectors=function(a){r=a};this.getMaxVectors=function(){return r};this.setModelViewMatrix=function(a){t=a;q=p.extractRotationPart(t,q)};this.getModelViewMatrix=function(){return t};this.setProjectionMatrix=function(a){u=a};this.addStartPoint=function(a,b,d,c){v.push([a,b,d,c]);return this};this.addStartPoints=function(a){v=v.concat(a)};this.getStartPoints=function(){return v};
this.render=function(){if(y){var c;c=p.getGLContext();d.chargesModified()?(this.setupCharges(),this.setupFieldLines()):d.distributionsModified()&&this.setupFieldLines();p.clear();b.render(u,t,a,d);m.render(u,t,g,f);c.enable(c.BLEND);c.enable(c.CULL_FACE);c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA);C.render(u,t,q,d.getDistributions());c.disable(c.DEPTH_TEST);C.render(u,t,q,l);c.enable(c.DEPTH_TEST);c.disable(c.BLEND);c.disable(c.CULL_FACE);d.setModified(!1)}};this.setupCharges=function(b){a||(b=
p.getGLContext(),a=b.createBuffer());b=c.generate();p.loadData(a,b)};this.setupFieldLines=function(){var a,b,c,e,g,h;g=[];g=g.concat(d.getStartPoints(0,5));g=g.concat(v);c=g.length;e=f.length;h=Math.min(c,e);for(b=0;b<h;++b)a=g[b],a=s.generate(a[0],a[1],a[2],a[3]),f[b].reload(p,a);for(;b<e;++b)f[b].disable();for(;b<c;++b)a=g[b],a=s.generate(a[0],a[1],a[2],a[3]),f.push(new vizit.electricfield.FieldLineVBO(p,a))};this.start=function(){p.clearColor(0,0,0,0);m=new vizit.electricfield.FieldLineRenderer(p);
c=new vizit.electricfield.ChargeGenerator(d);s=new vizit.electricfield.FieldLineGenerator(d,n,h,e,k);this.setupFieldLines(d,n,h,e,k);b=new vizit.electricfield.ChargeRenderer(p);this.setupCharges(d);C=new vizit.electricfield.SurfaceRenderer(p);y=!0;this.render()};e=0.3;k=1.2;g=new Float32Array([0.8,0.3,0.3,1]);h=0.6;f=[];l=[];n=3E3;r=5;q=new Float32Array([1,0,0,0,1,0,0,0,1]);v=[];y=!1}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(m){m.VectorFieldGenerator=function(e,k,a,c,b){var d,g,h,f,l,p,n,r;this.setStartPoints=function(a){r=a;return this};this.getStartPoints=function(){return r};this.setMaxVectors=function(a){p=a;return this};this.getMaxVectors=function(){return p};this.setArrowHeadSize=function(a){g=a;return this};this.getArrowHeadSize=function(){return g};this.setVectorSpacing=function(a){vectorSpacing=a;return this};this.getVectorSpacing=function(){return vectorSpacing};this.setDs=function(a){f=a;return this};
this.getDs=function(){return f};this.generateVector=function(a,b,c,d,f,e,g,h,l,k){var p,n,r,m,A,E,x,z,D,L,J,M,N;L=a+d[0]*l;J=b+d[1]*l;M=c+d[2]*l;0!==d[2]?(x=E=1,z=-(d[0]+d[1])/d[2]):(0!==d[1]?(E=1,x=-(d[0]+d[2])/d[1]):(E=-(d[1]+d[2])/d[0],x=1),z=1);D=g*e*f*l/Math.sqrt(E*E+x*x+z*z);E*=D;x*=D;z*=D;p=e*d[0]*l;n=e*d[1]*l;d=e*d[2]*l;r=n*z-d*x;m=d*E-p*z;A=p*x-n*E;D=g*e*f*l/Math.sqrt(r*r+m*m+A*A);r*=D;m*=D;A*=D;f=L-p+E;e=J-n+x;g=M-d+z;E=L-p-E;x=J-n-x;z=M-d-z;l=L-p+r;D=J-n+m;N=M-d+A;p=L-p-r;n=J-n-m;A=M-d-
A;d=6*h+1;k.pushVertex(a);k.pushVertex(b);k.pushVertex(c);k.pushIndex(6*h);k.pushVertex(L);k.pushVertex(J);k.pushVertex(M);k.pushIndex(d);k.pushVertex(f);k.pushVertex(e);k.pushVertex(g);k.pushIndex(6*h+2);k.pushIndex(d);k.pushVertex(E);k.pushVertex(x);k.pushVertex(z);k.pushIndex(6*h+3);k.pushIndex(d);k.pushVertex(l);k.pushVertex(D);k.pushVertex(N);k.pushIndex(6*h+4);k.pushIndex(d);k.pushVertex(p);k.pushVertex(n);k.pushVertex(A);k.pushIndex(6*h+5);k.pushIndex(d)};this.trace=function(a,b,c,e,h,k,l,
p,n){var r,m,F,K,H;H=K=r=0;for(m=!1;H<k&&!m;){F=a.getField(b,c,e);m=Math.sqrt(F[0]*F[0]+F[1]*F[1]+F[2]*F[2]);if(0===m)break;r>=K&&(this.generateVector(b,c,e,F,m,g,d,l+H,p,n),K=r+Math.max(1.2*m*p,1),H++);b+=h*F[0]/m*f;c+=h*F[1]/m*f;e+=h*F[2]/m*f;r+=f;m=a.shouldStop(h,b,c,e)}return H};this.generateField=function(){var a,b,d,c;d=r.length;n=0;b=new vizit.utility.IndexedVertices(6*p*d,10*p*d);for(a=0;a<d;a++)c=r[a],c[4]=n,n+=this.trace(l,c[0],c[1],c[2],c[3],p,n,h,b);return b};d=c;g=a;f=0.33;l=e;p=k;h=
b}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.field=window.vizit.field||{};
(function(m){m.FieldRenderer=function(e){var k,a,c,b,d,g,h,f;this.getContext=function(){return c.getGLContext()};this.setRenderer=function(a){g=a;g.setGlUtility(c);g.setModelViewMatrix(b);g.setProjectionMatrix(d)};this.setModelViewMatrix=function(a){b=a;g.setModelViewMatrix(b)};this.getModelViewMatrix=function(){return b};this.requestRender=function(){h||(h=!0,requestAnimationFrame(this.render))};this.render=function(){g.render();h=!1};this.start=function(){g.start()};this.setScale=function(a){f=
a;1>f&&(f=1);d=c.generateOrthographicMatrix(f,f,-f,f);g.setProjectionMatrix(d);this.render()};this.zoomBy=function(a){this.setScale(f+a)};this.setElementName=function(a,b){k[b]=a};this.getElementByName=function(a){var b;k.hasOwnProperty(a)&&(b=k[a]);return b};k={};c=new vizit.utility.GLUtility(e);f=5;b=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);new Float32Array([1,0,0,0,1,0,0,0,1]);d=c.generateOrthographicMatrix(f,f,-f,f);a=new vizit.utility.MotionEventHandler(this,c,75,4);e.addEventListener("mousewheel",
a.handleMouseWheel.bind(a),!1);e.addEventListener("mousedown",a.handleMouseDown.bind(a),!1);document.addEventListener("mouseup",a.handleMouseUp.bind(a),!1);document.addEventListener("mousemove",a.handleMouseMove.bind(a),!1);e.addEventListener("touchstart",a.handleTouchStart.bind(a),!1);e.addEventListener("touchmove",a.handleTouchMove.bind(a),!1);e.addEventListener("touchend",a.handleTouchEnd.bind(a),!1)}})(window.vizit.field);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.CombinedVectorValuedFunctionBuilder=function(e){var k;this.buildFunction=function(a){var c,b;for(b in a)"args"!==b.toLowerCase()&&("body"===b.toLowerCase()?c=a[b]:"name"===b.toLowerCase()?name=a[b]:"properties"!==b.toLowerCase()&&"stop"!==b.toLowerCase()&&b.toLowerCase());return new vizit.vectorfield.VectorFunction(agrs,c)};this.build=function(a){var c,b,d,e;if(a)if(b=new vizit.vectorfield.CombinedVectorFunctions,Array.isArray(a)){e=a.length;for(var h=0;h<e;++h)if(c=this.buildFunction(a[h]))b.addFunction(c),
(d=c.getName())&&k.setElementName(c,d)}else if(c=this.buildFunction(a))b.addFunction(c),(d=c.getName())&&k.setElementName(c,d);return b};k=e}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.SurfaceBuilder=function(){var e,k,a,c,b,d;this.getXMin=function(){return e};this.getXMax=function(){return k};this.getYMin=function(){return a};this.getYMax=function(){return c};this.getZMin=function(){return b};this.getZMax=function(){return d};this.gaussianCylinderBuilder=function(g){var h,f,l,p,n,m,q,s,w,t;h=!0;for(n in g)"x"===n.toLowerCase()?s=g[n]:"y"===n.toLowerCase()?w=g[n]:"z"===n.toLowerCase()?t=g[n]:"h"===n.toLowerCase()?f=g[n]:"r"===n.toLowerCase()?m=g[n]:"phi"===n.toLowerCase()?
p=g[n]:"theta"===n.toLowerCase()?q=g[n]:"name"===n.toLowerCase()?l=g[n]:"enabled"===n.toLowerCase()&&(h=g[n]);e=Math.min(e,s-m,s+m);k=Math.max(k,s-m,s+m);a=Math.min(a,w-m,w-m);c=Math.max(c,w-m,w+m);b=Math.min(b,t-f,t+f);d=Math.max(d,t-f,t+f);g=new vizit.electricfield.GaussianCylinder(s,w,t,f,m,p,q,l);h||g.setEnabled(h);return g};this.gaussianSphereBuilder=function(g){var h,f,l,p,m,r,q;h=!0;for(l in g)"x"===l.toLowerCase()?m=g[l]:"y"===l.toLowerCase()?r=g[l]:"z"===l.toLowerCase()?q=g[l]:"r"===l.toLowerCase()?
p=g[l]:"name"===l.toLowerCase()?f=g[l]:"enabled"===l.toLowerCase()&&(h=g[l]);e=Math.min(e,m-p,m+p);k=Math.max(k,m-p,m+p);a=Math.min(a,r-p,r-p);c=Math.max(c,r-p,r+p);b=Math.min(b,q-p,q+p);d=Math.max(d,q-p,q+p);g=new vizit.electricfield.GaussianSphere(m,r,q,p,f);h||g.setEnabled(h);return g};this.surfaceBuilder=function(a){var b,d,c,e;b=/\s*gaussian\s*sphere\s*/i;for(d in a)if("type"===d.toLowerCase()){e=a[d];break}e.match(/\s*gaussian\s*cylinder\s*/i)?c=this.gaussianCylinderBuilder(a):e.match(b)&&(c=
this.gaussianSphereBuilder(a));return c};this.build=function(a,b,d){var c,e;if(a)if(Array.isArray(a)){e=a.length;for(var k=0;k<e;++k)if(c=this.surfaceBuilder(a[k],d))b.addGaussianSurface(c),(name=c.getName())&&d.setElementName(c,name)}else if(c=this.surfaceBuilder(a))b.addGaussianSurface(c),(name=c.getName())&&d.setElementName(c,name);return b}}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};(function(m){m.VectorValuedFunctionBuilder=function(e){var k;this.build=function(a,c){var b,d;a&&(b=Array.isArray(a)?a[0]:a,"undefined"!==typeof b&&(d="function"===b.type.toLowerCase()?new vizit.builder.CombinedVectorValuedFunctionBuilder(k):new vizit.builder.ElectricFieldElementBuilder(k,c)));return d.build(a)};k=e}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.DistributionBuilder=function(){var e,k,a,c,b,d,g,h;this.getXMin=function(){return a};this.getXMax=function(){return c};this.getYMin=function(){return b};this.getYMax=function(){return d};this.getZMin=function(){return g};this.getZMax=function(){return h};this.chargedPlaneBuilder=function(f){var l,m,n,r,q,s,w,t,u,v,y,C,B,G,I,F,K;for(l in f)l.match(e)?m=f[l]:l.match(k)?n=f[l]:"nfieldLines"===l.toLowerCase()?q=f[l]:"x0"===l.toLowerCase()?s=f[l]:"y0"===l.toLowerCase()?w=f[l]:"z0"===l.toLowerCase()?
t=f[l]:"x1"===l.toLowerCase()?u=f[l]:"y1"===l.toLowerCase()?v=f[l]:"z1"===l.toLowerCase()?y=f[l]:"x2"===l.toLowerCase()?C=f[l]:"y2"===l.toLowerCase()?B=f[l]:"z2"===l.toLowerCase()?G=f[l]:"x3"===l.toLowerCase()?I=f[l]:"y3"===l.toLowerCase()?F=f[l]:"z3"===l.toLowerCase()?K=f[l]:"name"===l.toLowerCase()&&(r=f[l]);a=Math.min(a,s,u,C,I);c=Math.max(c,s,u,C,I);b=Math.min(b,w,v,B,K);d=Math.max(d,w,v,B,K);g=Math.min(g,t,y,G,K);h=Math.max(h,t,y,G,K);return new vizit.electricfield.ChargedPlane(s,w,t,u,v,y,C,
B,G,I,F,K,m,n,q,r)};this.chargedCylinderBuilder=function(f){var l,m,n,r,q,s,w,t,u,v,y,C,B;for(q in f)q.match(e)?l=f[q]:q.match(k)?m=f[q]:"nfieldLines"===q.toLowerCase()?r=f[q]:"x0"===q.toLowerCase()?s=f[q]:"y0"===q.toLowerCase()?w=f[q]:"z0"===q.toLowerCase()?t=f[q]:"x1"===q.toLowerCase()?u=f[q]:"y1"===q.toLowerCase()?v=f[q]:"z1"===q.toLowerCase()?y=f[q]:"r0"===q.toLowerCase()?C=f[q]:"r1"===q.toLowerCase()?B=f[q]:"name"===q.toLowerCase()&&(n=f[q]);a=Math.min(a,s,u);c=Math.max(c,s,u);b=Math.min(b,w,
v);d=Math.max(d,w,v);g=Math.min(g,t,y);h=Math.max(h,t,y);return new vizit.electricfield.ChargedCylinder(s,w,t,u,v,y,C,B,l,m,r,n)};this.chargedLineBuilder=function(f){var l,m,n,r,q,s,w,t,u,v,y;for(q in f)q.match(e)?l=f[q]:q.match(k)?m=f[q]:"nfieldLines"===q.toLowerCase()?r=f[q]:"x0"===q.toLowerCase()?s=f[q]:"y0"===q.toLowerCase()?w=f[q]:"z0"===q.toLowerCase()?t=f[q]:"x1"===q.toLowerCase()?u=f[q]:"y1"===q.toLowerCase()?v=f[q]:"z1"===q.toLowerCase()?y=f[q]:"name"===q.toLowerCase()&&(n=f[q]);a=Math.min(a,
s,u);c=Math.max(c,s,u);b=Math.min(b,w,v);d=Math.max(d,w,v);g=Math.min(g,t,y);h=Math.max(h,t,y);return new vizit.electricfield.ChargedLine(s,w,t,u,v,y,l,m,r,n)};this.chargedSphereBuilder=function(f){var e,m,n,r,q,s,w,t,u;for(property in f)"charge"===property.toLowerCase()?e=f[property]:property.match(k)?m=f[property]:"nfieldLines"===property.toLowerCase()?r=f[property]:"x"===property.toLowerCase()?q=f[property]:"y"===property.toLowerCase()?s=f[property]:"z"===property.toLowerCase()?w=f[property]:"a"===
property.toLowerCase()?t=f[property]:"b"===property.toLowerCase()?u=f[property]:"name"===property.toLowerCase()&&(n=f[property]);a=Math.min(a,q-u);c=Math.max(c,q+u);b=Math.min(b,s-u);d=Math.max(d,s+u);g=Math.min(g,w-u);h=Math.max(h,w+u);return new vizit.electricfield.ChargedSphere(q,s,w,t,u,e,m,r,n)};this.chargeDistributionBuilder=function(a){var b,d,c,e,g,h;b=/\s*charged\s*cylinder\s*/i;d=/\s*charged\s*line\s*/i;c=/\s*charged\s*sphere\s*/i;for(g in a)if("type"===g.toLowerCase()){h=a[g];break}h.match(/\s*charged\s*plane\s*/i)?
e=this.chargedPlaneBuilder(a):h.match(b)?e=this.chargedCylinderBuilder(a):h.match(d)?e=this.chargedLineBuilder(a):h.match(c)&&(e=this.chargedSphereBuilder(a));return e};this.build=function(a,b,d){var c,e,g;if(a)if(Array.isArray(a)){g=a.length;for(var h=0;h<g;++h)if(c=this.chargeDistributionBuilder(a[h]))b.addDistribution(c),(e=c.getName())&&d.setElementName(c,e)}else if(c=this.chargeDistributionBuilder(a))b.addDistribution(c),(e=c.getName())&&d.setElementName(c,e);return b};e=/\s*charge\s*density\s*/i;
k=/\s*field\s*line\s*density\s*/i}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.ChargesBuilder=function(){var e,k,a,c,b,d;this.getXMin=function(){return e};this.getXMax=function(){return k};this.getYMin=function(){return a};this.getYMax=function(){return c};this.getZMin=function(){return b};this.getZMax=function(){return d};this.chargeBuilder=function(g){var h,f,l,m,n,r,q,s,w,t,u;f="";q=/\s*field\s*line\s*density\s*/i;for(t in g)"charge"===t.toLowerCase()?u=g[t]:"x"===t.toLowerCase()?m=g[t]:"y"===t.toLowerCase()?n=g[t]:"z"===t.toLowerCase()?r=g[t]:t.match(q)?s=
g[t]:"nfieldlines"===t.toLowerCase()?w=g[t]:"name"===t.toLowerCase()&&(l=g[t]);"undefined"===typeof u&&(f="No charge specified for point charge.");"undefined"===typeof m&&(0<f.length&&(f+="\n"),f+="x coordinate is not defined in charge configuration.");"undefined"===typeof n&&(0<f.length&&(f+="\n"),f+="y coordinate is not defined in charge configuration.");"undefined"===typeof r&&(0<f.length&&(f+="\n"),f+="z coordinate is not defined in charge configuration.");0===f.length&&(m<e&&(e=m),m>k&&(k=m),
n<a&&(a=n),n>c&&(c=n),r<b&&(b=r),r>d&&(d=r),h=new vizit.electricfield.Charge(m,n,r,u,s,w,l));return h};this.build=function(a,b,c){var d,e,k;if(a)if(Array.isArray(a)){k=a.length;for(var m=0;m<k;++m)if(d=this.chargeBuilder(a[m]))b.addCharge(d),(e=d.getName())&&c.setElementName(d,e)}else if(d=this.chargeBuilder(a))b.addCharge(d),(e=d.getName())&&c.setElementName(d,e);return b};e=Number.POSITIVE_INFINITY;k=Number.NEGATIVE_INFINITY;a=Number.POSITIVE_INFINITY;c=Number.NEGATIVE_INFINITY;b=Number.POSITIVE_INFINITY;
d=Number.NEGATIVE_INFINITY}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.BindingBuilder=function(){this.bindingBuilder=function(e,k){var a,c,b,d,g;for(b in e)"target"===b.toLowerCase()?g=e[b]:"set"===b.toLowerCase()?d=e[b]:"from"===b.toLowerCase()?c=e[b]:"mapping"===b.toLowerCase()&&(a=e[b]);c||(c=d);b="set"+d.charAt(0).toUpperCase();1<d.length&&(b+=d.slice(1));d=k.getElementByName(g)[b];a=a?new window.vizit.lesson.MappingEventHandler(d,c,a,k):new window.vizit.lesson.DirectEventHandler(d,k);document.addEventListener(c+"Changed",a.handleUpdate.bind(a),!1)};
this.build=function(e,k){var a;if(e)if(Array.isArray(e)){a=e.length;for(var c=0;c<a;++c)this.bindingBuilder(e[c],k)}else this.bindingBuilder(e,k)}}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.ElectricFieldElementBuilder=function(e,k){var a,c;this.buildELement=function(b,d){var e,h,f,k,m,n,r,q;e=/\s*charged\s*cylinder\s*/i;h=/\s*charged\s*line\s*/i;f=/\s*charged\s*plane\s*/i;k=/\s*charged\s*sphere\s*/i;m=/\s*gaussian\s*cylinder\s*/i;n=/\s*gaussian\s*sphere\s*/i;for(r in b)"type"===r.toLowerCase()&&(q=b[r]);if("charge"===q.toLowerCase())e=new vizit.builder.ChargesBuilder,d=e.build(b,d,a);else if(q.match(e)||q.match(h)||q.match(f)||q.match(k))e=new vizit.builder.DistributionBuilder,
d=e.build(b,d,a);else if(q.match(m)||q.match(n))e=new vizit.builder.SurfaceBuilder,c=e.build(b,c,a);return d};this.build=function(a){var d,c;d=new vizit.electricfield.Charges;if(a)if(Array.isArray(a)){c=a.length;for(var e=0;e<c;++e)this.buildELement(a[e],d)}else this.buildELement(a,d);return d};a=e;c=k}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.ElectricFieldBuilder=function(e){var k;this.build=function(a){var c,b,d,e,h,f;for(f in a)"arrowheadsize"===f.toLowerCase()?c=a[f]:"arrowspacing"===f.toLowerCase()?b=a[f]:"maxvectors"===f.toLowerCase()?h=a[f]:"elements"===f.toLowerCase()&&(e=a[f]);a=new vizit.electricfield.ElectricField;"undefined"!==typeof h&&a.setMaxVectors(h);"undefined"!==typeof c&&a.setArrowHeadSize(c);"undefined"!==typeof b&&a.setArrowSpacing(b);(d=(new vizit.builder.ElectricFieldElementBuilder(k,a)).build(e,d))&&
a.setCharges(d);return a};k=e}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.SimpleVectorFieldBuilder=function(e){var k;this.build=function(a){var c,b,d,e,h,f,l;for(l in a)"arrowheadsize"===l.toLowerCase()&&(c=a[l]),"arrowheadwidth"===l.toLowerCase()?b=a[l]:"arrowsize"===l.toLowerCase()?d=a[l]:"maxvectors"===l.toLowerCase()&&(e=a[l]),"f"===l.toLowerCase()?f=a[l]:l.toLowerCase();f&&(a=new vizit.builder.VectorValuedFunctionBuilder(k),h=a.build(f));d=new vizit.vectorfield.SimpleVectorField(h,d);"undefined"!==typeof e&&d.setMaxVectors(e);"undefined"!==typeof c&&
d.setArrowHeadSize(c);"undefined"!==typeof b&&d.setArrowHeadWidth(b);return d};k=e}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(m){m.VizBuilder=function(){this.processConfig=function(e){var k,a,c,b,d,g,h,f;a=/\s*electric\s*field\s*/i;h=/\s*simple\s*vector\s*field\s*/i;for(c in e)"canvas"===c.toLowerCase()?b=e[c]:"scale"===c.toLowerCase()?g=e[c]:"type"===c.toLowerCase()?f=e[c]:"bindings"===c.toLowerCase()&&(k=e[c]);"undefined"===typeof f?alert("Missing type for visualization configuration."):"undefined"===b?alert("No canvas specified, please provide the id of a canvas."):(c=document.getElementById(b))?(b=new vizit.field.FieldRenderer(c),
f.match(a)?(a=new vizit.builder.ElectricFieldBuilder(b),d=a.build(e)):f.match(h)?(a=new vizit.builder.SimpleVectorFieldBuilder(b),d=a.build(e)):alert("Unrecognized visualization type: "+f+"."),d&&(k&&(a=new vizit.builder.BindingBuilder,a.build(k,b)),b.setRenderer(d),"undefined"!==typeof g&&b.setScale(g),b.start())):alert('Can not find canvas with id="'+b+'".')};this.process=function(e){var k;if(e)if(Array.isArray(e)){k=e.length;for(var a=0;a<k;++a)this.processConfig(e[a])}else this.processConfig(e)}}})(window.vizit.builder);
function VIZ_CONFIG_IF_EXISTS(m){"undefined"!==typeof VISUALIZATION_CONFIG&&(m=new vizit.builder.VizBuilder,m.process(VISUALIZATION_CONFIG))}"interactive"===document.readyState||"complete"===document.readyState?VIZ_CONFIG_IF_EXISTS():document.addEventListener("DOMContentLoaded",VIZ_CONFIG_IF_EXISTS);
