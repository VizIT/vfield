/*
 Copyright 2013-2014 Vizit Solutions

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
*/
window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(l){l.ensureNumber=function(f){return"number"===typeof f?f:parseFloat(f)}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(l){l.toBoolean=function(f){var h,a;a=typeof f;if("boolean"===a)h=f;else if("number"===a)h=0!==f;else if("string"===a)switch(f.trim().toLowerCase()){case "f":case "false":case "n":case "no":case "0":case "":h=!1;break;default:h=!0}return h}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(l){l.MotionEventHandler=function(f,h,a,c){var d,b,e,k;d=[];b=!1;k=e=null;this.findTouchByIdentifier=function(a){var c,b;for(c=0;c<d.length;c++)if(b=d[c].identifier,b===a)return c;return-1};this.handleTouchStart=function(a){var c,b,e;e=a.targetTouches;for(c=0;c<e.length;c++)b=e[c],-1===this.findTouchByIdentifier(b.identifier)&&d.push(b);if(a.preventDefault)a.preventDefault();else return!1};this.handleTouchEnd=function(a){var c,b,e;e=a.changedTouches;for(c=0;c<e.length;c++)b=this.findTouchByIdentifier(e[c].identifier),
-1!==b&&d.splice(b,1);if(a.preventDefault)a.preventDefault();else return!1};this.handleOneActiveMove=function(a){var c,b,e,k;k=a.changedTouches[0];b=d[0];null!==b?(c=k.pageX-b.pageX,b=k.pageY-b.pageY,e=f.getModelViewMatrix(),h.rotateBy(e,b/150,c/150),f.setModelViewMatrix(e),f.requestRender(),d.splice(0,1,k)):d.push(k);if(a.preventDefault)a.preventDefault();else return!1};this.handleTwoActiveMove=function(a){var b,e,k,h,n,r,w;h=d[0];r=d[1];b=r.pageX-h.pageX;e=r.pageY-h.pageY;k=Math.sqrt(b*b+e*e);w=
a.changedTouches;for(b=0;b<w.length;b++)n=w[b],e=n.identifier,h.identifier===e?(h=n,d.splice(0,1,n)):r.identifier===e&&(r=n,d.splice(1,1,n));b=r.pageX-h.pageX;e=r.pageY-h.pageY;h=Math.sqrt(b*b+e*e);f.zoomBy(-(h-k)/c);if(a.preventDefault)a.preventDefault();else return!1};this.handleTouchMove=function(a){return 1===d.length?this.handleOneActiveMove(a):2===d.length?this.handleTwoActiveMove(a):!0};this.handleMouseDown=function(a){b=!0;e=a.clientX;k=a.clientY};this.handleMouseUp=function(a){b=!1};this.handleMouseMove=
function(a){if(b){var c=a.clientX,d=a.clientY,s=c-e,q=d-k;a=f.getModelViewMatrix();h.rotateBy(a,q/30,s/30);f.setModelViewMatrix(a);f.requestRender();e=c;k=d}};this.handleMouseWheel=function(c){c=window.event||c;f.zoomBy(c.wheelDeltaY/a);if(c.preventDefault)c.preventDefault();else return!1}}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(l){l.GLUtility=function(f){var h,a;this.getGLContext=function(){!a&&(a=h.getContext("webgl",{antialias:!0})||h.getContext("experimental-webgl",{antialias:!0}))&&(a.enable(a.DEPTH_TEST),a.depthFunc(a.LESS));return a};this.clearColor=function(c,d,b,e){a.clearColor(c,d,b,e)};this.clear=function(){a.clear(a.COLOR_BUFFER_BIT)};this.compileShader=function(c,d){var b=a.createShader(d);a.shaderSource(b,c);a.compileShader(b);if(!a.getShaderParameter(b,a.COMPILE_STATUS))throw"Shader compile failed with:"+
a.getShaderInfoLog(b);return b};this.createProgram=function(c,d){var b,e,k;e=a.createProgram();k=this.compileShader(c,a.VERTEX_SHADER);b=this.compileShader(d,a.FRAGMENT_SHADER);a.attachShader(e,k);a.attachShader(e,b);a.linkProgram(e);return e};this.loadData=function(c,d){a.bindBuffer(a.ARRAY_BUFFER,c);a.bufferData(a.ARRAY_BUFFER,d,a.STATIC_DRAW)};this.createBuffer=function(c){var d=a.createBuffer();this.loadData(d,c);return d};this.createIndexBuffer=function(c){var d=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,
d);a.bufferData(a.ELEMENT_ARRAY_BUFFER,c,a.STATIC_DRAW);return d};this.getAttribLocation=function(c,d){var b;b=a.getAttribLocation(c,d);-1===b&&alert("Can not find uniform"+attribute+".");return b};this.bindBuffer=function(c,d,b,e,k,g){a.bindBuffer(a.ARRAY_BUFFER,c);a.enableVertexAttribArray(d);a.vertexAttribPointer(d,b,e,!1,k,g)};this.loadTexture=function(c,d,b){var e=a.createTexture(),k=new Image;k.onload=function(){this.onTextureLoaded(k,e,d,b)}.bind(this);k.src=c;return e};this.onTextureLoaded=
function(c,d,b,e){a.activeTexture(a.TEXTURE0+b);a.bindTexture(a.TEXTURE_2D,d);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,c);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST);a.generateMipmap(a.TEXTURE_2D);e()};this.bindTexture=function(c,d,b,e){a.activeTexture(a.TEXTURE0+b);a.bindTexture(a.TEXTURE_2D,d);a.uniform1i(e,b)};this.generateModelViewMatrix=function(a){return new Float32Array([1,0,0,0,0,1,
0,0,0,0,1,0,a,0,0,1])};this.generatePerspectiveMatrix=function(a,d,b,e){return new Float32Array([b/a,0,0,0,0,b/d,0,0,0,0,-(e+b)/(e-b),-1,0,0,-2*e*b/(e-b),0])};this.generateOrthographicMatrix=function(a,d,b,e){return new Float32Array([1/a,0,0,0,0,1/d,0,0,0,0,-2/(e-b),0,0,0,-(e+b)/(e-b),1])};this.getUniformLocation=function(c,d){var b;b=a.getUniformLocation(c,d);-1===b&&alert("Can not find uniform"+d+".");return b};this.loadUniform3f=function(a,d,b,e,k,g){d=a.getUniformLocation(d,b);-1===d?alert("Can not find uniform"+
b+"."):a.uniform3f(d,e,k,g)};this.loadUniform4f=function(c,d,b,e,k,g){c=a.getUniformLocation(c,d);-1===c?alert("Can not find uniform"+d+"."):a.uniform4f(c,b,e,k,g)};this.loadUniformMatrix3fv=function(c,d,b){c=a.getUniformLocation(c,d);-1===c?alert("Can not find uniform"+d+"."):a.uniformMatrix3fv(c,!1,b)};this.loadUniformMatrix4fv=function(c,d,b){c=a.getUniformLocation(c,d);-1===c?alert("Can not find uniform"+d+"."):a.uniformMatrix4fv(c,!1,b)};this.getXYRotationMatrix=function(a,d){Math.cos(a);Math.cos(d);
Math.sin(a);Math.sin(d)};this.rotateBy=function(a,d,b){var e,k,g=Math.cos(d),m=Math.cos(b);d=Math.sin(d);var f=Math.sin(b),h=d*f,q=m*d,n=g*f,r=g*m;b=a[0];e=a[1];k=a[2];a[0]=b*m+k*f;a[1]=b*h+e*g-k*q;a[2]=-b*n+e*d+k*r;b=a[4];e=a[5];k=a[6];a[4]=b*m+k*f;a[5]=b*h+e*g-k*q;a[6]=-b*n+e*d+k*r;b=a[8];e=a[9];k=a[10];a[8]=b*m+k*f;a[9]=b*h+e*g-k*q;a[10]=-b*n+e*d+k*r;b=a[12];e=a[13];k=a[14];a[12]=b*m+k*f;a[13]=b*h+e*g-k*q;a[14]=-b*n+e*d+k*r};this.extractRotationPart=function(a,d){d.set(a.subarray(0,3));d.set(a.subarray(4,
7),3);d.set(a.subarray(8,11),6);return d};h=f;a=this.getGLContext()}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(l){l.Color=function(f,h,a,c){var d,b,e,k;this.setRed=function(a){d=a;return this};this.getRed=function(){return d};this.setGreen=function(a){b=a;return this};this.getGreen=function(){return b};this.setBlue=function(a){e=a;return this};this.getBlue=function(){return e};this.setAlpha=function(a){k=a;return this};this.getAlpha=function(){return k};this.setRed(f).setGreen(h).setBlue(a).setAlpha(c)}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.geometry=window.vizit.geometry||{};
(function(l){l.Surface=function(f,h){var a,c,d,b,e;c=h;b=f;e=new Float32Array(3*f);a=new Uint16Array(h);d=new Float32Array(3*f);this.setNindices=function(a){c=a};this.getNindices=function(){return c};this.setNvertices=function(a){b=a};this.getNvertices=function(){return b};this.setVerticies=function(a){e=a};this.getVertices=function(){return e};this.setIndices=function(b){a=b};this.getIndices=function(){return a};this.setNormals=function(a){d=a};this.getNormals=function(){return d}};l.Shapes={SPHERE:{value:"sphere"},
SQUARE:{value:"square"},CYLINDER:{value:"cylinder"}};l.VertexRegistry=function(){var f;f={};this.registerVertices=function(h,a){if(f.hasOwnProperty(h))throw"Vertex buffers already registered for "+h+".";f[h]=a};this.hasVertices=function(h){return f.hasOwnProperty(h)};this.retrieveVertices=function(h){return f[h]}};l.vertexRegistry=new l.VertexRegistry;l.Square=function(){var f,h,a;a=l.Shapes.SQUARE;f=[-0.5,0.5,0,0.5,0.5,0,0.5,-0.5,0,-0.5,-0.5,0];h=[0,0,1];this.getNindices=function(){return 6};this.computeGeometry=
function(a,d){var b,e,k;k=a.getVertices();e=a.getNormals();b=a.getIndices();for(var g=0;12>g;g++)k[g]=d[g],e[g]=h[g%3];b[0]=0;b[1]=3;b[2]=1;b[3]=3;b[4]=2;b[5]=1;a.setNvertices(12);a.setNindices(6)};this.getVertexBuffers=function(c){var d,b;this.hasVertices(a.value)?b=this.retrieveVertices(a.value):(d=new l.Surface(4,6),b={},this.computeGeometry(d,f),b.vertices=c.createBuffer(d.getVertices()),b.normals=c.createBuffer(d.getNormals()),b.indices=c.createIndexBuffer(d.getIndices()),this.registerVertices(a.value,
b));return b}};l.Square.prototype=l.vertexRegistry;l.Cylinder=function(){var f;f=l.Shapes.CYLINDER;this.getBaseHeight=function(){return 1};this.getBaseRadius=function(){return 1};this.getShape=function(){return f};this.getNindices=function(){return 126};this.computeGeometry=function(f){var a,c,d,b,e,k,g;g=f.getVertices();b=f.getNormals();d=f.getIndices();g[0]=0;b[0]=0;g[1]=0;b[1]=0;g[2]=0.5;b[2]=1;d[0]=0;a=94;d[a]=a;a*=3;g[a]=0;b[a++]=0;g[a]=0;b[a++]=0;g[a]=-0.5;b[a]=-1;for(c=1;31>=c;c++)a=2*(c-1)*
Math.PI/30,d[c]=c,k=3*c,g[k]=1*Math.cos(a),b[k++]=0,g[k]=1*Math.sin(a),b[k++]=0,g[k]=0.5,b[k]=1;for(c=1;31>=c;c++)k=3*c,a=c+90+4,d[a]=a,a*=3,g[a]=g[k++],b[a++]=0,g[a]=g[k],b[a++]=0,g[a]=-0.5,b[a]=-1;k=3;a=285;e=96;for(c=0;30>=c;c++)d[e/3]=e/3,g[e]=g[k],b[e++]=g[k++]/1,g[e]=g[k],b[e++]=g[k++]/1,g[e]=g[k],b[e++]=g[k++]/1,d[e/3]=e/3,g[e]=g[a],b[e++]=g[a++]/1,g[e]=g[a],b[e++]=g[a++]/1,g[e]=g[a],b[e++]=g[a++]/1;f.setNvertices(378);f.setNindices(126)};this.getVertexBuffers=function(h){var a,c;this.hasVertices(f.value)?
c=this.retrieveVertices(f.value):(a=new l.Surface(126,126),c={},this.computeGeometry(a),c.vertices=h.createBuffer(a.getVertices()),c.normals=h.createBuffer(a.getNormals()),c.indices=h.createIndexBuffer(a.getIndices()),this.registerVertices(f.value,c));return c}};l.Cylinder.prototype=l.vertexRegistry;l.Sphere=function(){var f;f=l.Shapes.SPHERE;this.getIntrinsicRadius=function(){return 30};this.getShape=function(){return f};this.getNindices=function(){return 5400};this.computeGeometry=function(f,a,
c,d){var b,e,k,g,m,p,s,q,n,r,w;r=f.getVertices();s=p=0;k=f.getNormals();for(g=0;g<=c;g++)for(m=g*Math.PI/c,n=Math.sin(m),e=Math.cos(m),m=0;m<=d;m++)b=2*m*Math.PI/d,q=Math.sin(b),b=Math.cos(b),q*=n,w=e,b*=n,k[s]=q,r[s++]=a*q,k[s]=w,r[s++]=a*w,k[s]=b,r[s++]=a*b;f.setNvertices(--s);k=f.getIndices();for(g=0;g<c;g++)for(m=0;m<d;m++)a=g*(d+1)+m,s=a+d+1,k[p++]=a,k[p++]=s,k[p++]=a+1,k[p++]=s,k[p++]=s+1,k[p++]=a+1;f.setNindices(--p)};this.getVertexBuffers=function(h){var a,c;this.hasVertices(f.value)?c=this.retrieveVertices(f.value):
(a=new l.Surface(961,5400),c={},this.computeGeometry(a,30,30,30),c.vertices=h.createBuffer(a.getVertices()),c.normals=h.createBuffer(a.getNormals()),c.indices=h.createIndexBuffer(a.getIndices()),this.registerVertices(f.value,c));return c}};l.Sphere.prototype=l.vertexRegistry})(window.vizit.geometry);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.SurfaceRenderer=function(f){var h,a,c,d,b,e,k,g,m,p,s,q,n;this.createProgram=function(d){d=e.createProgram("attribute vec3 normal;attribute vec3 position;uniform   vec3 ambientLighting;uniform   vec3 directionalLighting;uniform   vec3 directionalColor;uniform   mat4 modelViewMatrix;uniform   mat4 globalModelViewMatrix;uniform   mat3 normalMatrix;uniform   mat4 projectionMatrix;varying   vec3 lighting;void main(void){  gl_Position = projectionMatrix * globalModelViewMatrix * modelViewMatrix * vec4(position, 1.0);  vec3  transformedNormal         = normalMatrix * normal;  float directionalLightWeighting = max(dot(transformedNormal, directionalLighting), 0.0);  lighting                        = ambientLighting + directionalColor * directionalLightWeighting;}","precision mediump float;uniform vec4 surfaceColor;varying vec3 lighting;void main(void){  gl_FragColor = vec4(surfaceColor.rgb * lighting, surfaceColor.a);}");
h=e.getUniformLocation(d,"ambientLighting");a=e.getUniformLocation(d,"directionalLighting");c=e.getUniformLocation(d,"directionalColor");k=e.getUniformLocation(d,"modelViewMatrix");b=e.getUniformLocation(d,"globalModelViewMatrix");g=e.getAttribLocation(d,"normal");m=e.getUniformLocation(d,"normalMatrix");p=e.getAttribLocation(d,"position");q=e.getUniformLocation(d,"projectionMatrix");n=e.getUniformLocation(d,"surfaceColor");return d};this.getAmbientLightingHandle=function(){return h};this.getDirectionalLightingHandle=
function(){return a};this.getDirectionalColorHandle=function(){return c};this.getModelViewMatrixHandle=function(){return k};this.getGlobalModelViewMatrixHandle=function(){return b};this.getNormalHandle=function(){return g};this.getNormalMatrixHandle=function(){return m};this.getPositionHandle=function(){return p};this.getProjectionMatrixHandle=function(){return q};this.getSurfaceColorHandle=function(){return n};this.render=function(g,k,f,n){var p;p=n.length;if(0<p)for(d.useProgram(s),d.uniformMatrix4fv(b,
!1,k),d.uniformMatrix3fv(m,!1,f),d.uniformMatrix4fv(q,!1,g),d.uniform3f(h,0.3,0.3,0.3),d.uniform3f(a,1,1,1),d.uniform3f(c,0.4,0.4,0.4),g=0;g<p;g++)n[g].render(e,this)};e=f;d=e.getGLContext();s=this.createProgram()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(l){l.IndexedVertices=function(f,h){var a,c,d,b;this.setNindices=function(a){c=a};this.getNindices=function(){return c};this.setNvertices=function(a){d=a};this.getNvertices=function(){return d};this.setVerticies=function(a){b=a};this.getVertices=function(){return b};this.setVerticies=function(a){b=a};this.getVertices=function(){return b};this.pushVertex=function(a){b[d++]=a};this.setIndices=function(b){a=b};this.getIndices=function(){return a};this.pushIndex=function(b){a[c++]=b};d=c=0;b=
new Float32Array(3*f);a=new Uint16Array(h)}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};(function(l){l.VectorFunction=function(f,h){var a,c;this.setModified=function(d){a=d};this.isModified=function(){return a};this.setName=function(a){c=a};this.getName=function(){return c};this.shouldStop=function(a,b,c,k){return 0>a*Q&&4>r2};this.getField=new Function(f,h)}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(l){l.CombinedVectorFunctions=function(){var f,h;this.addFunction=function(a){h=f.push(a);return this};for(var a=0;a<arguments.length;a++)this.addFunction(arguments[a]);this.getNfunctions=function(){return h};this.getFunctions=function(){return f};this.isModified=function(){var c;c=!1;for(a=0;a<h&&!c;a++)c=c||f[a].isModified();return c};this.setModified=function(c){for(a=0;a<h;a++)f[a].setModified(c)};this.getStartPoints=function(){var a,d=0,b=1.57079632679/(ncharges+1),e,k=[];for(a=0;a<
h;a++)e=f[a],k=k.concat(e.getStartPoints(d,6)),d+=b;return k};this.getField=function(a,d,b){for(var e,k=[0,0,0],g=0;g<h;g++)e=f[g].getField(a,d,b),k[0]+=e[0],k[1]+=e[1],k[2]+=e[2];return k};this.shouldStop=function(a,d,b,e){var k;k=!1;for(var g=0;g<ncharges&!k;g++)k=f[g].shouldStop(a,d,b,e);return k};h=0;f=[]}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(l){l.LineRenderer=function(f){var h,a,c,d,b,e,k;this.createProgram=function(){var a;a=c.createProgram("attribute vec3 position;uniform   mat4 modelViewMatrix;uniform   mat4 projectionMatrix;void main(){    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1);}","precision mediump float;uniform   vec4 color;void main(){    gl_FragColor = color;}");h=c.getUniformLocation(a,"color");d=c.getAttribLocation(a,"position");e=c.getUniformLocation(a,"modelViewMatrix");k=c.getUniformLocation(a,
"projectionMatrix");return a};this.drawIndexedLines=function(g,m,f,s){a.useProgram(b);a.lineWidth(1);a.uniform4fv(h,f);a.uniformMatrix4fv(e,!1,m);a.uniformMatrix4fv(k,!1,g);m=s.length;for(f=0;f<m;f++)g=s[f],c.bindBuffer(g.vertices,d,3,a.FLOAT,12,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,g.indices),a.drawElements(a.LINES,g.nindices,a.UNSIGNED_SHORT,0)};c=f;a=c.getGLContext();b=this.createProgram()}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(l){l.SimpleVectorField=function(f,h){var a,c,d,b,e,k,g,m,p,s,q,n,r,w;this.setArrowHeadWidth=function(a){c=a;return this};this.getArrowHeadWidth=function(){return c};this.setArrowHeadSize=function(b){a=b;return this};this.getArrowHeadSize=function(){return a};this.setColor=function(a){d=a;return this};this.getColor=function(){return d};this.setGlUtility=function(a){g=a;return this};this.getGlUtility=function(){return g};this.setMaxVectors=function(a){p=a;return this};this.getMaxVectors=function(){return p};
this.setModelViewMatrix=function(a){s=a;return this};this.getModelViewMatrix=function(){return s};this.setProjectionMatrix=function(a){n=a;return this};this.addStartPoints=function(a){b=b.concat(a);return this};this.getStartPoints=function(){return b};this.setupVectorField=function(){var a,d;a="function"===typeof e.getStartPoints?b.concat(e.getStartPoints(0,2)):b;k.setStartPoints(a);a={};d=k.generateField();a.vertices=g.createBuffer(d.getVertices());a.indices=g.createIndexBuffer(d.getIndices());a.nindices=
d.getNindices();m[0]=a;return m};this.render=function(){w&&(e.isModified()&&(m=this.setupVectorField()),g.clear(),q.drawIndexedLines(n,s,d,m),e.setModified(!1))};this.start=function(){q=new vizit.vectorfield.LineRenderer(g);k=new vizit.vectorfield.VectorFieldGenerator(e,p,a,c,r);w=!0;this.render()};c=0.5;a=0.3;e=f;m=[];d=new Float32Array([0.8,0.3,0.3,1]);p=5;r="undefined"===typeof h?1:h;b=[];w=!1}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};(function(l){l.CountdownLatch=function(f,h){var a=f;this.countDown=function(){a--;0>=a&&h()}}})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.ChargeGenerator=function(f){var h,a,c,d,b,e,k,g;this.setCharges=function(b){a=b;h*a.getCharges().length>c.byteLength&&(c=new ArrayBuffer(h*a.getCharges().length))};this.getCharges=function(){return a};this.getChargesArray=function(){return c};this.getNcharges=function(){return d};this.generate=function(){var m,f,h,q,n,r;r=a.getCharges();d=r.length;n=new Float32Array(c);f=new Uint8Array(c);for(var w=0;w<d;w++)m=r[w],q=m.getPosition(),h=0+5*w,n[h++]=q[0],n[h++]=q[1],n[h++]=q[2],n[h++]=
k,h=16+20*w,m=0<m.getCharge()?g:0>m.getCharge()?b:e,f[h++]=m[0],f[h++]=m[1],f[h++]=m[2],f[h++]=m[3];return c};a=f;h=3*Float32Array.BYTES_PER_ELEMENT+Float32Array.BYTES_PER_ELEMENT+4*Uint8Array.BYTES_PER_ELEMENT;c=new ArrayBuffer(h*a.getCharges().length);k=16;b=[204,13,13,255];g=[13,13,204,255];e=[13,13,13,51]}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.ChargeRenderer=function(f){var h,a,c,d,b,e,k,g;this.createProgram=function(){var e;e=c.createProgram("precision highp float;attribute vec3  position;attribute vec4  color;attribute float size;uniform   mat4  modelViewMatrix;uniform   mat4  projectionMatrix;varying vec4 vColor;void main(){    gl_Position  = projectionMatrix * modelViewMatrix * vec4(position, 1);    gl_PointSize = size;    vColor       = color;}","precision lowp float;varying vec4 vColor; void main() {   float dist = distance( vec2(0.5,0.5), gl_PointCoord );   if ( dist > 0.5 )     discard;   gl_FragColor = vColor; }");
h=c.getAttribLocation(e,"color");d=c.getUniformLocation(e,"modelViewMatrix");b=c.getAttribLocation(e,"position");k=c.getUniformLocation(e,"projectionMatrix");g=c.getAttribLocation(e,"size");a.enableVertexAttribArray(h);a.enableVertexAttribArray(b);a.enableVertexAttribArray(g);return e};this.render=function(c,f,s,q){a.useProgram(e);a.uniformMatrix4fv(d,!1,f);a.uniformMatrix4fv(k,!1,c);a.bindBuffer(a.ARRAY_BUFFER,s);a.vertexAttribPointer(b,3,a.FLOAT,!1,20,0);a.vertexAttribPointer(g,1,a.FLOAT,!1,20,
12);a.vertexAttribPointer(h,4,a.UNSIGNED_BYTE,!0,20,16);a.drawArrays(a.POINTS,0,q.getNcharges())};c=f;a=c.getGLContext();e=this.createProgram()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.FieldLineVBO=function(f,h){this.disable=function(){this.enabled=!1};this.isEnabled=function(){return this.enabled};this.reload=function(a,c){a.loadData(this.fieldLineBufferHandle,c.getPoints());this.npoints=c.getNpoints();a.loadData(this.fieldDirectionBufferHandle,c.getArrows());this.narrows=c.getNarrows();this.enabled=!0};this.fieldLineBufferHandle=f.createBuffer(h.getPoints());this.npoints=h.getNpoints();this.fieldDirectionBufferHandle=f.createBuffer(h.getArrows());this.narrows=h.getNarrows();
this.enabled=!0}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.FieldLine=function(f){var h,a,c,d,b,e;this.setMaxPoints=function(d){d!==f&&(f=d,b=new Float32Array(3*f),a=new Float32Array(f));return this};this.getMaxPoints=function(){return f};this.pushPoint=function(a,c,m){b[e++]=a;b[e++]=c;b[e++]=m;d++};this.getPoints=function(){return b};this.getNpoints=function(){return d};this.pushArrow=function(b,d,e,f,s,q,n,r,w){a[h++]=b;a[h++]=d;a[h++]=e;a[h++]=f;a[h++]=s;a[h++]=q;a[h++]=f;a[h++]=s;a[h++]=q;a[h++]=n;a[h++]=r;a[h++]=w;c++};this.getArrows=
function(){return a};this.getNarrows=function(){return c};this.reset=function(){e=d=c=h=0};b=new Float32Array(3*f);a=new Float32Array(f);this.reset()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.FieldLineGenerator=function(f,h,a,c,d){var b,e,k,g,m,p;this.setCharges=function(a){g=a;return this};this.getCharges=function(){return g};this.getArrows=function(){return arrows};this.setMaxPoints=function(a){a>maxpoints&&(m=new vizit.electricfield.FieldLine(p));p=a;return this};this.getMaxPoints=function(){return p};this.setArrowHeadSize=function(a){b=a;return this};this.getArrowHeadSize=function(){return b};this.setArrowSpacing=function(a){e=a;return this};this.getArrowSpacing=function(){return e};
this.setDs=function(a){k=a;return this};this.getDs=function(){return k};this.drawArrow=function(a,b,d,e,c,g,k){var m,f,h,p,l;m=e[0]/c;f=e[1]/c;h=e[2]/c;0!==h?(p=c=1,e=-(e[0]+e[1])/e[2]):(0!==f?(c=1,p=-(e[0]+e[2])/e[1]):(c=-(e[1]+e[2])/e[0],p=1),e=1);l=g/Math.sqrt(c*c+p*p+e*e);c*=l;p*=l;e*=l;m*=g;f*=g;g*=h;k.pushArrow(a-m+c,b-f+p,d-g+e,a,b,d,a-m-c,b-f-p,d-g-e)};this.generate=function(a,d,c,f){var h,u,l,t;h=0;u=!1;t=c;m.reset();for(c=0;c<p&&!u;c++){m.pushPoint(a,d,t);l=g.getField(a,d,t);u=Math.sqrt(l[0]*
l[0]+l[1]*l[1]+l[2]*l[2]);if(0===u)break;a+=f*l[0]/u*k;d+=f*l[1]/u*k;t+=f*l[2]/u*k;h+=k;h>e&&(h=0,this.drawArrow(a,d,t,l,u,b,m));u=g.shouldStop(f,a,d,t)}return m};b=c;e=d;g=f;k=a;p=h;m=new vizit.electricfield.FieldLine(p)}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.FieldLineRenderer=function(f){var h,a,c,d,b,e;this.createProgram=function(b){b=a.createProgram("attribute vec3 position;uniform   mat4 modelViewMatrix;uniform   mat4 projectionMatrix;void main(){  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}","precision mediump float;void main(){  gl_FragColor = vec4(0.8,0.3,0.3,1.0);}");c=a.getUniformLocation(b,"modelViewMatrix");d=a.getAttribLocation(b,"position");e=a.getUniformLocation(b,"projectionMatrix");return b};
this.render=function(k,g,f,p){f=p.length;if(0<f)for(h.useProgram(b),h.lineWidth(1),h.uniformMatrix4fv(c,!1,g),h.uniformMatrix4fv(e,!1,k),g=0;g<f;g++){k=p[g];if(!k.isEnabled())break;a.bindBuffer(k.fieldLineBufferHandle,d,3,h.FLOAT,12,0);h.drawArrays(h.LINE_STRIP,0,k.npoints);a.bindBuffer(k.fieldDirectionBufferHandle,d,3,h.FLOAT,12,0);h.drawArrays(h.LINES,0,k.narrows)}};a=f;h=a.getGLContext();b=this.createProgram()}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.utility=window.vizit.utility||{};
(function(l){l.Cylinder=function(){var f,h;this.setColor=function(a){h=a};this.getColor=function(){return h};this.getCylinderModelView=function(a,c,d,b,e,k,g){var f,h,s;s=Math.sin(g);g=Math.cos(g);h=Math.sin(k);k=Math.cos(k);f=new Float32Array(16);f[0]=e*k*g;f[1]=e*g*h;f[2]=-e*s;f[3]=0;f[4]=-e*h;f[5]=e*k;f[6]=0;f[7]=0;f[8]=b*k*s;f[9]=b*h*s;f[10]=b*g;f[11]=0;f[12]=a;f[13]=c;f[14]=d;f[15]=1;return f};this.transformPoints=function(a,c,d,b){var e,k,g;f[0]=a[0]*d;f[1]=a[1]*d;f[2]=a[2]*d;f[3]=a[3];f[4]=
a[4]*d;f[5]=a[5]*d;f[6]=a[6]*d;f[7]=a[7];f[8]=a[8]*c;f[9]=a[9]*c;f[10]=a[10]*c;f[11]=a[11];f[12]=a[12];f[13]=a[13];f[14]=a[14];f[15]=a[15];c=0;for(a=b.length;c<a;c++)d=b[c],e=d[0],k=d[1],g=d[2],d[0]=f[0]*e+f[4]*k+f[8]*g+f[12],d[1]=f[1]*e+f[5]*k+f[9]*g+f[13],d[2]=f[2]*e+f[6]*k+f[10]*g+f[14];return b};this.setupBuffers=function(a,c,d,b,e){var f;f=a.getGLContext();a.bindBuffer(d,c.getPositionHandle(),3,f.FLOAT,0,0);a.bindBuffer(b,c.getNormalHandle(),3,f.FLOAT,0,0);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,
e)};this.drawCap=function(a,c,d){a.drawElements(a.TRIANGLE_FAN,c,a.UNSIGNED_SHORT,2*d)};this.drawSide=function(a,c,d){a.drawElements(a.TRIANGLE_STRIP,c,a.UNSIGNED_SHORT,2*d)};this.drawCylinder=function(a,c,d,b,e){a=a.getGLContext();a.uniformMatrix4fv(c.getModelViewMatrixHandle(),!1,d);e&&this.drawCap(a,b+2,0);this.drawSide(a,2*b+2,b+2);e&&this.drawCap(a,b+2,3*b+4)};this.fullRender=function(a,c,d,b,e,k,g){var m,p,s,q;m=a.getGLContext();s=this.getBaseRadius();q=this.getVertexBuffers(a);m.uniform4f(c.getSurfaceColorHandle(),
h.getRed(),h.getGreen(),h.getBlue(),h.getAlpha());p=(this.getNindices()-6)/4;this.setupBuffers(a,c,q.vertices,q.normals,q.indices);f[3]=d[3];f[7]=d[7];f[8]=d[8]*b;f[9]=d[9]*b;f[10]=d[10]*b;f[11]=d[11];f[12]=d[12];f[13]=d[13];f[14]=d[14];f[15]=d[15];m.cullFace(m.FRONT);for(b=k;b>=e;b--)q=b/s,f[0]=d[0]*q,f[1]=d[1]*q,f[2]=d[2]*q,f[4]=d[4]*q,f[5]=d[5]*q,f[6]=d[6]*q,this.drawCylinder(a,c,f,p,g);m.cullFace(m.BACK);for(b=e;b<=k;b++)q=b/s,f[0]=d[0]*q,f[1]=d[1]*q,f[2]=d[2]*q,f[4]=d[4]*q,f[5]=d[5]*q,f[6]=d[6]*
q,this.drawCylinder(a,c,f,p,g)};this.translateBounds=function(a,c,d,b,e,f,g){var m,h,s;m=(c+e)/2;h=(d+f)/2;s=(b+g)/2;c-=m;d-=h;b-=s;e-=m;f-=h;g-=s;a.setTx(m).setTy(h).setTz(s).setX0(c).setY0(d).setZ0(b).setX1(e).setY1(f).setZ1(g)};this.sign=function(a){return 0>a?-1:1};this.zAxisRotation=function(a,c,d,b,e){var f;f=Math.atan2(e-d,b-c);c=-this.sign(b)*Math.sqrt(c*c+d*d);d=0;b=-c;e=0;a.setX0(c).setY0(d).setX1(b).setY1(e).setPhi(f)};this.yAxisRotation=function(a,c,d,b,e,f,g){d=Math.sqrt(c*c+d*d+b*b);
f=Math.acos(g/d);b=this.sign(g);g=b*d;e=c=0;a.setZ0(-b*d).setZ1(g).setX0(c).setX1(e).setTheta(f)};this.scale=function(a,c,d){var b;b=this.sign(d);c=d-c;a.setZ0(0.5*-b).setZ1(0.5*b).setHeight(c)};f=new Float32Array(16)};l.Cylinder.prototype=new vizit.geometry.Cylinder})(window.vizit.utility);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.GaussianCylinder=function(f,h,a,c,d,b,e,k){var g,m,p,s,q,n,r,l,u,v,t;this.setEnabled=function(a){m=vizit.utility.toBoolean(a)};this.isEnabled=function(){return m};this.setX=function(a){u=a;s[12]=u;return this};this.getX=function(){return u};this.setY=function(a){v=a;s[13]=v;return this};this.getY=function(){return v};this.setZ=function(a){t=a;s[14]=t;return this};this.getZ=function(){return t};this.setOrigin=function(a){this.setX(a[0]);this.setY(a[1]);return this.setZ(a[2])};this.getOrigin=
function(){return[u,v,t]};this.setR=function(a){r=a;return this};this.getR=function(){return r};this.setHeight=function(a){p=a;return this};this.getHeight=function(){return p};this.setTheta=function(a){l=a;return this};this.getTheta=function(){return l};this.setPhi=function(a){n=a;return this};this.getPhi=function(){return n};this.setName=function(a){q=a};this.getName=function(){return q};this.render=function(a,b){m&&this.fullRender(a,b,s,p,r,r,!0)};g=new vizit.utility.Color(0.5,0.5,0.5,0.5);m=!0;
p=c;q=k;n=b;r=d;l=e;u=f;v=h;t=a;this.setColor(g);s=this.getCylinderModelView(u,v,t,this.getBaseHeight(),this.getBaseRadius(),n,l)};l.GaussianCylinder.prototype=new vizit.utility.Cylinder})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.GaussianSphere=function(f,h,a,c,d){var b,e,k,g,m,p,s,q;this.setColor=function(a){b=a};this.getColor=function(){return b};this.setEnabled=function(a){e=vizit.utility.toBoolean(a)};this.isEnabled=function(){return e};this.setX=function(a){p=a;return this};this.getX=function(){return p};this.setY=function(a){s=a;return this};this.getY=function(){return s};this.setZ=function(a){q=a;return this};this.getZ=function(){return q};this.setR=function(a){m=a;return this};this.getR=function(){return m};
this.setName=function(a){g=a};this.getName=function(){return g};this.getModelView=function(a){"undefined"===typeof a&&(a=1);"undefined"===typeof k?(k=new Float32Array(16),k[0]=a,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=a,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=a,k[11]=0,k[12]=p,k[13]=s,k[14]=q,k[15]=1):(k[0]=a,k[5]=a,k[10]=a);return k};this.drawFullSurface=function(a,b,d,e,c,g){var f;f=a.getGLContext();a.bindBuffer(d,b.getPositionHandle(),3,f.FLOAT,0,0);a.bindBuffer(e,b.getNormalHandle(),3,f.FLOAT,0,0);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,
c);f.drawElements(f.TRIANGLES,g,f.UNSIGNED_SHORT,0)};this.render=function(a,d){if(e){var c,g,f;c=a.getGLContext();g=this.getIntrinsicRadius();f=this.getVertexBuffers(a);c.uniformMatrix4fv(d.getModelViewMatrixHandle(),!1,this.getModelView(m/g));c.uniform4f(d.getSurfaceColorHandle(),b.getRed(),b.getGreen(),b.getBlue(),b.getAlpha());c.cullFace(c.FRONT);this.drawFullSurface(a,d,f.vertices,f.normals,f.indices,this.getNindices());c.cullFace(c.BACK);this.drawFullSurface(a,d,f.vertices,f.normals,f.indices,
this.getNindices())}};b=new vizit.utility.Color(0.5,0.5,0.5,0.5);e=!0;g=d;m=c;p=f;s=h;q=a};l.GaussianSphere.prototype=new vizit.geometry.Sphere})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.ChargedCylinder=function(f,h,a,c,d,b,e,k,g,m,p,s){var q,n,r,l,u,v,t,y,C,B,G,I,F,K,H,A,E,x,z,D,L,J,M,N;this.setHeight=function(a){q=a;r=!0};this.getHeight=function(){return q};this.setTx=function(a){I=a;r=!0;return this};this.getTx=function(){return I};this.setTy=function(a){F=a;r=!0;return this};this.getTy=function(){return F};this.setTz=function(a){K=a;r=!0;return this};this.getTz=function(){return K};this.setX0=function(a){H=a;r=!0;return this};this.getX0=function(){return H};this.setY0=
function(a){A=a;r=!0;return this};this.getY0=function(){return A};this.setZ0=function(a){E=a;r=!0;return this};this.getZ0=function(){return E};this.setX1=function(a){x=a;r=!0;return this};this.getX1=function(){return x};this.setY1=function(a){z=a;r=!0;return this};this.getY1=function(){return z};this.setZ1=function(a){D=a;r=!0;return this};this.getZ1=function(){return D};this.setR0=function(a){B=a;r=!0;return this};this.getR0=function(){return B};this.setR1=function(a){G=a;r=!0;return this};this.getR1=
function(){return G};this.setPhi=function(a){v=a;r=!0;return this};this.getPhi=function(){return v};this.setTheta=function(a){t=a;r=!0;return this};this.getTheta=function(){return t};this.setNfieldLines=function(a){u=a;r=!0;return this};this.getNfieldLines=function(){return u};this.setModified=function(a){r=a;return this};this.isModified=function(){return r};this.setName=function(a){l=a;return this};this.getName=function(){return l};this.getStartPoints=function(){var a,b,d,c,e,f,g;g=[];if(0!==C+u){f=
this.sign(y);b=Math.max(2,Math.round(Math.abs(y*Math.PI*(G*G-B*B)*C*q)))+u;d=(B+1)/G;c=0.707106781*(B+1)/G;e=-0.5;a=1/(b-1);for(var k=0;k<b;k++)g.push([d,0,e,f]),g.push([-d,0,e,f]),g.push([0,d,e,f]),g.push([0,-d,e,f]),g.push([c,c,e,f]),g.push([c,-c,e,f]),g.push([-c,-c,e,f]),g.push([-c,c,e,f]),e+=a}return this.transformPoints(n,q/this.getBaseHeight(),G/this.getBaseRadius(),g)};this.getNormal=function(a,b,d){var c,e,f,g;c={};e=-((H-a)*L+(A-b)*J+(E-d)*M)/(N*N);f=H+e*L;g=A+e*J;e=E+e*M;c.x=a-f;c.y=b-g;
c.z=d-e;return c};this.getField=function(a,b,d){var c;c=Array(3);b=this.getNormal(a,b,d);d=Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z);a=2*(d<B?0:d<G?Math.PI*(d*d-B*B)*y:Math.PI*(G*G-B*B)*y)/d;c[0]=a*b.x/d;c[1]=a*b.y/d;c[2]=a*b.z/d;return c};this.render=function(a,b){this.fullRender(a,b,n,q/this.getBaseHeight(),B/this.getBaseRadius(),G/this.getBaseRadius(),!1)};r=!0;l=s;y="undefined"===typeof g?0:g;C="undefined"===typeof m?0:m;u="undefined"===typeof p?0:p;B=e;G=k;H=f;A=h;E=a;x=c;z=d;D=b;e=0<y?new vizit.utility.Color(0.05,
0.05,0.8,0.3):0>y?new vizit.utility.Color(0.8,0.05,0.05,0.3):new vizit.utility.Color(0.5,0.5,0.5,0.2);this.setColor(e);this.translateBounds(this,H,A,E,x,z,D);this.zAxisRotation(this,H,A,x,z);this.yAxisRotation(this,H,A,E,x,z,D);this.scale(this,E,D);H=f;A=h;E=a;x=c;z=d;D=b;n=this.getCylinderModelView(I,F,K,this.getBaseHeight(),this.getBaseRadius(),v,t);L=x-H;J=z-A;M=D-E;N=Math.sqrt(L*L+J*J+M*M)};l.ChargedCylinder.prototype=new vizit.utility.Cylinder})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.ChargedLine=function(f,h,a,c,d,b,e,k,g,m){var p,s,q,n,r,l,u,v,t,y,C,B,G,I,F,K,H,A,E,x,z,D,L,J;this.computeColor=function(a){return 0<a?new vizit.utility.Color(0.05,0.05,0.8,0.8):0>a?new vizit.utility.Color(0.8,0.05,0.05,0.8):new vizit.utility.Color(0.5,0.5,0.5,0.8)};this.setChargeDensity=function(a){p=a;r=!0;this.setColor(this.computeColor(p))};this.getChargeDensity=function(){return p};this.setHeight=function(a){q=a;r=!0};this.getHeight=function(){return q};this.setTx=function(a){B=
a;r=!0;return this};this.getTx=function(){return B};this.setTy=function(a){G=a;return this};this.getTy=function(){return G};this.setTz=function(a){I=a;r=!0;return this};this.getTz=function(){return I};this.setX0=function(a){F=a;r=!0;return this};this.getX0=function(){return F};this.setY0=function(a){K=a;r=!0;return this};this.getY0=function(){return K};this.setZ0=function(a){H=a;r=!0;return this};this.getZ0=function(){return H};this.setX1=function(a){A=a;r=!0;return this};this.getX1=function(){return A};
this.setY1=function(a){E=a;r=!0;return this};this.getY1=function(){return E};this.setZ1=function(a){x=a;r=!0;return this};this.getZ1=function(){return x};this.setR0=function(a){y=a;r=!0;return this};this.getR0=function(){return y};this.setR1=function(a){C=a;r=!0;return this};this.getR1=function(){return C};this.setPhi=function(a){v=a;r=!0;return this};this.getPhi=function(){return v};this.setTheta=function(a){t=a;r=!0;return this};this.getTheta=function(){return t};this.setNfieldLines=function(a){u=
a;r=!0;return this};this.getNfieldLines=function(){return u};this.setModified=function(a){r=a;return this};this.isModified=function(){return r};this.setName=function(a){l=a;return this};this.getName=function(){return l};this.getStartPoints=function(){var a,b,d,c,e;e=[];if(0!==s+u){c=this.sign(p);b=Math.max(2,Math.round(Math.abs(p*s*q)))+u;d=-0.5;a=1/(b-1);for(var f=0;f<b;f++)e.push([1,0,d,c]),e.push([-1,0,d,c]),e.push([0,1,d,c]),e.push([0,-1,d,c]),e.push([0.707106781,0.707106781,d,c]),e.push([0.707106781,
-0.707106781,d,c]),e.push([-0.707106781,-0.707106781,d,c]),e.push([-0.707106781,0.707106781,d,c]),d+=a}return this.transformPoints(n,q/this.getBaseHeight(),(y+1)/this.getBaseRadius(),e)};this.getNormal=function(a,b,d){var c,e,f,g;c={};e=-((F-a)*z+(K-b)*D+(H-d)*L)/(J*J);f=F+e*z;g=K+e*D;e=H+e*L;c.x=a-f;c.y=b-g;c.z=d-e;return c};this.getField=function(a,b,d){var c;d=this.getNormal(a,b,d);c=Math.sqrt(d.x*d.x+d.y*d.y+d.z*d.z);a=Array(3);b=2*p/c;a[0]=b*d.x/c;a[1]=b*d.y/c;a[2]=b*d.z/c;return a};this.render=
function(a,b){this.fullRender(a,b,n,q,y,C,!1)};p="undefined"===typeof e?0:e;this.setColor(this.computeColor(p));r=!0;l=m;s="undefined"===typeof k?0:k;u="undefined"===typeof g?0:g;y=0;C=3;F=f;K=h;H=a;A=c;E=d;x=b;this.translateBounds(this,F,K,H,A,E,x);this.zAxisRotation(this,F,K,A,E);this.yAxisRotation(this,F,K,H,A,E,x);this.scale(this,H,x);F=f;K=h;H=a;A=c;E=d;x=b;n=this.getCylinderModelView(B,G,I,this.getBaseHeight(),this.getBaseRadius(),v,t);z=A-F;D=E-K;L=x-H;J=Math.sqrt(z*z+D*D+L*L)};l.ChargedLine.prototype=
new vizit.utility.Cylinder})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.ChargedPlane=function(f,h,a,c,d,b,e,k,g,m,p,s,q,n,r,l){var u,v,t,y,C,B,G,I,F,K,H,A,E,x,z,D,L,J,M,N,O,P,S,R;this.setNfieldLines=function(a){H=a;F=!0;return this};this.getNfieldLines=function(){return H};this.setModified=function(a){F=a;return this};this.isModified=function(){return F};this.setName=function(a){K=a;return this};this.getName=function(){return K};this.calculateNormal=function(a){var b;b=Array(3);b[0]=(a[4]-a[1])*(a[11]-a[2])-(a[5]-a[2])*(a[10]-a[1]);b[1]=(a[5]-a[2])*(a[9]-
a[0])-(a[3]-a[0])*(a[11]-a[2]);b[2]=(a[3]-a[0])*(a[10]-a[1])-(a[4]-a[1])*(a[9]-a[0]);a=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]/=a;b[1]/=a;b[2]/=a;return b};this.adjustStartPoints=function(a){var b,d,c,e,f;b=a.length;for(var g=0;g<b;g++)d=a[g],c=d[0],e=d[1],f=d[2],d[0]=N+G*(J*c*C+f*x)+D*(-M*e*B+z*(-J*c*x+f*C)),d[1]=O+G*(M*e*B+z*(J*c*x-f*C))+D*(J*c*C+f*x),d[2]=P+M*e*z+B*(-J*c*x+f*C);return a};this.getStartPoints=function(){var a,b,d,c,e,f,g;b=Math.abs(L*E)+H/Math.abs(J*M);e=[];if(0<b)for(a=Math.sqrt(1/
b),b=a/Math.abs(J),a/=Math.abs(M),d=!1,c=0<L?1:-1,f=Math.min(-0.5+b/2,0.5),g=Math.min(-0.5+a/2,0.5);!d;)e.push([f,g,0.4,c]),e.push([f,g,-0.4,c]),g+=a,0.5<g?(g=0.5-(g-0.5),f+=b,a=-a):-0.5>g&&(g=-0.5-(g- -0.5),f+=b,a=-a),d=0.5<f;return this.adjustStartPoints(e)};this.getField=function(a,b,d){var c;c=Array(3);a=(a-y[0])*A[0]+(b-y[1])*A[1]+(d-y[2])*A[2];b=S*L;0===a&&(c[0]=0,c[1]=0,c[2]=0);0<a?(c[0]=b*A[0],c[1]=b*A[1],c[2]=b*A[2]):(c[0]=-b*A[0],c[1]=-b*A[1],c[2]=-b*A[2]);return c};this.translateBoundingBox=
function(b){N=(f+e)/2;O=(h+k)/2;P=(a+g)/2;b[0]-=N;b[1]-=O;b[2]-=P;b[3]-=N;b[4]-=O;b[5]-=P;b[6]-=N;b[7]-=O;b[8]-=P;b[9]-=N;b[10]-=O;b[11]-=P;return b};this.zAxisRotation=function(a){var b,c;b=a[3]-a[0];c=a[0]-a[9];0===b||0===c?(t=0,R=0===b&&0===c?0===a[4]-a[1]?1:2:0===b?1:2):(b=(d-h)/b,c=(k-d)/c,Math.abs(b)<Math.abs(c)?(t=Math.atan(b),R=1):(t=Math.atan(c),R=2));G=Math.cos(t);D=Math.sin(t);for(var e=0;4>e;e++)c=G*a[3*e]-D*a[3*e+1],b=D*a[3*e]+G*a[3*e+1],a[3*e]=c,a[3*e+1]=b;return a};this.xAxisRotation=
function(a,b){var d,c;1===b?(d=a[1]-a[10],c=a[2]-a[11]):(d=a[4]-a[1],c=a[5]-a[2]);z=v=0;B=1;if(0!==c&&0!==d){v=Math.atan(c/d);z=Math.sin(v);B=Math.cos(v);for(var e=0;4>e;e++)d=B*a[3*e+1]-z*a[3*e+2],c=z*a[3*e+1]+B*a[3*e+2],a[3*e+1]=d,a[3*e+2]=c}return a};this.yAxisRotation=function(a,b){var d,c;1===b?(d=a[0]-a[9],c=a[2]-a[11]):(d=a[3]-a[0],c=a[5]-a[2]);x=u=0;C=1;if(0!==c){0!==d?(u=Math.atan(c/d),x=Math.sin(u),C=Math.cos(u)):(u=1.5707963267948966,x=1,C=0);for(var e=0;4>e;e++)d=C*a[3*e]+x*a[3*e+2],c=
-x*a[3*e]+C*a[3*e+2],a[3*e]=d,a[3*e+2]=c}return a};this.scaleBoundingbox=function(a,b){1===b?(J=a[0]-a[9],M=a[4]-a[1]):(J=a[3]-a[0],M=a[1]-a[10]);for(var d=0;4>d;d++)0!==J&&(a[3*d]/=J),0!==M&&(a[3*d+1]/=M);return a};this.getModelView=function(){return I};this.drawFullSurface=function(a,b,d,c,e,f){var g;g=a.getGLContext();a.bindBuffer(d,b.getPositionHandle(),3,g.FLOAT,0,0);a.bindBuffer(c,b.getNormalHandle(),3,g.FLOAT,0,0);g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,e);g.drawElements(g.TRIANGLES,f,g.UNSIGNED_SHORT,
0)};this.render=function(a,b){var d,c,e;d=a.getGLContext();e=this.getVertexBuffers(a);0<L?d.uniform4f(b.getSurfaceColorHandle(),0.05,0.05,0.8,0.4):0>L?d.uniform4f(b.getSurfaceColorHandle(),0.8,0.05,0.05,0.4):d.uniform4f(b.getSurfaceColorHandle(),0.5,0.5,0.5,0.2);c=this.getNindices();d.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView());d.disable(d.CULL_FACE);this.drawFullSurface(a,b,e.vertices,e.normals,e.indices,c);d.enable(d.CULL_FACE)};F=!0;K=l;S=6.283185307179586;L="undefined"===
typeof q?0:q;E="undefined"===typeof n?0:n;H="undefined"===typeof r?0:r;y=[f,h,a,c,d,b,e,k,g,m,p,s];c=y.slice(0);A=this.calculateNormal(y);c=this.translateBoundingBox(c);c=this.zAxisRotation(c);c=this.xAxisRotation(c,R);c=this.yAxisRotation(c,R);c=this.scaleBoundingbox(c,R);I=new Float32Array(16);C=Math.cos(-u);B=Math.cos(-v);G=Math.cos(-t);x=Math.sin(-u);z=Math.sin(-v);D=Math.sin(-t);I[0]=J*(C*G-x*z*D);I[1]=J*(C*D+G*x*z);I[2]=-J*B*x;I[3]=0;I[4]=-M*B*D;I[5]=M*B*G;I[6]=M*z;I[7]=0;I[8]=z*D*C+x*G;I[9]=
-(z*C*G-x*D);I[10]=C*B;I[11]=0;I[12]=N;I[13]=O;I[14]=P;I[15]=1};l.ChargedPlane.prototype=new vizit.geometry.Square})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.ChargedSphere=function(f,h,a,c,d,b,e,k,g){var m,p,s,q,n,r,l,u,v,t,y;l=!0;u=g;v=0;m=c;p=m*m;s=p*m;q=d;n=q*q*q;t="undefined"===typeof b?0:b;y="undefined"===typeof e?0:e;nfieldLines="undefined"===typeof k?0:k;this.setA=function(a){m=a;p=m*m;s=p*m;l=!0;return this};this.getA=function(){return m};this.setB=function(a){q=a;n=q*q*q;l=!0;return this};this.getB=function(){return q};this.setNindices=function(a){v=a;return this};this.setModified=function(a){l=a;return this};this.isModified=function(){return l};
this.setNfieldLines=function(a){nfieldLines=a;l=!0;return this};this.getNfieldLines=function(){return nfieldLines};this.setName=function(a){u=a;return this};this.getName=function(){return u};this.getStartPoints=function(){var b,d,c,e,g,k,p;k=0<t?1:0>t?-1:0;b=Math.round(y*t*k)+nfieldLines;e=3.6/Math.sqrt(b);d=0;radius=m+0.2*(q-m);g=[];for(var r=1;r<b;r++)p=-1+2*r/b,c=Math.sqrt(1-p*p),d+=e/c,g.push([Math.cos(d)*c*radius+f,p*radius+h,Math.sin(d)*c*radius+a,k]);return g};this.getField=function(b,d,c){var e,
g=[0,0,0],k;b-=f;d-=h;c-=a;e=b*b+d*d+c*c;if(e<=p)return g;k=Math.sqrt(e);e=k>=m&&k<q?t*(k-s/e)/(n-s):t/e;g[0]=e*b/k;g[1]=e*d/k;g[2]=e*c/k;return g};this.getModelView=function(b){"undefined"===typeof b&&(b=1);null===r?(r=new Float32Array(16),r[0]=b,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=b,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=b,r[11]=0,r[12]=f,r[13]=h,r[14]=a,r[15]=1):(r[0]=b,r[5]=b,r[10]=b);return r};this.drawFullSurface=function(a,b,d,c,e,g){var f;f=a.getGLContext();a.bindBuffer(d,b.getPositionHandle(),3,
f.FLOAT,0,0);a.bindBuffer(c,b.getNormalHandle(),3,f.FLOAT,0,0);f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,e);f.drawElements(f.TRIANGLES,g,f.UNSIGNED_SHORT,0)};this.render=function(a,b){var d,c,e,g,f;c=a.getGLContext();d=this.getIntrinsicRadius();f=this.getVertexBuffers(a);0<t?c.uniform4f(b.getSurfaceColorHandle(),0.05,0.05,0.8,0.2):0>t?c.uniform4f(b.getSurfaceColorHandle(),0.8,0.05,0.05,0.2):c.uniform4f(b.getSurfaceColorHandle(),0.5,0.5,0.5,0.2);v=this.getNindices();c.cullFace(c.FRONT);for(e=q;e>=m;e--)g=
e/d,c.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView(g)),this.drawFullSurface(a,b,f.vertices,f.normals,f.indices,v);c.cullFace(c.BACK);for(e=m;e<=q;e++)g=e/d,this.drawFullSurface(a,b,f.vertices,f.normals,f.indices,v),c.uniformMatrix4fv(b.getModelViewMatrixHandle(),!1,this.getModelView(g))}};l.ChargedSphere.prototype=new vizit.geometry.Sphere})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.Charge=function(f,h,a,c,d,b,e){var k,g,m,p,s,l,n;this.setCharge=function(a){k=vizit.utility.ensureNumber(a);g=!0};this.getCharge=function(){return k};this.setX=function(a){s[0]=vizit.utility.ensureNumber(a);g=!0};this.getX=function(){return s[0]};this.setY=function(a){s[1]=vizit.utility.ensureNumber(a);g=!0};this.getY=function(){return s[1]};this.setZ=function(a){s[2]=vizit.utility.ensureNumber(a);g=!0};this.getZ=function(){return s[2]};this.setPosition=function(a){s=a;g=!0};this.getPosition=
function(){return s};this.setNfieldLines=function(a){p=a;g=!0};this.getNfieldLines=function(){return p};this.setModified=function(a){g=a};this.isModified=function(){return g};this.setName=function(a){m=a};this.getName=function(){return m};this.getField=function(a,b,d){var c,e=[0,0,0],g;a-=s[0];b-=s[1];d-=s[2];n=a*a+b*b+d*d;if(0>=n)return e;g=Math.sqrt(n);c=k/n;e[0]=c*a/g;e[1]=c*b/g;e[2]=c*d/g;return e};this.getFieldSeedPointsI=function(a){var b,d,c,e,g,f;e=[];g=0<k?1:0>k?-1:0;a=Math.round(a*k*g);
b=2/a;for(var m=0;m<a;m++)f=m*b-1+b/2,c=Math.sqrt(1-f*f),d=2.39996323*m,e.push([Math.cos(d)*c+s[0],f+s[1],Math.sin(d)*c+s[2],g]);return e};this.getStartPoints=function(a,b){var d,c,e,g,f,m,h;m=0<k?1:0>k?-1:0;d=Math.round(l*k*m)+1+p;g=3.6/Math.sqrt(d);c="undefined"===typeof a?Math.PI/2:a;b="undefined"===typeof b?1:b;f=[];if(0<d)for(var n=1;n<d;n++)h=-1+2*n/d,e=Math.sqrt(1-h*h),c+=g/e,f.push([Math.cos(c)*e*b+s[0],h*b+s[1],Math.sin(c)*e*b+s[2],m]);return f};this.shouldStop=function(a,b,d,c){return 0>
a*k&&4>n};k=c;g=!0;m=e;s=[vizit.utility.ensureNumber(f),vizit.utility.ensureNumber(h),vizit.utility.ensureNumber(a)];l="undefined"===typeof d?0:d;p="undefined"===typeof b?0:b};l.Charges=function(){var f,h,a,c;this.addCharge=function(b){a=f.push(b);return this};for(var d=0;d<arguments.length;d++)this.addCharge(arguments[d]);this.getNcharges=function(){return a};this.getCharges=function(){return f};this.addDistribution=function(a){c=h.push(a);return this};this.getNdistributions=function(){return c};
this.getDistributions=function(){return h};this.chargesModified=function(){var b;b=!1;for(d=0;d<a&&!b;d++)b=b||f[d].isModified();return b};this.distributionsModified=function(){var a;a=!1;for(d=0;d<c&&!a;d++)a=a||h[d].isModified();return a};this.isModified=function(){return this.chargesModified()||this.distributionsModified()};this.setModified=function(b){for(d=0;d<a;d++)f[d].setModified(b);for(d=0;d<c;d++)h[d].setModified(b)};this.getStartPoints=function(b,d){var k,g=b,m=1.57079632679/(a+1),p=[],
s;for(k=0;k<a;k++)s=f[k],p=p.concat(s.getStartPoints(g,d)),g+=m;for(k=0;k<c;k++)p=p.concat(h[k].getStartPoints());return p};this.getField=function(b,d,k){for(var g,m=[0,0,0],p=0;p<a;p++)g=f[p],g=g.getField(b,d,k),m[0]+=g[0],m[1]+=g[1],m[2]+=g[2];for(p=0;p<c;p++)g=h[p].getField(b,d,k),m[0]+=g[0],m[1]+=g[1],m[2]+=g[2];return m};this.shouldStop=function(b,d,c,g){var m;m=!1;for(var h=0;h<a&!m;h++)m=f[h],m=m.shouldStop(b,d,c,g);return m};a=0;f=[];h=[]}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.electricfield=window.vizit.electricfield||{};
(function(l){l.ElectricField=function(){var f,h,a,c,d,b,e,k,g,m,p,s,l,n,r,w,u,v,t,y,C;this.setArrowSpacing=function(a){h=a;"undefined"!==typeof r&&r.setArrowSpacing(a)};this.getArrowSpacing=function(){return h};this.setArrowHeadSize=function(a){f=a;"undefined"!==typeof r&&r.setArrowHeadSize(a)};this.getArrowHeadSize=function(){return f};this.setColor=function(a){e=a};this.getColor=function(){return e};this.setCharges=function(a){b=a};this.getCharges=function(){return b};this.addGaussianSurface=function(a){m.push(a)};
this.getGaussianSurfaces=function(){return m};this.setGlUtility=function(a){p=a};this.getGlUtility=function(){return p};this.setMaxVectors=function(a){l=a};this.getMaxVectors=function(){return l};this.setModelViewMatrix=function(a){u=a;n=p.extractRotationPart(u,n)};this.getModelViewMatrix=function(){return u};this.setProjectionMatrix=function(a){v=a};this.addStartPoint=function(a,b,d,c){t.push([a,b,d,c]);return this};this.addStartPoints=function(a){t=t.concat(a)};this.getStartPoints=function(){return t};
this.render=function(){if(y){var c;c=p.getGLContext();b.chargesModified()?(this.setupCharges(),this.setupFieldLines()):b.distributionsModified()&&this.setupFieldLines();p.clear();d.render(v,u,a,b);w.render(v,u,e,g);c.enable(c.BLEND);c.enable(c.CULL_FACE);c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA);C.render(v,u,n,b.getDistributions());c.disable(c.DEPTH_TEST);C.render(v,u,n,m);c.enable(c.DEPTH_TEST);c.disable(c.BLEND);c.disable(c.CULL_FACE);b.setModified(!1)}};this.setupCharges=function(b){a||(b=
p.getGLContext(),a=b.createBuffer());b=c.generate();p.loadData(a,b)};this.setupFieldLines=function(){var a,d,c,e,f,k;f=[];f=f.concat(b.getStartPoints(0,5));f=f.concat(t);c=f.length;e=g.length;k=Math.min(c,e);for(d=0;d<k;++d)a=f[d],a=r.generate(a[0],a[1],a[2],a[3]),g[d].reload(p,a);for(;d<e;++d)g[d].disable();for(;d<c;++d)a=f[d],a=r.generate(a[0],a[1],a[2],a[3]),g.push(new vizit.electricfield.FieldLineVBO(p,a))};this.start=function(){p.clearColor(0,0,0,0);w=new vizit.electricfield.FieldLineRenderer(p);
c=new vizit.electricfield.ChargeGenerator(b);r=new vizit.electricfield.FieldLineGenerator(b,s,k,f,h);this.setupFieldLines(b,s,k,f,h);d=new vizit.electricfield.ChargeRenderer(p);this.setupCharges(b);C=new vizit.electricfield.SurfaceRenderer(p);y=!0;this.render()};f=0.3;h=1.2;e=new Float32Array([0.8,0.3,0.3,1]);k=0.6;g=[];m=[];s=3E3;l=5;n=new Float32Array([1,0,0,0,1,0,0,0,1]);t=[];y=!1}})(window.vizit.electricfield);window.vizit=window.vizit||{};window.vizit.vectorfield=window.vizit.vectorfield||{};
(function(l){l.VectorFieldGenerator=function(f,h,a,c,d){var b,e,k,g,m,p,s,l;this.setStartPoints=function(a){l=a;return this};this.getStartPoints=function(){return l};this.setMaxVectors=function(a){p=a;return this};this.getMaxVectors=function(){return p};this.setArrowHeadSize=function(a){e=a;return this};this.getArrowHeadSize=function(){return e};this.setVectorSpacing=function(a){vectorSpacing=a;return this};this.getVectorSpacing=function(){return vectorSpacing};this.setDs=function(a){g=a;return this};
this.getDs=function(){return g};this.generateVector=function(a,b,d,c,e,f,g,k,m,h){var p,s,l,q,A,E,x,z,D,L,J,M,N;L=a+c[0]*m;J=b+c[1]*m;M=d+c[2]*m;0!==c[2]?(x=E=1,z=-(c[0]+c[1])/c[2]):(0!==c[1]?(E=1,x=-(c[0]+c[2])/c[1]):(E=-(c[1]+c[2])/c[0],x=1),z=1);D=g*f*e*m/Math.sqrt(E*E+x*x+z*z);E*=D;x*=D;z*=D;p=f*c[0]*m;s=f*c[1]*m;c=f*c[2]*m;l=s*z-c*x;q=c*E-p*z;A=p*x-s*E;D=g*f*e*m/Math.sqrt(l*l+q*q+A*A);l*=D;q*=D;A*=D;e=L-p+E;f=J-s+x;g=M-c+z;E=L-p-E;x=J-s-x;z=M-c-z;m=L-p+l;D=J-s+q;N=M-c+A;p=L-p-l;s=J-s-q;A=M-c-
A;c=6*k+1;h.pushVertex(a);h.pushVertex(b);h.pushVertex(d);h.pushIndex(6*k);h.pushVertex(L);h.pushVertex(J);h.pushVertex(M);h.pushIndex(c);h.pushVertex(e);h.pushVertex(f);h.pushVertex(g);h.pushIndex(6*k+2);h.pushIndex(c);h.pushVertex(E);h.pushVertex(x);h.pushVertex(z);h.pushIndex(6*k+3);h.pushIndex(c);h.pushVertex(m);h.pushVertex(D);h.pushVertex(N);h.pushIndex(6*k+4);h.pushIndex(c);h.pushVertex(p);h.pushVertex(s);h.pushVertex(A);h.pushIndex(6*k+5);h.pushIndex(c)};this.trace=function(a,c,d,f,k,h,m,
p,s){var l,q,F,K,H;H=K=l=0;for(q=!1;H<h&&!q;){F=a.getField(c,d,f);q=Math.sqrt(F[0]*F[0]+F[1]*F[1]+F[2]*F[2]);if(0===q)break;l>=K&&(this.generateVector(c,d,f,F,q,e,b,m+H,p,s),K=l+Math.max(1.2*q*p,1),H++);c+=k*F[0]/q*g;d+=k*F[1]/q*g;f+=k*F[2]/q*g;l+=g;q=a.shouldStop(k,c,d,f)}return H};this.generateField=function(){var a,b,c,d;c=l.length;s=0;b=new vizit.utility.IndexedVertices(6*p*c,10*p*c);for(a=0;a<c;a++)d=l[a],d[4]=s,s+=this.trace(m,d[0],d[1],d[2],d[3],p,s,k,b);return b};b=c;e=a;g=0.33;m=f;p=h;k=
d}})(window.vizit.vectorfield);window.vizit=window.vizit||{};window.vizit.field=window.vizit.field||{};
(function(l){l.FieldRenderer=function(f){var h,a,c,d,b,e,k,g;this.getContext=function(){return c.getGLContext()};this.setRenderer=function(a){e=a;e.setGlUtility(c);e.setModelViewMatrix(d);e.setProjectionMatrix(b)};this.setModelViewMatrix=function(a){d=a;e.setModelViewMatrix(d)};this.getModelViewMatrix=function(){return d};this.requestRender=function(){k||(k=!0,requestAnimationFrame(this.render))};this.render=function(){e.render();k=!1};this.start=function(){e.start()};this.setScale=function(a){g=
a;1>g&&(g=1);b=c.generateOrthographicMatrix(g,g,-g,g);e.setProjectionMatrix(b);this.render()};this.zoomBy=function(a){this.setScale(g+a)};this.setElementName=function(a,b){h[b]=a};this.getElementByName=function(a){var b;h.hasOwnProperty(a)&&(b=h[a]);return b};h={};c=new vizit.utility.GLUtility(f);g=5;d=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);new Float32Array([1,0,0,0,1,0,0,0,1]);b=c.generateOrthographicMatrix(g,g,-g,g);a=new vizit.utility.MotionEventHandler(this,c,75,4);f.addEventListener("mousewheel",
a.handleMouseWheel.bind(a),!1);f.addEventListener("mousedown",a.handleMouseDown.bind(a),!1);document.addEventListener("mouseup",a.handleMouseUp.bind(a),!1);document.addEventListener("mousemove",a.handleMouseMove.bind(a),!1);f.addEventListener("touchstart",a.handleTouchStart.bind(a),!1);f.addEventListener("touchmove",a.handleTouchMove.bind(a),!1);f.addEventListener("touchend",a.handleTouchEnd.bind(a),!1)}})(window.vizit.field);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(l){l.BindingBuilder=function(){this.bindingBuilder=function(f,h,a){var c,d,b,e;for(b in h)"set"===b.toLowerCase()?e=h[b]:"from"===b.toLowerCase()?c=h[b]:"mapping"===b.toLowerCase()&&(d=h[b]);c||(c=e);h="set"+e.charAt(0).toUpperCase();1<e.length&&(h+=e.slice(1));e=f[h];e=e.bind(f);f=d?new window.vizit.lesson.MappingEventHandler(e,c,d,a):new window.vizit.lesson.DirectEventHandler(e,a);document.addEventListener(c+"Changed",f.handleUpdate.bind(f),!1)};this.bind=function(f,h,a){var c;if(h)if(Array.isArray(h)){c=
h.length;for(var d=0;d<c;++d)this.bindingBuilder(f,h[d],a)}else this.bindingBuilder(f,h,a)}};l.bindingBuilder=new l.BindingBuilder})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(l){l.CombinedVectorValuedFunctionBuilder=function(f){var h;this.buildFunction=function(a){var c,d;for(d in a)"args"!==d.toLowerCase()&&("body"===d.toLowerCase()?c=a[d]:"name"===d.toLowerCase()?name=a[d]:"properties"!==d.toLowerCase()&&"stop"!==d.toLowerCase()&&d.toLowerCase());return new vizit.vectorfield.VectorFunction(agrs,c)};this.build=function(a){var c,d,b,e;if(a)if(d=new vizit.vectorfield.CombinedVectorFunctions,Array.isArray(a)){e=a.length;for(var f=0;f<e;++f)if(c=this.buildFunction(a[f]))d.addFunction(c),
(b=c.getName())&&h.setElementName(c,b)}else if(c=this.buildFunction(a))d.addFunction(c),(b=c.getName())&&h.setElementName(c,b);return d};h=f}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(l){l.SurfaceBuilder=function(){var f,h,a,c,d,b;this.getXMin=function(){return f};this.getXMax=function(){return h};this.getYMin=function(){return a};this.getYMax=function(){return c};this.getZMin=function(){return d};this.getZMax=function(){return b};this.gaussianCylinderBuilder=function(e){var k,g,m,p,l,q,n,r,w,u;k=!0;for(l in e)"x"===l.toLowerCase()?r=e[l]:"y"===l.toLowerCase()?w=e[l]:"z"===l.toLowerCase()?u=e[l]:"h"===l.toLowerCase()?g=e[l]:"r"===l.toLowerCase()?q=e[l]:"phi"===l.toLowerCase()?
p=e[l]:"theta"===l.toLowerCase()?n=e[l]:"name"===l.toLowerCase()?m=e[l]:"enabled"===l.toLowerCase()&&(k=e[l]);f=Math.min(f,r-q,r+q);h=Math.max(h,r-q,r+q);a=Math.min(a,w-q,w-q);c=Math.max(c,w-q,w+q);d=Math.min(d,u-g,u+g);b=Math.max(b,u-g,u+g);e=new vizit.electricfield.GaussianCylinder(r,w,u,g,q,p,n,m);k||e.setEnabled(k);return e};this.gaussianSphereBuilder=function(e){var k,g,m,p,l,q,n;k=!0;for(m in e)"x"===m.toLowerCase()?l=e[m]:"y"===m.toLowerCase()?q=e[m]:"z"===m.toLowerCase()?n=e[m]:"r"===m.toLowerCase()?
p=e[m]:"name"===m.toLowerCase()?g=e[m]:"enabled"===m.toLowerCase()&&(k=e[m]);f=Math.min(f,l-p,l+p);h=Math.max(h,l-p,l+p);a=Math.min(a,q-p,q-p);c=Math.max(c,q-p,q+p);d=Math.min(d,n-p,n+p);b=Math.max(b,n-p,n+p);e=new vizit.electricfield.GaussianSphere(l,q,n,p,g);k||e.setEnabled(k);return e};this.surfaceBuilder=function(a,b){var c,d,f,h,l;d=/\s*gaussian\s*sphere\s*/i;for(f in a)"type"===f.toLowerCase()?l=a[f]:"bind"===f.toLowerCase()&&(c=a[f]);l.match(/\s*gaussian\s*cylinder\s*/i)?h=this.gaussianCylinderBuilder(a):
l.match(d)&&(h=this.gaussianSphereBuilder(a));"undefined"!==typeof c&&"undefined"!==h&&this.bind(h,c,b);return h};this.build=function(a,b,c){var d,f;if(a)if(Array.isArray(a)){f=a.length;for(var h=0;h<f;++h)if(d=this.surfaceBuilder(a[h],c))b.addGaussianSurface(d),(name=d.getName())&&c.setElementName(d,name)}else if(d=this.surfaceBuilder(a,c))b.addGaussianSurface(d),(name=d.getName())&&c.setElementName(d,name);return b}};l.SurfaceBuilder.prototype=l.bindingBuilder})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};(function(l){l.VectorValuedFunctionBuilder=function(f){var h;this.build=function(a,c){var d,b;a&&(d=Array.isArray(a)?a[0]:a,"undefined"!==typeof d&&(b="function"===d.type.toLowerCase()?new vizit.builder.CombinedVectorValuedFunctionBuilder(h):new vizit.builder.ElectricFieldElementBuilder(h,c)));return b.build(a)};h=f}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(l){l.DistributionBuilder=function(){var f,h,a,c,d,b,e,k;this.getXMin=function(){return a};this.getXMax=function(){return c};this.getYMin=function(){return d};this.getYMax=function(){return b};this.getZMin=function(){return e};this.getZMax=function(){return k};this.chargedPlaneBuilder=function(g){var m,l,s,q,n,r,w,u,v,t,y,C,B,G,I,F,K;for(m in g)m.match(f)?l=g[m]:m.match(h)?s=g[m]:"nfieldLines"===m.toLowerCase()?n=g[m]:"x0"===m.toLowerCase()?r=g[m]:"y0"===m.toLowerCase()?w=g[m]:"z0"===m.toLowerCase()?
u=g[m]:"x1"===m.toLowerCase()?v=g[m]:"y1"===m.toLowerCase()?t=g[m]:"z1"===m.toLowerCase()?y=g[m]:"x2"===m.toLowerCase()?C=g[m]:"y2"===m.toLowerCase()?B=g[m]:"z2"===m.toLowerCase()?G=g[m]:"x3"===m.toLowerCase()?I=g[m]:"y3"===m.toLowerCase()?F=g[m]:"z3"===m.toLowerCase()?K=g[m]:"name"===m.toLowerCase()&&(q=g[m]);a=Math.min(a,r,v,C,I);c=Math.max(c,r,v,C,I);d=Math.min(d,w,t,B,K);b=Math.max(b,w,t,B,K);e=Math.min(e,u,y,G,K);k=Math.max(k,u,y,G,K);return new vizit.electricfield.ChargedPlane(r,w,u,v,t,y,C,
B,G,I,F,K,l,s,n,q)};this.chargedCylinderBuilder=function(g){var m,l,s,q,n,r,w,u,v,t,y,C,B;for(n in g)n.match(f)?m=g[n]:n.match(h)?l=g[n]:"nfieldLines"===n.toLowerCase()?q=g[n]:"x0"===n.toLowerCase()?r=g[n]:"y0"===n.toLowerCase()?w=g[n]:"z0"===n.toLowerCase()?u=g[n]:"x1"===n.toLowerCase()?v=g[n]:"y1"===n.toLowerCase()?t=g[n]:"z1"===n.toLowerCase()?y=g[n]:"r0"===n.toLowerCase()?C=g[n]:"r1"===n.toLowerCase()?B=g[n]:"name"===n.toLowerCase()&&(s=g[n]);a=Math.min(a,r,v);c=Math.max(c,r,v);d=Math.min(d,w,
t);b=Math.max(b,w,t);e=Math.min(e,u,y);k=Math.max(k,u,y);return new vizit.electricfield.ChargedCylinder(r,w,u,v,t,y,C,B,m,l,q,s)};this.chargedLineBuilder=function(g){var m,l,s,q,n,r,w,u,v,t,y;for(n in g)n.match(f)?m=g[n]:n.match(h)?l=g[n]:"nfieldLines"===n.toLowerCase()?q=g[n]:"x0"===n.toLowerCase()?r=g[n]:"y0"===n.toLowerCase()?w=g[n]:"z0"===n.toLowerCase()?u=g[n]:"x1"===n.toLowerCase()?v=g[n]:"y1"===n.toLowerCase()?t=g[n]:"z1"===n.toLowerCase()?y=g[n]:"name"===n.toLowerCase()&&(s=g[n]);a=Math.min(a,
r,v);c=Math.max(c,r,v);d=Math.min(d,w,t);b=Math.max(b,w,t);e=Math.min(e,u,y);k=Math.max(k,u,y);return new vizit.electricfield.ChargedLine(r,w,u,v,t,y,m,l,q,s)};this.chargedSphereBuilder=function(f){var m,l,s,q,n,r,w,u,v;for(property in f)"charge"===property.toLowerCase()?m=f[property]:property.match(h)?l=f[property]:"nfieldLines"===property.toLowerCase()?q=f[property]:"x"===property.toLowerCase()?n=f[property]:"y"===property.toLowerCase()?r=f[property]:"z"===property.toLowerCase()?w=f[property]:"a"===
property.toLowerCase()?u=f[property]:"b"===property.toLowerCase()?v=f[property]:"name"===property.toLowerCase()&&(s=f[property]);a=Math.min(a,n-v);c=Math.max(c,n+v);d=Math.min(d,r-v);b=Math.max(b,r+v);e=Math.min(e,w-v);k=Math.max(k,w+v);return new vizit.electricfield.ChargedSphere(n,r,w,u,v,m,l,q,s)};this.chargeDistributionBuilder=function(a,b){var c,d,e,f,h,k,l;d=/\s*charged\s*cylinder\s*/i;e=/\s*charged\s*line\s*/i;f=/\s*charged\s*sphere\s*/i;for(k in a)"type"===k.toLowerCase()?l=a[k]:"bind"===
k.toLowerCase()&&(c=a[k]);l.match(/\s*charged\s*plane\s*/i)?h=this.chargedPlaneBuilder(a):l.match(d)?h=this.chargedCylinderBuilder(a):l.match(e)?h=this.chargedLineBuilder(a):l.match(f)&&(h=this.chargedSphereBuilder(a));"undefined"!==typeof c&&"undefined"!==h&&this.bind(h,c,b);return h};this.build=function(a,b,c){var d,e,f;if(a)if(Array.isArray(a)){f=a.length;for(var h=0;h<f;++h)if(d=this.chargeDistributionBuilder(a[h],c))b.addDistribution(d),(e=d.getName())&&c.setElementName(d,e)}else if(d=this.chargeDistributionBuilder(a,
c))b.addDistribution(d),(e=d.getName())&&c.setElementName(d,e);return b};f=/\s*charge\s*density\s*/i;h=/\s*field\s*line\s*density\s*/i};l.DistributionBuilder.prototype=l.bindingBuilder})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(l){l.ChargesBuilder=function(){var f,h,a,c,d,b;this.getXMin=function(){return f};this.getXMax=function(){return h};this.getYMin=function(){return a};this.getYMax=function(){return c};this.getZMin=function(){return d};this.getZMax=function(){return b};this.chargeBuilder=function(e,k){var g,m,l,s,q,n,r,w,u,v,t,y;l="";w=/\s*field\s*line\s*density\s*/i;for(t in e)"charge"===t.toLowerCase()?y=e[t]:"x"===t.toLowerCase()?q=e[t]:"y"===t.toLowerCase()?n=e[t]:"z"===t.toLowerCase()?r=e[t]:t.match(w)?
u=e[t]:"nfieldlines"===t.toLowerCase()?v=e[t]:"bind"===t.toLowerCase()?g=e[t]:"name"===t.toLowerCase()&&(s=e[t]);"undefined"===typeof y&&(l="No charge specified for point charge.");"undefined"===typeof q&&(0<l.length&&(l+="\n"),l+="x coordinate is not defined in charge configuration.");"undefined"===typeof n&&(0<l.length&&(l+="\n"),l+="y coordinate is not defined in charge configuration.");"undefined"===typeof r&&(0<l.length&&(l+="\n"),l+="z coordinate is not defined in charge configuration.");0===
l.length&&(q<f&&(f=q),q>h&&(h=q),n<a&&(a=n),n>c&&(c=n),r<d&&(d=r),r>b&&(b=r),m=new vizit.electricfield.Charge(q,n,r,y,u,v,s),"undefined"!==typeof g&&this.bind(m,g,k));return m};this.build=function(a,b,c){var d,f,h;if(a)if(Array.isArray(a)){h=a.length;for(var l=0;l<h;++l)if(d=this.chargeBuilder(a[l],c))b.addCharge(d),(f=d.getName())&&c.setElementName(d,f)}else if(d=this.chargeBuilder(a,c))b.addCharge(d),(f=d.getName())&&c.setElementName(d,f);return b};f=Number.POSITIVE_INFINITY;h=Number.NEGATIVE_INFINITY;
a=Number.POSITIVE_INFINITY;c=Number.NEGATIVE_INFINITY;d=Number.POSITIVE_INFINITY;b=Number.NEGATIVE_INFINITY};l.ChargesBuilder.prototype=l.bindingBuilder})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(l){l.ElectricFieldElementBuilder=function(f,h){var a,c;this.buildELement=function(d,b){var e,f,g,h,l,s,q,n;e=/\s*charged\s*cylinder\s*/i;f=/\s*charged\s*line\s*/i;g=/\s*charged\s*plane\s*/i;h=/\s*charged\s*sphere\s*/i;l=/\s*gaussian\s*cylinder\s*/i;s=/\s*gaussian\s*sphere\s*/i;for(q in d)"type"===q.toLowerCase()&&(n=d[q]);if("charge"===n.toLowerCase())e=new vizit.builder.ChargesBuilder,b=e.build(d,b,a);else if(n.match(e)||n.match(f)||n.match(g)||n.match(h))e=new vizit.builder.DistributionBuilder,
b=e.build(d,b,a);else if(n.match(l)||n.match(s))e=new vizit.builder.SurfaceBuilder,c=e.build(d,c,a);return b};this.build=function(a){var b,c;b=new vizit.electricfield.Charges;if(a)if(Array.isArray(a)){c=a.length;for(var f=0;f<c;++f)this.buildELement(a[f],b)}else this.buildELement(a,b);return b};a=f;c=h}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(l){l.ElectricFieldBuilder=function(f){var h;this.build=function(a){var c,d,b,e,f,g;for(g in a)"arrowheadsize"===g.toLowerCase()?c=a[g]:"arrowspacing"===g.toLowerCase()?d=a[g]:"maxvectors"===g.toLowerCase()?f=a[g]:"elements"===g.toLowerCase()&&(e=a[g]);a=new vizit.electricfield.ElectricField;"undefined"!==typeof f&&a.setMaxVectors(f);"undefined"!==typeof c&&a.setArrowHeadSize(c);"undefined"!==typeof d&&a.setArrowSpacing(d);(b=(new vizit.builder.ElectricFieldElementBuilder(h,a)).build(e,b))&&
a.setCharges(b);return a};h=f}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(l){l.SimpleVectorFieldBuilder=function(f){var h;this.build=function(a){var c,d,b,e,f,g,l;for(l in a)"arrowheadsize"===l.toLowerCase()&&(c=a[l]),"arrowheadwidth"===l.toLowerCase()?d=a[l]:"arrowsize"===l.toLowerCase()?b=a[l]:"maxvectors"===l.toLowerCase()&&(e=a[l]),"f"===l.toLowerCase()&&(g=a[l]);g&&(a=new vizit.builder.VectorValuedFunctionBuilder(h),f=a.build(g));b=new vizit.vectorfield.SimpleVectorField(f,b);"undefined"!==typeof e&&b.setMaxVectors(e);"undefined"!==typeof c&&b.setArrowHeadSize(c);
"undefined"!==typeof d&&b.setArrowHeadWidth(d);return b};h=f}})(window.vizit.builder);window.vizit=window.vizit||{};window.vizit.builder=window.vizit.builder||{};
(function(l){l.VizBuilder=function(){this.processConfig=function(f){var h,a,c,d,b,e,k;h=/\s*electric\s*field\s*/i;e=/\s*simple\s*vector\s*field\s*/i;for(a in f)"canvas"===a.toLowerCase()?c=f[a]:"scale"===a.toLowerCase()?b=f[a]:"type"===a.toLowerCase()&&(k=f[a]);"undefined"===typeof k?alert("Missing type for visualization configuration."):"undefined"===c?alert("No canvas specified, please provide the id of a canvas."):(a=document.getElementById(c))?(c=new vizit.field.FieldRenderer(a),k.match(h)?(h=
new vizit.builder.ElectricFieldBuilder(c),d=h.build(f)):k.match(e)?(h=new vizit.builder.SimpleVectorFieldBuilder(c),d=h.build(f)):alert("Unrecognized visualization type: "+k+"."),d&&(c.setRenderer(d),"undefined"!==typeof b&&c.setScale(b),c.start())):alert('Can not find canvas with id="'+c+'".')};this.process=function(f){var h;if(f)if(Array.isArray(f)){h=f.length;for(var a=0;a<h;++a)this.processConfig(f[a])}else this.processConfig(f)}}})(window.vizit.builder);
function VIZ_CONFIG_IF_EXISTS(l){"undefined"!==typeof VISUALIZATION_CONFIG&&(l=new vizit.builder.VizBuilder,l.process(VISUALIZATION_CONFIG))}"interactive"===document.readyState||"complete"===document.readyState?VIZ_CONFIG_IF_EXISTS():document.addEventListener("DOMContentLoaded",VIZ_CONFIG_IF_EXISTS);
